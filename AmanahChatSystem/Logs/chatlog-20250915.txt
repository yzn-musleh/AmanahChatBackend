2025-09-15 10:10:15.625 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-15 10:10:15.970 +03:00 [INF] Now listening on: https://localhost:7003
2025-09-15 10:10:15.970 +03:00 [INF] Now listening on: http://localhost:5277
2025-09-15 10:10:15.972 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-15 10:10:15.972 +03:00 [INF] Hosting environment: Development
2025-09-15 10:10:15.972 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-09-15 10:10:19.024 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-09-15 10:10:19.377 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 358.9205ms
2025-09-15 10:10:19.511 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-09-15 10:10:19.521 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 9.6851ms
2025-09-15 10:10:19.546 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-09-15 10:10:19.666 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.9634ms
2025-09-15 10:10:19.977 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-09-15 10:10:20.165 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 187.8476ms
2025-09-15 10:12:36.551 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-09-15 10:12:36.561 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:36.563 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 12.0316ms
2025-09-15 10:12:36.568 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 35
2025-09-15 10:12:36.579 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:36.657 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-09-15 10:12:36.684 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-15 10:12:38.449 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-09-15 10:12:38.644 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-15 10:12:38.681 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 1990.6478ms
2025-09-15 10:12:38.682 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-09-15 10:12:38.685 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 2096.6914 ms
2025-09-15 10:12:38.693 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 2125.0879ms
2025-09-15 10:12:38.768 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-09-15 10:12:38.768 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:38.768 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.4399ms
2025-09-15 10:12:38.771 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-09-15 10:12:38.771 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:38.771 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.4752ms
2025-09-15 10:12:38.779 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:12:38.780 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:38.780 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.6479ms
2025-09-15 10:12:38.799 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-09-15 10:12:38.799 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:38.815 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-09-15 10:12:38.816 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:38.824 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:12:38.828 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:12:38.873 +03:00 [INF] HTTP GET /api/Users responded 404 in 56.5675 ms
2025-09-15 10:12:38.873 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 58.0178ms
2025-09-15 10:12:38.874 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-09-15 10:12:38.880 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-09-15 10:12:38.880 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:12:38.889 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-09-15 10:12:38.889 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:12:38.989 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-09-15 10:12:38.991 +03:00 [ERR] An error occurred using the connection to database 'AmanahChatDB' on server 'YZN\SQLEXPRESS'.
2025-09-15 10:12:39.000 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:12:39.010 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 121.4246ms
2025-09-15 10:12:39.010 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:12:39.011 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 181.9577 ms
2025-09-15 10:12:39.011 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 499 null application/json; charset=utf-8 187.0188ms
2025-09-15 10:12:39.035 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:12:39.042 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 153.5396ms
2025-09-15 10:12:39.043 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-09-15 10:12:39.043 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 243.0699 ms
2025-09-15 10:12:39.043 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 499 null application/json; charset=utf-8 244.0759ms
2025-09-15 10:14:14.728 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:14:14.729 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:14.729 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.6478ms
2025-09-15 10:14:14.733 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:14:14.734 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:14.739 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:14:14.740 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:14:14.833 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:14:15.110 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:14:15.112 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:14:15.116 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 376.2137ms
2025-09-15 10:14:15.116 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:14:15.116 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 381.5076 ms
2025-09-15 10:14:15.116 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 383.6884ms
2025-09-15 10:14:19.010 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - null null
2025-09-15 10:14:19.011 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:19.011 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 204 null null 0.7297ms
2025-09-15 10:14:19.018 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - application/json null
2025-09-15 10:14:19.020 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:19.036 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:19.046 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:14:19.070 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:14:19.199 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:14:19.200 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:14:19.203 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 156.8278ms
2025-09-15 10:14:19.203 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:19.203 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24 responded 200 in 182.0240 ms
2025-09-15 10:14:19.203 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 200 null application/json; charset=utf-8 184.9867ms
2025-09-15 10:14:21.531 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:14:21.531 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:21.532 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.9191ms
2025-09-15 10:14:21.540 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:14:21.540 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:21.541 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:21.542 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:14:21.548 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:14:21.561 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:14:21.572 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:14:21.576 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 34.3091ms
2025-09-15 10:14:21.576 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:21.576 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 35.8948 ms
2025-09-15 10:14:21.577 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 37.0525ms
2025-09-15 10:14:24.069 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - null null
2025-09-15 10:14:24.069 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:24.069 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 204 null null 0.6381ms
2025-09-15 10:14:24.074 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - application/json null
2025-09-15 10:14:24.074 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:24.075 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:24.075 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:14:24.086 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:14:24.091 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:14:24.092 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:14:24.093 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 17.3008ms
2025-09-15 10:14:24.093 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:24.093 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24 responded 200 in 18.8522 ms
2025-09-15 10:14:24.095 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 200 null application/json; charset=utf-8 20.6441ms
2025-09-15 10:14:26.252 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 10:14:26.253 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:26.253 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 0.7453ms
2025-09-15 10:14:26.267 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 10:14:26.267 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:26.268 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:26.268 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:14:26.278 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:14:26.284 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:14:26.285 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:14:26.285 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 17.3792ms
2025-09-15 10:14:26.286 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:26.286 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 18.2911 ms
2025-09-15 10:14:26.286 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 19.1273ms
2025-09-15 10:14:28.547 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:14:28.547 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:28.548 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.4523ms
2025-09-15 10:14:28.552 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:14:28.553 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:14:28.554 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:28.554 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:14:28.560 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:14:28.565 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:14:28.566 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:14:28.567 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 12.5701ms
2025-09-15 10:14:28.567 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:14:28.568 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 14.5851 ms
2025-09-15 10:14:28.568 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 15.6901ms
2025-09-15 10:20:54.189 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:20:54.190 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:20:54.190 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.4939ms
2025-09-15 10:20:54.194 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:20:54.194 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:20:54.194 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:20:54.195 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:20:54.203 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:20:54.259 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:20:54.259 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:20:54.260 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 64.7347ms
2025-09-15 10:20:54.260 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:20:54.260 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 65.7790 ms
2025-09-15 10:20:54.260 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 66.3337ms
2025-09-15 10:20:58.796 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - null null
2025-09-15 10:20:58.797 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:20:58.797 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 204 null null 0.4787ms
2025-09-15 10:20:58.801 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - application/json null
2025-09-15 10:20:58.801 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:20:58.802 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:20:58.802 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:20:58.809 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:20:58.869 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:20:58.869 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:20:58.869 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 67.6275ms
2025-09-15 10:20:58.869 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:20:58.869 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24 responded 200 in 68.4972 ms
2025-09-15 10:20:58.870 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 200 null application/json; charset=utf-8 69.0375ms
2025-09-15 10:21:01.444 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 10:21:01.444 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:21:01.445 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 0.7437ms
2025-09-15 10:21:01.448 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 10:21:01.448 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:21:01.450 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:21:01.451 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:21:01.457 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:21:01.466 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:21:01.467 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:21:01.468 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 17.2567ms
2025-09-15 10:21:01.468 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:21:01.469 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 19.2858 ms
2025-09-15 10:21:01.470 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 21.3794ms
2025-09-15 10:21:03.531 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:21:03.531 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:21:03.531 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.4556ms
2025-09-15 10:21:03.537 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:21:03.538 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:21:03.539 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:21:03.539 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:21:03.545 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:21:03.550 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:21:03.551 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:21:03.552 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 12.4907ms
2025-09-15 10:21:03.552 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:21:03.552 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 13.8242 ms
2025-09-15 10:21:03.552 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 14.7434ms
2025-09-15 10:25:45.739 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:25:45.739 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:25:45.740 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.4844ms
2025-09-15 10:25:45.762 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:25:45.763 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:25:45.763 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:25:45.764 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:25:45.771 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:25:45.816 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:25:45.816 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:25:45.817 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 52.9163ms
2025-09-15 10:25:45.817 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:25:45.817 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 53.9700 ms
2025-09-15 10:25:45.817 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 54.6721ms
2025-09-15 10:25:51.138 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - null null
2025-09-15 10:25:51.139 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:25:51.139 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 204 null null 1.0013ms
2025-09-15 10:25:51.145 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - application/json null
2025-09-15 10:25:51.145 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:25:51.146 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:25:51.146 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:25:51.156 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:25:51.233 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:25:51.233 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:25:51.234 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 87.2575ms
2025-09-15 10:25:51.234 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:25:51.234 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24 responded 200 in 88.4680 ms
2025-09-15 10:25:51.234 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 200 null application/json; charset=utf-8 89.216ms
2025-09-15 10:25:53.360 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:25:53.360 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:25:53.361 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 1.1166ms
2025-09-15 10:25:53.365 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:25:53.365 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:25:53.366 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:25:53.367 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:25:53.382 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:25:53.453 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:25:53.454 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:25:53.454 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 87.3252ms
2025-09-15 10:25:53.454 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:25:53.454 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 88.5899 ms
2025-09-15 10:25:53.454 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 89.2091ms
2025-09-15 10:26:04.467 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:26:04.467 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:26:04.467 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.2932ms
2025-09-15 10:26:04.471 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:26:04.471 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:26:04.472 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:26:04.473 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:26:04.483 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:26:04.554 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:26:04.555 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:26:04.555 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 82.2775ms
2025-09-15 10:26:04.555 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:26:04.555 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 83.4498 ms
2025-09-15 10:26:04.555 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 84.6188ms
2025-09-15 10:26:54.977 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - null null
2025-09-15 10:26:54.977 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:26:54.977 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 204 null null 0.422ms
2025-09-15 10:26:54.982 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - application/json null
2025-09-15 10:26:54.982 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:26:54.983 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:26:54.983 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:26:54.992 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:26:55.077 +03:00 [INF] Executed DbCommand (83ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:26:55.077 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:26:55.078 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 94.6505ms
2025-09-15 10:26:55.078 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:26:55.078 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24 responded 200 in 95.6917 ms
2025-09-15 10:26:55.078 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 200 null application/json; charset=utf-8 96.418ms
2025-09-15 10:31:28.448 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:31:28.448 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:31:28.448 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.6057ms
2025-09-15 10:31:28.455 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:31:28.456 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:31:28.456 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:31:28.456 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:31:28.466 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:31:28.497 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:31:28.497 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:31:28.498 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 41.1867ms
2025-09-15 10:31:28.498 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:31:28.498 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 42.1794 ms
2025-09-15 10:31:28.498 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 42.7352ms
2025-09-15 10:32:50.359 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:32:50.359 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:32:50.360 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.2966ms
2025-09-15 10:32:50.365 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:32:50.365 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:32:50.366 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:32:50.366 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:32:50.371 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:32:50.409 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:32:50.409 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:32:50.410 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 44.0094ms
2025-09-15 10:32:50.410 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:32:50.410 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 44.7891 ms
2025-09-15 10:32:50.410 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 45.3335ms
2025-09-15 10:32:53.890 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:32:53.890 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:32:53.891 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.3715ms
2025-09-15 10:32:53.895 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:32:53.896 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:32:53.897 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:32:53.897 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:32:53.907 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:32:53.981 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:32:53.981 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:32:53.982 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 84.8827ms
2025-09-15 10:32:53.982 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:32:53.982 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 85.9143 ms
2025-09-15 10:32:53.982 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 86.5645ms
2025-09-15 10:51:05.218 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:51:05.219 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:05.219 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.441ms
2025-09-15 10:51:05.230 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:51:05.230 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:05.231 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:51:05.231 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:51:05.241 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:51:05.278 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:51:05.278 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:51:05.279 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 47.6227ms
2025-09-15 10:51:05.279 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:51:05.279 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 48.4853 ms
2025-09-15 10:51:05.279 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 48.9799ms
2025-09-15 10:51:09.029 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:51:09.029 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:09.029 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.3353ms
2025-09-15 10:51:09.033 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:51:09.033 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:09.034 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:51:09.034 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:51:09.043 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:51:09.105 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:51:09.105 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:51:09.105 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 71.0687ms
2025-09-15 10:51:09.105 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:51:09.105 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 71.9057 ms
2025-09-15 10:51:09.105 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 72.2826ms
2025-09-15 10:51:16.960 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:51:16.962 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:16.962 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 2.3717ms
2025-09-15 10:51:16.965 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:51:16.966 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:16.966 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:51:16.966 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:51:16.980 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:51:16.985 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:51:16.985 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:51:16.986 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 19.1065ms
2025-09-15 10:51:16.986 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:51:16.986 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 20.1016 ms
2025-09-15 10:51:16.987 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 21.3948ms
2025-09-15 10:51:22.613 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 10:51:22.613 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:22.613 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 0.3078ms
2025-09-15 10:51:22.620 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 10:51:22.620 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:51:22.621 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:51:22.621 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:51:22.625 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:51:22.630 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:51:22.630 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:51:22.631 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 9.5768ms
2025-09-15 10:51:22.631 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:51:22.631 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 10.8092 ms
2025-09-15 10:51:22.631 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 11.4206ms
2025-09-15 10:53:57.865 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:53:57.865 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:53:57.865 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.2983ms
2025-09-15 10:53:57.915 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:53:57.915 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:53:57.916 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:53:57.916 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:53:57.921 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:53:57.955 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:53:57.955 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:53:57.955 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 39.4085ms
2025-09-15 10:53:57.955 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:53:57.955 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 40.0398 ms
2025-09-15 10:53:57.956 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 40.4727ms
2025-09-15 10:54:01.130 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:54:01.130 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:01.130 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.1921ms
2025-09-15 10:54:01.135 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:54:01.135 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:01.136 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:01.136 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:01.142 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:54:01.184 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:54:01.184 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:01.185 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 48.1076ms
2025-09-15 10:54:01.185 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:01.185 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 49.2244 ms
2025-09-15 10:54:01.185 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 49.9463ms
2025-09-15 10:54:03.634 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:54:03.634 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:03.634 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3035ms
2025-09-15 10:54:03.638 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-09-15 10:54:03.638 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:03.639 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:03.650 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:03.701 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:54:03.795 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:54:04.067 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:54:04.094 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:04.097 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 446.8779ms
2025-09-15 10:54:04.097 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:04.097 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 459.2339 ms
2025-09-15 10:54:04.097 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 459.8046ms
2025-09-15 10:54:18.938 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:54:18.938 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:18.938 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.4245ms
2025-09-15 10:54:18.944 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:54:18.944 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:18.945 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:18.945 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:18.948 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:54:18.952 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:54:18.953 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:18.953 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 7.8075ms
2025-09-15 10:54:18.953 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:18.953 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 8.8333 ms
2025-09-15 10:54:18.954 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 10.7334ms
2025-09-15 10:54:21.309 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:54:21.310 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:21.311 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:21.312 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:21.322 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:54:21.402 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:54:21.403 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:21.403 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 90.9074ms
2025-09-15 10:54:21.403 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:21.403 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 93.0399 ms
2025-09-15 10:54:21.403 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 93.6404ms
2025-09-15 10:54:25.226 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:54:25.226 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:25.226 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2604ms
2025-09-15 10:54:25.230 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 123
2025-09-15 10:54:25.230 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:25.231 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:25.231 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:25.242 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:54:25.253 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:54:25.274 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:54:25.277 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:25.277 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 46.1321ms
2025-09-15 10:54:25.277 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:25.277 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 46.9033 ms
2025-09-15 10:54:25.277 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 47.4718ms
2025-09-15 10:54:28.600 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 136
2025-09-15 10:54:28.600 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:28.601 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:28.601 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:28.615 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:54:28.624 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:54:28.647 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:54:28.651 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:28.651 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 50.2013ms
2025-09-15 10:54:28.651 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:28.651 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 51.0840 ms
2025-09-15 10:54:28.652 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 51.6364ms
2025-09-15 10:54:33.319 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:54:33.319 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:33.319 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3277ms
2025-09-15 10:54:33.323 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-09-15 10:54:33.323 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:33.325 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:33.325 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:33.328 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:54:33.332 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:54:33.339 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:54:33.342 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:33.342 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 17.2869ms
2025-09-15 10:54:33.342 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:54:33.343 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 19.0869 ms
2025-09-15 10:54:33.343 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 20.2822ms
2025-09-15 10:54:34.486 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:54:34.486 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:34.486 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.2085ms
2025-09-15 10:54:34.497 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:54:34.510 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:34.512 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:54:34.513 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:54:34.524 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:54:34.562 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:54:34.562 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:34.563 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 50.0817ms
2025-09-15 10:54:34.563 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:54:34.563 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 52.9313 ms
2025-09-15 10:54:34.563 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 65.765ms
2025-09-15 10:54:38.052 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:54:38.052 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:38.052 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.3578ms
2025-09-15 10:54:38.057 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:54:38.057 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:54:38.058 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:38.058 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:54:38.066 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:54:38.140 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:54:38.140 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:54:38.140 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 82.0452ms
2025-09-15 10:54:38.140 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:54:38.140 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 83.2243 ms
2025-09-15 10:54:38.140 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 83.682ms
2025-09-15 10:55:02.895 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 10:55:02.895 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:02.895 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 0.2674ms
2025-09-15 10:55:02.903 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 10:55:02.903 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:02.904 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:02.904 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:02.913 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:02.979 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:02.979 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:02.979 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 74.7763ms
2025-09-15 10:55:02.979 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:02.979 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 75.7361 ms
2025-09-15 10:55:02.979 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 76.2993ms
2025-09-15 10:55:04.574 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:55:04.574 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:04.574 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2856ms
2025-09-15 10:55:04.578 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 127
2025-09-15 10:55:04.578 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:04.579 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:04.579 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:04.589 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:04.601 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:04.623 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:55:04.625 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:04.625 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 46.3065ms
2025-09-15 10:55:04.626 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:04.626 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 47.0224 ms
2025-09-15 10:55:04.626 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 47.488ms
2025-09-15 10:55:06.663 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 121
2025-09-15 10:55:06.663 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:06.664 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:06.664 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:06.666 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:06.668 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:06.670 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:55:06.674 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:06.674 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 10.0727ms
2025-09-15 10:55:06.674 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:06.674 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 10.7110 ms
2025-09-15 10:55:06.674 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 11.1991ms
2025-09-15 10:55:09.296 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-09-15 10:55:09.296 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:09.297 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:09.297 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:09.300 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:09.301 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:09.306 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:55:09.309 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:09.309 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 11.7287ms
2025-09-15 10:55:09.309 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:09.309 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 12.4704 ms
2025-09-15 10:55:09.309 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 12.9785ms
2025-09-15 10:55:13.762 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:55:13.763 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:13.763 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2515ms
2025-09-15 10:55:13.766 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 129
2025-09-15 10:55:13.766 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:13.767 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:13.767 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:13.769 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:13.771 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:13.775 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:55:13.780 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:13.780 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 13.0867ms
2025-09-15 10:55:13.780 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:13.780 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 13.9444 ms
2025-09-15 10:55:13.781 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 14.4764ms
2025-09-15 10:55:16.511 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - null null
2025-09-15 10:55:16.512 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:16.512 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 204 null null 0.1952ms
2025-09-15 10:55:16.516 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - application/json null
2025-09-15 10:55:16.516 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:16.517 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:16.517 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:16.518 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:16.522 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:16.523 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:16.523 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 6.0962ms
2025-09-15 10:55:16.523 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:16.523 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840 responded 200 in 6.6597 ms
2025-09-15 10:55:16.523 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 200 null application/json; charset=utf-8 6.9521ms
2025-09-15 10:55:18.541 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-09-15 10:55:18.541 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:18.541 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:18.542 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:18.545 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:18.548 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:18.582 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset), @p28='?' (DbType = Guid), @p27='?' (DbType = DateTimeOffset), @p30='?' (DbType = Guid), @p29='?' (DbType = DateTimeOffset), @p32='?' (DbType = Guid), @p31='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [RoomMembers] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
UPDATE [RoomMembers] SET [LastActionDate] = @p27
OUTPUT 1
WHERE [Id] = @p28;
UPDATE [RoomMembers] SET [LastActionDate] = @p29
OUTPUT 1
WHERE [Id] = @p30;
UPDATE [Users] SET [LastActionDate] = @p31
OUTPUT 1
WHERE [Id] = @p32;
2025-09-15 10:55:18.584 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:18.585 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 42.9367ms
2025-09-15 10:55:18.585 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:18.585 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 43.8139 ms
2025-09-15 10:55:18.585 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 44.3081ms
2025-09-15 10:55:21.052 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:55:21.052 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:21.052 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3617ms
2025-09-15 10:55:21.056 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 122
2025-09-15 10:55:21.056 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:21.057 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:21.057 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:21.060 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:21.062 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:21.066 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset), @p28='?' (DbType = Guid), @p27='?' (DbType = DateTimeOffset), @p30='?' (DbType = Guid), @p29='?' (DbType = DateTimeOffset), @p32='?' (DbType = Guid), @p31='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [RoomMembers] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
UPDATE [RoomMembers] SET [LastActionDate] = @p27
OUTPUT 1
WHERE [Id] = @p28;
UPDATE [RoomMembers] SET [LastActionDate] = @p29
OUTPUT 1
WHERE [Id] = @p30;
UPDATE [Users] SET [LastActionDate] = @p31
OUTPUT 1
WHERE [Id] = @p32;
2025-09-15 10:55:21.068 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:21.069 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 11.1347ms
2025-09-15 10:55:21.069 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:21.069 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 12.3608 ms
2025-09-15 10:55:21.069 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 12.9454ms
2025-09-15 10:55:23.782 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - null null
2025-09-15 10:55:23.782 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:23.783 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 204 null null 0.554ms
2025-09-15 10:55:23.789 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - application/json null
2025-09-15 10:55:23.789 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:23.790 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:23.790 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:23.792 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:23.795 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:23.796 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:23.796 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 6.0221ms
2025-09-15 10:55:23.796 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:23.796 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24 responded 200 in 6.8483 ms
2025-09-15 10:55:23.796 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 200 null application/json; charset=utf-8 7.3939ms
2025-09-15 10:55:26.069 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-15 10:55:26.069 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:26.069 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.2175ms
2025-09-15 10:55:26.074 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-15 10:55:26.075 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:26.075 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:26.075 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:26.083 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:26.087 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:26.087 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:26.087 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 11.9797ms
2025-09-15 10:55:26.087 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:26.088 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 12.7770 ms
2025-09-15 10:55:26.088 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 14.1505ms
2025-09-15 10:55:31.280 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:55:31.280 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:31.280 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.277ms
2025-09-15 10:55:31.284 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-09-15 10:55:31.284 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:31.284 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:31.285 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:31.296 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:31.308 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:31.327 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:55:31.330 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:31.330 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 45.4425ms
2025-09-15 10:55:31.330 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:31.330 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 46.0986 ms
2025-09-15 10:55:31.330 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 46.5716ms
2025-09-15 10:55:32.449 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:55:32.450 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:32.450 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.4139ms
2025-09-15 10:55:32.472 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:55:32.472 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:32.474 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:55:32.474 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:55:32.486 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:32.521 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:55:32.522 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:32.522 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 47.8363ms
2025-09-15 10:55:32.522 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:55:32.522 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 50.0995 ms
2025-09-15 10:55:32.522 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 50.5275ms
2025-09-15 10:55:34.875 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 10:55:34.875 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:34.875 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 0.2386ms
2025-09-15 10:55:34.880 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 10:55:34.880 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:34.881 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:34.882 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:34.895 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:34.956 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:34.956 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:34.956 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 74.617ms
2025-09-15 10:55:34.956 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:34.956 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 75.9190 ms
2025-09-15 10:55:34.956 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 76.4003ms
2025-09-15 10:55:37.697 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - null null
2025-09-15 10:55:37.697 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:37.698 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 204 null null 0.1592ms
2025-09-15 10:55:37.703 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - application/json null
2025-09-15 10:55:37.703 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:37.704 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:37.704 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:37.710 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:37.713 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:37.713 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:37.713 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 9.2586ms
2025-09-15 10:55:37.713 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:37.713 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24 responded 200 in 10.2266 ms
2025-09-15 10:55:37.713 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/f87e99d8-2cc8-4129-93a7-17059d693f24?page=1&pageSize=50 - 200 null application/json; charset=utf-8 10.8198ms
2025-09-15 10:55:40.824 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - null null
2025-09-15 10:55:40.824 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:40.824 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 204 null null 0.3386ms
2025-09-15 10:55:40.828 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - application/json null
2025-09-15 10:55:40.828 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:40.828 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:40.829 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:40.830 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:40.834 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:40.834 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:40.835 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 6.0028ms
2025-09-15 10:55:40.835 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:40.835 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840 responded 200 in 6.9791 ms
2025-09-15 10:55:40.836 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 200 null application/json; charset=utf-8 7.6798ms
2025-09-15 10:55:43.849 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 10:55:43.850 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:43.850 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 0.8557ms
2025-09-15 10:55:43.856 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 10:55:43.856 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:43.857 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:43.857 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:43.859 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:43.863 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:43.864 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:43.864 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 7.1945ms
2025-09-15 10:55:43.864 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:43.864 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 8.0599 ms
2025-09-15 10:55:43.865 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 8.6943ms
2025-09-15 10:55:46.950 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:55:46.950 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:46.950 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2788ms
2025-09-15 10:55:46.954 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 127
2025-09-15 10:55:46.954 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:46.955 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:46.955 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:46.969 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:46.984 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:47.022 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:55:47.024 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:47.024 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 69.1743ms
2025-09-15 10:55:47.024 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:47.024 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 69.7880 ms
2025-09-15 10:55:47.024 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 70.1751ms
2025-09-15 10:55:51.011 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 127
2025-09-15 10:55:51.011 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:51.011 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:51.011 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:51.021 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:55:51.032 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:55:51.066 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-15 10:55:51.069 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:51.069 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 57.5097ms
2025-09-15 10:55:51.069 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:55:51.069 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 58.4664 ms
2025-09-15 10:55:51.069 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 58.9557ms
2025-09-15 10:55:54.179 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:55:54.179 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:54.179 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.2644ms
2025-09-15 10:55:54.188 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:55:54.188 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:54.189 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:55:54.189 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:55:54.197 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:54.232 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:55:54.232 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:54.232 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 43.3969ms
2025-09-15 10:55:54.233 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:55:54.233 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 44.3787 ms
2025-09-15 10:55:54.233 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 44.7575ms
2025-09-15 10:55:57.272 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 10:55:57.272 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:57.272 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 0.2742ms
2025-09-15 10:55:57.277 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 10:55:57.277 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:55:57.278 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:57.278 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:55:57.287 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:55:57.362 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:55:57.363 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:55:57.363 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 84.8284ms
2025-09-15 10:55:57.363 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:55:57.363 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 85.4315 ms
2025-09-15 10:55:57.363 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 85.8452ms
2025-09-15 10:56:14.691 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - null null
2025-09-15 10:56:14.692 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:56:14.692 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 204 null null 0.7077ms
2025-09-15 10:56:14.698 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - application/json null
2025-09-15 10:56:14.698 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:56:14.699 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:56:14.699 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:56:14.703 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:56:14.707 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 10:56:14.707 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:56:14.708 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 8.2726ms
2025-09-15 10:56:14.708 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 10:56:14.708 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840 responded 200 in 9.2827 ms
2025-09-15 10:56:14.708 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 200 null application/json; charset=utf-8 9.7139ms
2025-09-15 10:56:17.629 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-15 10:56:17.629 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:56:17.629 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2771ms
2025-09-15 10:56:17.633 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 126
2025-09-15 10:56:17.634 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:56:17.634 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:56:17.634 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 10:56:17.646 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-15 10:56:17.659 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-15 10:56:17.685 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset), @p28='?' (DbType = Guid), @p27='?' (DbType = DateTimeOffset), @p30='?' (DbType = Guid), @p29='?' (DbType = DateTimeOffset), @p32='?' (DbType = Guid), @p31='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [RoomMembers] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
UPDATE [RoomMembers] SET [LastActionDate] = @p27
OUTPUT 1
WHERE [Id] = @p28;
UPDATE [RoomMembers] SET [LastActionDate] = @p29
OUTPUT 1
WHERE [Id] = @p30;
UPDATE [Users] SET [LastActionDate] = @p31
OUTPUT 1
WHERE [Id] = @p32;
2025-09-15 10:56:17.687 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:56:17.688 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 53.3901ms
2025-09-15 10:56:17.688 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-15 10:56:17.688 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 54.1563 ms
2025-09-15 10:56:17.688 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 54.5987ms
2025-09-15 10:56:20.574 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 10:56:20.574 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:56:20.574 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.2711ms
2025-09-15 10:56:20.592 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 10:56:20.593 +03:00 [INF] CORS policy execution successful.
2025-09-15 10:56:20.593 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:56:20.593 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 10:56:20.596 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 10:56:20.600 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 10:56:20.600 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 10:56:20.600 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 7.2706ms
2025-09-15 10:56:20.600 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 10:56:20.600 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 7.6983 ms
2025-09-15 10:56:20.600 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 8.0304ms
2025-09-15 12:03:28.098 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 12:03:28.105 +03:00 [INF] CORS policy execution successful.
2025-09-15 12:03:28.107 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 9.4458ms
2025-09-15 12:03:28.122 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 12:03:28.124 +03:00 [INF] CORS policy execution successful.
2025-09-15 12:03:28.144 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 12:03:28.148 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 12:03:28.193 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 12:03:28.241 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 12:03:28.243 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 12:03:28.247 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 98.565ms
2025-09-15 12:03:28.247 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 12:03:28.247 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 118.7898 ms
2025-09-15 12:03:28.247 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 125.0892ms
2025-09-15 12:04:15.816 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - null null
2025-09-15 12:04:15.818 +03:00 [INF] CORS policy execution successful.
2025-09-15 12:04:15.818 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 204 null null 1.8152ms
2025-09-15 12:04:15.824 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - application/json null
2025-09-15 12:04:15.824 +03:00 [INF] CORS policy execution successful.
2025-09-15 12:04:15.830 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 12:04:15.832 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-15 12:04:15.847 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 12:04:15.928 +03:00 [INF] Executed DbCommand (70ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-15 12:04:15.930 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 12:04:15.932 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 99.7969ms
2025-09-15 12:04:15.932 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-15 12:04:15.932 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b responded 200 in 107.6868 ms
2025-09-15 12:04:15.932 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/1fd27797-0444-4aec-90c3-d964b1cfc85b?page=1&pageSize=50 - 200 null application/json; charset=utf-8 108.4214ms
2025-09-15 12:47:32.068 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 12:47:32.069 +03:00 [INF] CORS policy execution successful.
2025-09-15 12:47:32.069 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.4211ms
2025-09-15 12:47:32.123 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 12:47:32.123 +03:00 [INF] CORS policy execution successful.
2025-09-15 12:47:32.125 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 12:47:32.125 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 12:47:32.146 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 12:47:32.238 +03:00 [INF] Executed DbCommand (91ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 12:47:32.239 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 12:47:32.241 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 116.295ms
2025-09-15 12:47:32.242 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 12:47:32.242 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 118.6600 ms
2025-09-15 12:47:32.245 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 121.5027ms
2025-09-15 13:18:48.663 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 13:18:48.664 +03:00 [INF] CORS policy execution successful.
2025-09-15 13:18:48.664 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 1.3628ms
2025-09-15 13:18:48.703 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 13:18:48.705 +03:00 [INF] CORS policy execution successful.
2025-09-15 13:18:48.709 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 13:18:48.709 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 13:18:48.730 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 13:18:48.774 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 13:18:48.775 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 13:18:48.777 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 67.3037ms
2025-09-15 13:18:48.777 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 13:18:48.777 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 70.4887 ms
2025-09-15 13:18:48.777 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 74.0474ms
2025-09-15 13:33:15.906 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-15 13:33:15.907 +03:00 [INF] CORS policy execution successful.
2025-09-15 13:33:15.907 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.3228ms
2025-09-15 13:33:15.918 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-15 13:33:15.918 +03:00 [INF] CORS policy execution successful.
2025-09-15 13:33:15.931 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 13:33:15.933 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-15 13:33:15.947 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-15 13:33:15.990 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-15 13:33:15.991 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-15 13:33:15.992 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 58.8119ms
2025-09-15 13:33:15.992 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-15 13:33:15.993 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 73.3477 ms
2025-09-15 13:33:15.993 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 74.9598ms
