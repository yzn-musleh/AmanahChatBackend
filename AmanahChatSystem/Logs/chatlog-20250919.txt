2025-09-19 23:39:34.986 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-19 23:39:35.570 +03:00 [INF] Now listening on: https://localhost:7003
2025-09-19 23:39:35.570 +03:00 [INF] Now listening on: http://localhost:5277
2025-09-19 23:39:35.579 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-19 23:39:35.580 +03:00 [INF] Hosting environment: Development
2025-09-19 23:39:35.581 +03:00 [INF] Content root path: C:\Users\hp\Projects\Dotnet projects\AmanahChatBackend\AmanahChatSystem
2025-09-19 23:39:36.434 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger - null null
2025-09-19 23:39:36.713 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger - 301 0 null 283.3186ms
2025-09-19 23:39:36.726 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-09-19 23:39:36.926 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 199.3815ms
2025-09-19 23:39:36.964 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/swagger-ui.css - null null
2025-09-19 23:39:36.972 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/swagger-ui-bundle.js - null null
2025-09-19 23:39:36.975 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/swagger-ui-standalone-preset.js - null null
2025-09-19 23:39:36.976 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-09-19 23:39:36.977 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-09-19 23:39:36.994 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 18.1365ms
2025-09-19 23:39:37.011 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-09-19 23:39:37.011 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-09-19 23:39:37.015 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/swagger-ui.css - 200 143943 text/css 50.3432ms
2025-09-19 23:39:37.015 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 39.5132ms
2025-09-19 23:39:37.029 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-09-19 23:39:37.029 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 56.76ms
2025-09-19 23:39:37.053 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.5214ms
2025-09-19 23:39:37.960 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-09-19 23:39:38.314 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 354.2687ms
2025-09-19 23:39:40.451 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-19 23:39:40.451 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-09-19 23:39:40.461 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:40.461 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:40.464 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 13.1155ms
2025-09-19 23:39:40.465 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 13.8696ms
2025-09-19 23:39:40.477 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-19 23:39:40.486 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-09-19 23:39:40.487 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:40.488 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:40.864 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:39:40.864 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-09-19 23:39:40.879 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-09-19 23:39:40.884 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 388.2378 ms
2025-09-19 23:39:40.886 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 400.8814ms
2025-09-19 23:39:40.933 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-19 23:39:41.081 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=k04QRb0qyQrptGP4gCAxuw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZDg4MDVkMS0zYjViLTRiOTktYjIyNi1lYzQ3MjkzYjI0ZDQiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiJkM2IzMzNiOS04OTYzLTRmMjUtOTkwYS1jYzhjNTZmNWZkOTYiLCJleHAiOjE3NTg1MjAzNTgsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.xEw7WmQ41clfmFcg8kK6XyvGOf9hYzcq1xd-gB42bjg - null null
2025-09-19 23:39:41.083 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:41.095 +03:00 [INF] Executing endpoint '/chatHub'
2025-09-19 23:39:43.673 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:39:44.182 +03:00 [INF] Executed DbCommand (221ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-19 23:39:44.202 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:39:44.267 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 3326.4029ms
2025-09-19 23:39:44.268 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:39:44.271 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 3779.9589 ms
2025-09-19 23:39:44.283 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 3806.7769ms
2025-09-19 23:39:50.707 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - null null
2025-09-19 23:39:50.707 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:50.708 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 204 null null 1.3462ms
2025-09-19 23:39:50.714 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:39:50.720 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:50.721 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:39:50.738 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:39:50.877 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:39:50.926 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:39:51.066 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:39:51.078 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 339.1447ms
2025-09-19 23:39:51.078 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:39:51.078 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 357.9785 ms
2025-09-19 23:39:51.079 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 364.246ms
2025-09-19 23:39:56.815 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - null null
2025-09-19 23:39:56.816 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:56.816 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 204 null null 0.527ms
2025-09-19 23:39:56.819 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - application/json null
2025-09-19 23:39:56.821 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:56.822 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:39:56.832 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:39:56.910 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:39:57.076 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:39:57.077 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:39:57.081 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 248.7377ms
2025-09-19 23:39:57.081 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:39:57.081 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7 responded 200 in 260.5324 ms
2025-09-19 23:39:57.082 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 200 null application/json; charset=utf-8 262.8282ms
2025-09-19 23:39:59.726 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:39:59.727 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:59.728 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 1.7016ms
2025-09-19 23:39:59.731 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-09-19 23:39:59.731 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:39:59.732 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:39:59.741 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:39:59.844 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:39:59.945 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:40:00.292 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-09-19 23:40:00.332 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:00.335 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 593.244ms
2025-09-19 23:40:00.335 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:00.335 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 603.5793 ms
2025-09-19 23:40:00.336 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 604.3897ms
2025-09-19 23:40:05.751 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:40:05.751 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:05.752 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.9548ms
2025-09-19 23:40:05.759 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 121
2025-09-19 23:40:05.759 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:05.760 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:05.760 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:05.782 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:40:05.796 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:40:05.815 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-09-19 23:40:05.817 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:05.817 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 56.9254ms
2025-09-19 23:40:05.817 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:05.817 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 58.0010 ms
2025-09-19 23:40:05.817 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 58.6595ms
2025-09-19 23:40:08.856 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-09-19 23:40:08.857 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:08.857 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:08.858 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:08.876 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:40:08.891 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:40:08.927 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-09-19 23:40:08.930 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:08.930 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 72.1981ms
2025-09-19 23:40:08.930 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:08.930 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 73.3991 ms
2025-09-19 23:40:08.930 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 74.3302ms
2025-09-19 23:40:13.549 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/b85ba339-423d-4c31-b7ac-f81c727bca2d?page=1&pageSize=50 - null null
2025-09-19 23:40:13.550 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:13.550 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/b85ba339-423d-4c31-b7ac-f81c727bca2d?page=1&pageSize=50 - 204 null null 0.7435ms
2025-09-19 23:40:13.556 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/b85ba339-423d-4c31-b7ac-f81c727bca2d?page=1&pageSize=50 - application/json null
2025-09-19 23:40:13.556 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:13.557 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:13.558 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:13.572 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:40:13.644 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:40:13.647 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:13.649 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 90.9424ms
2025-09-19 23:40:13.649 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:13.649 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/b85ba339-423d-4c31-b7ac-f81c727bca2d responded 200 in 92.7193 ms
2025-09-19 23:40:13.649 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/b85ba339-423d-4c31-b7ac-f81c727bca2d?page=1&pageSize=50 - 200 null application/json; charset=utf-8 93.3737ms
2025-09-19 23:40:16.286 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - null null
2025-09-19 23:40:16.286 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:16.287 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 204 null null 0.4336ms
2025-09-19 23:40:16.290 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - application/json null
2025-09-19 23:40:16.290 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:16.290 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:16.291 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:16.308 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:40:16.371 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:40:16.371 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:16.371 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 80.6366ms
2025-09-19 23:40:16.371 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:16.371 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7 responded 200 in 81.4732 ms
2025-09-19 23:40:16.372 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 200 null application/json; charset=utf-8 82.0021ms
2025-09-19 23:40:24.489 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - null null
2025-09-19 23:40:24.490 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:24.490 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 204 null null 0.5069ms
2025-09-19 23:40:24.495 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - application/json null
2025-09-19 23:40:24.496 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:24.497 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:24.498 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:24.511 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:40:24.593 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:40:24.594 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:24.594 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 96.3533ms
2025-09-19 23:40:24.594 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:24.594 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459 responded 200 in 98.3642 ms
2025-09-19 23:40:24.594 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/90e76504-7c2d-4e8c-8dbc-3d9106b58459?page=1&pageSize=50 - 200 null application/json; charset=utf-8 99.2982ms
2025-09-19 23:40:30.103 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:40:30.103 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:30.104 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.4421ms
2025-09-19 23:40:30.107 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 126
2025-09-19 23:40:30.107 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:30.108 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:30.108 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:30.119 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:40:30.129 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:40:30.175 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-19 23:40:30.179 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:30.179 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 71.4759ms
2025-09-19 23:40:30.179 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:30.180 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 72.3038 ms
2025-09-19 23:40:30.180 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 72.9198ms
2025-09-19 23:40:35.719 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - null null
2025-09-19 23:40:35.719 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:35.719 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 204 null null 0.428ms
2025-09-19 23:40:35.725 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - application/json null
2025-09-19 23:40:35.726 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:35.727 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:35.727 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:35.747 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:40:35.816 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:40:35.817 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:35.817 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 89.9517ms
2025-09-19 23:40:35.817 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:35.817 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840 responded 200 in 91.1341 ms
2025-09-19 23:40:35.817 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 200 null application/json; charset=utf-8 91.828ms
2025-09-19 23:40:37.603 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:40:37.603 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:37.603 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3101ms
2025-09-19 23:40:37.606 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 122
2025-09-19 23:40:37.606 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:37.607 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:37.607 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:37.617 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:40:37.626 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:40:37.654 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset), @p28='?' (DbType = Guid), @p27='?' (DbType = DateTimeOffset), @p30='?' (DbType = Guid), @p29='?' (DbType = DateTimeOffset), @p32='?' (DbType = Guid), @p31='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [RoomMembers] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
UPDATE [RoomMembers] SET [LastActionDate] = @p27
OUTPUT 1
WHERE [Id] = @p28;
UPDATE [RoomMembers] SET [LastActionDate] = @p29
OUTPUT 1
WHERE [Id] = @p30;
UPDATE [Users] SET [LastActionDate] = @p31
OUTPUT 1
WHERE [Id] = @p32;
2025-09-19 23:40:37.657 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:37.657 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 49.7036ms
2025-09-19 23:40:37.657 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:40:37.657 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 50.4958 ms
2025-09-19 23:40:37.657 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 50.9747ms
2025-09-19 23:40:41.299 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - null null
2025-09-19 23:40:41.299 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:41.299 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 204 null null 0.4685ms
2025-09-19 23:40:41.303 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - application/json null
2025-09-19 23:40:41.303 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:40:41.305 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:41.305 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:40:41.318 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:40:41.373 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:40:41.374 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:40:41.374 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 68.5127ms
2025-09-19 23:40:41.374 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:40:41.374 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840 responded 200 in 70.1060 ms
2025-09-19 23:40:41.374 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 200 null application/json; charset=utf-8 70.9401ms
2025-09-19 23:42:02.329 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - null null
2025-09-19 23:42:02.329 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:42:02.329 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 204 null null 0.4591ms
2025-09-19 23:42:02.334 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - application/json null
2025-09-19 23:42:02.334 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:42:02.335 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:42:02.335 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:42:02.347 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:42:02.398 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:42:02.398 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:42:02.399 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 63.738ms
2025-09-19 23:42:02.399 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:42:02.399 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840 responded 200 in 64.5983 ms
2025-09-19 23:42:02.399 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/849f1dd0-2db5-4700-a3e3-88421a20f840?page=1&pageSize=50 - 200 null application/json; charset=utf-8 65.2058ms
2025-09-19 23:42:06.160 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:42:06.160 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:42:06.160 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.511ms
2025-09-19 23:42:06.163 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 121
2025-09-19 23:42:06.164 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:42:06.164 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:42:06.165 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:42:06.175 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:42:06.185 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:42:06.222 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset), @p28='?' (DbType = Guid), @p27='?' (DbType = DateTimeOffset), @p30='?' (DbType = Guid), @p29='?' (DbType = DateTimeOffset), @p32='?' (DbType = Guid), @p31='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [RoomMembers] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
UPDATE [RoomMembers] SET [LastActionDate] = @p27
OUTPUT 1
WHERE [Id] = @p28;
UPDATE [RoomMembers] SET [LastActionDate] = @p29
OUTPUT 1
WHERE [Id] = @p30;
UPDATE [Users] SET [LastActionDate] = @p31
OUTPUT 1
WHERE [Id] = @p32;
2025-09-19 23:42:06.225 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:42:06.225 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 60.6644ms
2025-09-19 23:42:06.225 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:42:06.225 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 61.5640 ms
2025-09-19 23:42:06.226 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 62.2857ms
2025-09-19 23:43:37.312 +03:00 [INF] Executed endpoint '/chatHub'
2025-09-19 23:43:37.312 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 236229.5320 ms
2025-09-19 23:43:37.313 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=k04QRb0qyQrptGP4gCAxuw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZDg4MDVkMS0zYjViLTRiOTktYjIyNi1lYzQ3MjkzYjI0ZDQiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiJkM2IzMzNiOS04OTYzLTRmMjUtOTkwYS1jYzhjNTZmNWZkOTYiLCJleHAiOjE3NTg1MjAzNTgsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.xEw7WmQ41clfmFcg8kK6XyvGOf9hYzcq1xd-gB42bjg - 200 null null 236231.2801ms
2025-09-19 23:43:37.789 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-19 23:43:37.789 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:37.789 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.46ms
2025-09-19 23:43:37.797 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-19 23:43:37.798 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:37.799 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:43:37.799 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-19 23:43:37.809 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-09-19 23:43:37.809 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:37.810 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.9687ms
2025-09-19 23:43:37.828 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-09-19 23:43:37.828 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:37.831 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-09-19 23:43:37.832 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-09-19 23:43:37.833 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 3.9857 ms
2025-09-19 23:43:37.833 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 5.1613ms
2025-09-19 23:43:37.881 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:43:37.970 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-19 23:43:37.970 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:43:37.971 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 171.5489ms
2025-09-19 23:43:37.971 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:43:37.971 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 172.9858 ms
2025-09-19 23:43:37.971 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 173.5941ms
2025-09-19 23:43:38.547 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=_8VCqAMN_Imahai-3F9bFg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZDg4MDVkMS0zYjViLTRiOTktYjIyNi1lYzQ3MjkzYjI0ZDQiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiJkM2IzMzNiOS04OTYzLTRmMjUtOTkwYS1jYzhjNTZmNWZkOTYiLCJleHAiOjE3NTg1MjAzNTgsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.xEw7WmQ41clfmFcg8kK6XyvGOf9hYzcq1xd-gB42bjg - null null
2025-09-19 23:43:38.547 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:38.548 +03:00 [INF] Executing endpoint '/chatHub'
2025-09-19 23:43:43.661 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/3ecc55be-6fed-497d-ab77-035a9b06221d?page=1&pageSize=50 - null null
2025-09-19 23:43:43.661 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:43.661 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/3ecc55be-6fed-497d-ab77-035a9b06221d?page=1&pageSize=50 - 204 null null 0.2803ms
2025-09-19 23:43:43.666 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/3ecc55be-6fed-497d-ab77-035a9b06221d?page=1&pageSize=50 - application/json null
2025-09-19 23:43:43.666 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:43.666 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:43:43.667 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:43:43.678 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:43:43.741 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:43:43.741 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:43:43.741 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 74.7991ms
2025-09-19 23:43:43.741 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:43:43.741 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/3ecc55be-6fed-497d-ab77-035a9b06221d responded 200 in 75.5794 ms
2025-09-19 23:43:43.742 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/3ecc55be-6fed-497d-ab77-035a9b06221d?page=1&pageSize=50 - 200 null application/json; charset=utf-8 76.0654ms
2025-09-19 23:43:46.805 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:43:46.805 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:46.805 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2821ms
2025-09-19 23:43:46.807 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 122
2025-09-19 23:43:46.808 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:43:46.808 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:43:46.808 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:43:46.819 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:43:46.828 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:43:46.851 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-09-19 23:43:46.852 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:43:46.852 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 43.8147ms
2025-09-19 23:43:46.852 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:43:46.852 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 44.5578 ms
2025-09-19 23:43:46.852 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 45.0032ms
2025-09-19 23:44:23.891 +03:00 [INF] Executed endpoint '/chatHub'
2025-09-19 23:44:23.891 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 45344.1495 ms
2025-09-19 23:44:23.892 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=_8VCqAMN_Imahai-3F9bFg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZDg4MDVkMS0zYjViLTRiOTktYjIyNi1lYzQ3MjkzYjI0ZDQiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiJkM2IzMzNiOS04OTYzLTRmMjUtOTkwYS1jYzhjNTZmNWZkOTYiLCJleHAiOjE3NTg1MjAzNTgsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.xEw7WmQ41clfmFcg8kK6XyvGOf9hYzcq1xd-gB42bjg - 200 null null 45345.1876ms
2025-09-19 23:44:24.204 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-09-19 23:44:24.204 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-19 23:44:24.204 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:24.204 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.4563ms
2025-09-19 23:44:24.205 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:24.205 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.9867ms
2025-09-19 23:44:24.215 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-09-19 23:44:24.215 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:24.217 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-19 23:44:24.218 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:24.218 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-09-19 23:44:24.219 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-09-19 23:44:24.220 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 3.8094 ms
2025-09-19 23:44:24.220 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 5.2249ms
2025-09-19 23:44:24.221 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:44:24.221 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-19 23:44:24.388 +03:00 [INF] Executed DbCommand (162ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:44:24.461 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-19 23:44:24.462 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:44:24.464 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 242.7225ms
2025-09-19 23:44:24.464 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:44:24.465 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 246.5201 ms
2025-09-19 23:44:24.466 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 249.0775ms
2025-09-19 23:44:24.740 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=OqNNQr6QCGQLU8FSBsX-0w&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZDg4MDVkMS0zYjViLTRiOTktYjIyNi1lYzQ3MjkzYjI0ZDQiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiJkM2IzMzNiOS04OTYzLTRmMjUtOTkwYS1jYzhjNTZmNWZkOTYiLCJleHAiOjE3NTg1MjAzNTgsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.xEw7WmQ41clfmFcg8kK6XyvGOf9hYzcq1xd-gB42bjg - null null
2025-09-19 23:44:24.743 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:24.745 +03:00 [INF] Executing endpoint '/chatHub'
2025-09-19 23:44:28.093 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - null null
2025-09-19 23:44:28.093 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:28.093 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 204 null null 0.2464ms
2025-09-19 23:44:28.098 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - application/json null
2025-09-19 23:44:28.099 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:28.099 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:44:28.099 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:44:28.105 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:44:28.177 +03:00 [INF] Executed DbCommand (70ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:44:28.177 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:44:28.178 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 78.464ms
2025-09-19 23:44:28.178 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:44:28.178 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7 responded 200 in 79.0664 ms
2025-09-19 23:44:28.178 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 200 null application/json; charset=utf-8 79.5374ms
2025-09-19 23:44:36.129 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:44:36.129 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:36.129 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2524ms
2025-09-19 23:44:36.132 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 138
2025-09-19 23:44:36.132 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:36.132 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:44:36.133 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:44:36.179 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:44:36.216 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:44:36.250 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-09-19 23:44:36.252 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:44:36.252 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 119.556ms
2025-09-19 23:44:36.252 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:44:36.252 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 120.3783 ms
2025-09-19 23:44:36.253 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 120.9245ms
2025-09-19 23:44:42.065 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-09-19 23:44:42.067 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:42.067 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 1.44ms
2025-09-19 23:44:42.071 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 129
2025-09-19 23:44:42.072 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:44:42.072 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:44:42.073 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:44:42.090 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-09-19 23:44:42.103 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-09-19 23:44:42.130 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [RoomMembers] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-09-19 23:44:42.133 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:44:42.133 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 60.4314ms
2025-09-19 23:44:42.133 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-09-19 23:44:42.133 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 61.3359 ms
2025-09-19 23:44:42.133 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 62.4163ms
2025-09-19 23:48:27.905 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - null null
2025-09-19 23:48:27.905 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:48:27.905 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 204 null null 0.2715ms
2025-09-19 23:48:27.909 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:48:27.909 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:48:27.910 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:48:27.910 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:48:27.918 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:48:27.924 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:48:27.926 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:48:27.926 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 15.9233ms
2025-09-19 23:48:27.926 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:48:27.926 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 16.5400 ms
2025-09-19 23:48:27.926 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 16.9472ms
2025-09-19 23:48:29.734 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:48:29.734 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:48:29.735 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:48:29.735 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:48:29.737 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:48:29.739 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:48:29.739 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:48:29.739 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 4.2874ms
2025-09-19 23:48:29.739 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:48:29.739 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 5.1702 ms
2025-09-19 23:48:29.739 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 5.664ms
2025-09-19 23:49:14.176 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - null null
2025-09-19 23:49:14.176 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:49:14.176 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 204 null null 0.2648ms
2025-09-19 23:49:14.178 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:49:14.179 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:49:14.179 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:49:14.179 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:49:14.187 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:49:14.196 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:49:14.196 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:49:14.197 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 17.4479ms
2025-09-19 23:49:14.197 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:49:14.197 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 18.0095 ms
2025-09-19 23:49:14.197 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 18.4492ms
2025-09-19 23:49:38.146 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - null null
2025-09-19 23:49:38.146 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:49:38.146 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 204 null null 0.272ms
2025-09-19 23:49:38.149 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:49:38.149 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:49:38.150 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:49:38.150 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:49:38.157 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:49:38.163 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:49:38.163 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:49:38.164 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 13.5024ms
2025-09-19 23:49:38.164 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:49:38.164 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 14.0838 ms
2025-09-19 23:49:38.164 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 14.7298ms
2025-09-19 23:49:40.877 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:49:40.877 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:49:40.877 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:49:40.877 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:49:40.880 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:49:40.884 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:49:40.884 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:49:40.884 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 6.935ms
2025-09-19 23:49:40.885 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:49:40.885 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 7.7544 ms
2025-09-19 23:49:40.885 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 8.2113ms
2025-09-19 23:59:07.673 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - null null
2025-09-19 23:59:07.673 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:07.673 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 204 null null 0.4096ms
2025-09-19 23:59:07.678 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - application/json null
2025-09-19 23:59:07.678 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:07.680 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:59:07.680 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-09-19 23:59:07.693 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:59:07.754 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-09-19 23:59:07.754 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:59:07.755 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 74.6027ms
2025-09-19 23:59:07.755 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-09-19 23:59:07.755 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7 responded 200 in 76.3236 ms
2025-09-19 23:59:07.755 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0dde964b-29f7-402e-ab48-ce4b663945a7?page=1&pageSize=50 - 200 null application/json; charset=utf-8 76.9819ms
2025-09-19 23:59:35.588 +03:00 [INF] Executed endpoint '/chatHub'
2025-09-19 23:59:35.589 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 910845.2230 ms
2025-09-19 23:59:35.589 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=OqNNQr6QCGQLU8FSBsX-0w&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZDg4MDVkMS0zYjViLTRiOTktYjIyNi1lYzQ3MjkzYjI0ZDQiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiJkM2IzMzNiOS04OTYzLTRmMjUtOTkwYS1jYzhjNTZmNWZkOTYiLCJleHAiOjE3NTg1MjAzNTgsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.xEw7WmQ41clfmFcg8kK6XyvGOf9hYzcq1xd-gB42bjg - 200 null null 910848.3594ms
2025-09-19 23:59:36.006 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - null null
2025-09-19 23:59:36.006 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:36.006 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 204 null null 0.2961ms
2025-09-19 23:59:36.010 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - application/json null
2025-09-19 23:59:36.010 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:36.011 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:59:36.011 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-09-19 23:59:36.017 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-09-19 23:59:36.017 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:36.018 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.4793ms
2025-09-19 23:59:36.030 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-09-19 23:59:36.031 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:36.032 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-09-19 23:59:36.032 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-09-19 23:59:36.032 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.8126 ms
2025-09-19 23:59:36.033 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 2.1323ms
2025-09-19 23:59:36.062 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:59:36.165 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-09-19 23:59:36.166 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:59:36.166 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 155.1142ms
2025-09-19 23:59:36.166 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-09-19 23:59:36.166 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 155.9489 ms
2025-09-19 23:59:36.166 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser - 200 null application/json; charset=utf-8 156.4558ms
2025-09-19 23:59:36.410 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=CStPXWnZ_HcNdiOAH80bTg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZDg4MDVkMS0zYjViLTRiOTktYjIyNi1lYzQ3MjkzYjI0ZDQiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiJkM2IzMzNiOS04OTYzLTRmMjUtOTkwYS1jYzhjNTZmNWZkOTYiLCJleHAiOjE3NTg1MjAzNTgsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.xEw7WmQ41clfmFcg8kK6XyvGOf9hYzcq1xd-gB42bjg - null null
2025-09-19 23:59:36.410 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:36.410 +03:00 [INF] Executing endpoint '/chatHub'
2025-09-19 23:59:48.757 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - null null
2025-09-19 23:59:48.757 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:48.757 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 204 null null 0.1962ms
2025-09-19 23:59:48.759 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:59:48.759 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:48.760 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:59:48.760 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:59:48.767 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:59:48.771 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:59:48.772 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:59:48.772 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 11.8847ms
2025-09-19 23:59:48.772 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:59:48.772 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 12.3426 ms
2025-09-19 23:59:48.772 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 12.6958ms
2025-09-19 23:59:56.769 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - null null
2025-09-19 23:59:56.769 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:56.769 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 204 null null 0.1941ms
2025-09-19 23:59:56.773 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - application/json null
2025-09-19 23:59:56.773 +03:00 [INF] CORS policy execution successful.
2025-09-19 23:59:56.774 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:59:56.774 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-09-19 23:59:56.781 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkspaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-19 23:59:56.800 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_WorkspaceId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkspaceId_0 AND [u].[Id] <> @__request_UserId_1
2025-09-19 23:59:56.801 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-19 23:59:56.801 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 27.0065ms
2025-09-19 23:59:56.801 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-09-19 23:59:56.801 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 27.6506 ms
2025-09-19 23:59:56.801 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=d3b333b9-8963-4f25-990a-cc8c56f5fd96 - 200 null application/json; charset=utf-8 28.1189ms
