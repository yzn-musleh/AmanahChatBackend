2025-08-12 08:54:44.999 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-12 08:54:45.042 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-12 08:54:45.044 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-12 08:54:45.045 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-12 08:54:45.060 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-12 08:54:45.070 +03:00 [INF] Applying migration '20250812055425_FeatureOnetoOne'.
2025-08-12 08:54:45.165 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ChatRooms] ADD [Type] int NOT NULL DEFAULT 0;
2025-08-12 08:54:45.169 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ChatRooms] ADD [UniqueDirectKey] nvarchar(max) NULL;
2025-08-12 08:54:45.174 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250812055425_FeatureOnetoOne', N'8.0.13');
2025-08-12 09:18:10.305 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 09:18:10.729 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 09:18:10.730 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 09:18:10.734 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 09:18:10.735 +03:00 [INF] Hosting environment: Development
2025-08-12 09:18:10.736 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 09:18:11.569 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:18:11.831 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 264.2483ms
2025-08-12 09:18:11.882 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:18:11.882 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:18:11.891 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 8.6539ms
2025-08-12 09:18:11.968 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 86ms
2025-08-12 09:18:12.564 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:18:12.649 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 84.5791ms
2025-08-12 09:18:25.805 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 09:18:25.813 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:25.817 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 11.5005ms
2025-08-12 09:18:25.834 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 35
2025-08-12 09:18:25.840 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:25.904 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 09:18:25.933 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:18:27.358 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 09:18:27.527 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 09:18:27.552 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 1614.0413ms
2025-08-12 09:18:27.553 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 09:18:27.557 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 1708.5172 ms
2025-08-12 09:18:27.568 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 1734.637ms
2025-08-12 09:18:27.613 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 09:18:27.614 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:27.614 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 1.044ms
2025-08-12 09:18:27.634 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 09:18:27.635 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:18:27.635 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:27.635 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:27.635 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.7155ms
2025-08-12 09:18:27.635 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.7943ms
2025-08-12 09:18:27.670 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 09:18:27.671 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:27.674 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:18:27.674 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 09:18:27.674 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:27.676 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:27.747 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 09:18:27.747 +03:00 [INF] HTTP GET /api/Users responded 404 in 72.2948 ms
2025-08-12 09:18:27.747 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 73.5674ms
2025-08-12 09:18:27.748 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 09:18:27.755 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:18:27.762 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 09:18:27.768 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:18:27.900 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 09:18:27.911 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:27.962 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:27.975 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 213.1729ms
2025-08-12 09:18:27.975 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 09:18:27.975 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 304.6876 ms
2025-08-12 09:18:27.976 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 499 null application/json; charset=utf-8 305.5521ms
2025-08-12 09:18:28.093 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], [t].[Title], [t].[Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r0]
    WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [r].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[Title]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [r].[LastActionDate] DESC
2025-08-12 09:18:28.098 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:28.105 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 336.702ms
2025-08-12 09:18:28.105 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:18:28.105 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 428.5288 ms
2025-08-12 09:18:28.106 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 431.8891ms
2025-08-12 09:18:31.818 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:18:31.819 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:31.824 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:18:31.824 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:18:31.826 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:18:31.827 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:31.827 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 1.2331ms
2025-08-12 09:18:31.847 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:18:31.848 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:31.851 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:18:31.855 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:31.859 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:18:31.859 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 11.3771 ms
2025-08-12 09:18:31.860 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 12.0571ms
2025-08-12 09:18:31.860 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], [t].[Title], [t].[Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r0]
    WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [r].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[Title]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [r].[LastActionDate] DESC
2025-08-12 09:18:31.861 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:31.862 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 37.4556ms
2025-08-12 09:18:31.862 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:18:31.862 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 42.4186 ms
2025-08-12 09:18:31.862 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 44.3291ms
2025-08-12 09:18:31.892 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=jdUU8SWF4JaxSCWYNtBzwg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:18:31.892 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:31.892 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:18:32.782 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - null null
2025-08-12 09:18:32.782 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:32.783 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 204 null null 0.8931ms
2025-08-12 09:18:32.788 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:18:32.788 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:32.788 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5374ms
2025-08-12 09:18:32.794 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - application/json null
2025-08-12 09:18:32.796 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:32.797 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:32.804 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:18:32.804 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:32.805 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:18:32.805 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:32.811 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:18:32.841 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:32.843 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:32.862 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 09:18:32.871 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:32.876 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 63.9226ms
2025-08-12 09:18:32.876 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:18:32.876 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 71.3811 ms
2025-08-12 09:18:32.876 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 72.3148ms
2025-08-12 09:18:33.016 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:33.022 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:33.025 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 219.4131ms
2025-08-12 09:18:33.025 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:33.025 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1 responded 200 in 229.1194 ms
2025-08-12 09:18:33.025 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 200 null application/json; charset=utf-8 231.3577ms
2025-08-12 09:18:34.102 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 09:18:34.102 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:34.103 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.5547ms
2025-08-12 09:18:34.106 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 09:18:34.107 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:34.108 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:34.108 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:34.113 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:34.119 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:34.119 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:34.120 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 11.2746ms
2025-08-12 09:18:34.120 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:34.120 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 13.0520 ms
2025-08-12 09:18:34.120 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 14.0986ms
2025-08-12 09:18:35.904 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - null null
2025-08-12 09:18:35.904 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:35.904 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - 204 null null 0.3788ms
2025-08-12 09:18:35.910 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - application/json null
2025-08-12 09:18:35.910 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:35.911 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:35.911 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:35.917 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:35.921 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:35.921 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:35.922 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 10.3743ms
2025-08-12 09:18:35.922 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:35.922 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264 responded 200 in 11.8269 ms
2025-08-12 09:18:35.923 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - 200 null application/json; charset=utf-8 12.8727ms
2025-08-12 09:18:37.130 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - null null
2025-08-12 09:18:37.130 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:37.130 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - 204 null null 0.6612ms
2025-08-12 09:18:37.135 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - application/json null
2025-08-12 09:18:37.136 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:37.136 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:37.136 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:37.144 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:37.154 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:37.155 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:37.156 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 19.5477ms
2025-08-12 09:18:37.156 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:37.156 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d responded 200 in 20.4219 ms
2025-08-12 09:18:37.157 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - 200 null application/json; charset=utf-8 21.232ms
2025-08-12 09:18:39.890 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 09:18:39.890 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:39.890 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.53ms
2025-08-12 09:18:39.894 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 09:18:39.895 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:39.895 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:39.896 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:39.899 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:39.903 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:39.903 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:39.904 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 7.9992ms
2025-08-12 09:18:39.904 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:39.904 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 8.9665 ms
2025-08-12 09:18:39.904 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 9.6096ms
2025-08-12 09:18:40.452 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - application/json null
2025-08-12 09:18:40.452 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:40.453 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:40.453 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:40.456 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:40.460 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:40.460 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:40.461 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 7.4862ms
2025-08-12 09:18:40.461 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:40.461 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264 responded 200 in 8.4955 ms
2025-08-12 09:18:40.461 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - 200 null application/json; charset=utf-8 9.2549ms
2025-08-12 09:18:41.030 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - null null
2025-08-12 09:18:41.030 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:41.031 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 204 null null 0.3838ms
2025-08-12 09:18:41.034 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - application/json null
2025-08-12 09:18:41.034 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:41.035 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:41.035 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:41.037 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:41.040 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:41.041 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:41.041 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 5.8199ms
2025-08-12 09:18:41.041 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:41.041 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1 responded 200 in 6.4400 ms
2025-08-12 09:18:41.041 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 200 null application/json; charset=utf-8 6.9519ms
2025-08-12 09:18:42.168 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - null null
2025-08-12 09:18:42.168 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:42.168 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - 204 null null 0.4524ms
2025-08-12 09:18:42.172 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - application/json null
2025-08-12 09:18:42.172 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:42.173 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:42.173 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:42.176 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:42.180 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:42.180 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:42.181 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 7.7944ms
2025-08-12 09:18:42.181 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:42.181 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264 responded 200 in 8.7798 ms
2025-08-12 09:18:42.181 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/d16ba523-2ede-4797-abe0-426f75f8e264?page=1&pageSize=50 - 200 null application/json; charset=utf-8 9.4541ms
2025-08-12 09:18:44.434 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - application/json null
2025-08-12 09:18:44.434 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:18:44.435 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:44.435 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:18:44.438 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:18:44.443 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:18:44.444 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:18:44.444 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 9.0293ms
2025-08-12 09:18:44.444 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:18:44.444 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1 responded 200 in 9.8702 ms
2025-08-12 09:18:44.444 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 200 null application/json; charset=utf-8 10.6482ms
2025-08-12 09:25:50.844 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 09:25:50.953 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 09:25:50.954 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 09:25:50.956 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 09:25:50.956 +03:00 [INF] Hosting environment: Development
2025-08-12 09:25:50.956 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 09:25:51.496 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:25:51.636 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 142.8969ms
2025-08-12 09:25:51.674 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:25:51.674 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:25:51.679 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 5.464ms
2025-08-12 09:25:51.712 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.8989ms
2025-08-12 09:25:52.407 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:25:52.487 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 80.3979ms
2025-08-12 09:25:52.699 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:25:52.701 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:25:52.702 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 2.7131ms
2025-08-12 09:25:52.710 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:25:52.710 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:25:52.751 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:25:52.754 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:25:52.755 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 41.7812 ms
2025-08-12 09:25:52.755 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 45.0897ms
2025-08-12 09:25:52.760 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=FOH9SoeU-56fDEwnugF4xQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:25:52.760 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:25:52.762 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:26:05.926 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:26:05.927 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 13166.8677 ms
2025-08-12 09:26:05.928 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=FOH9SoeU-56fDEwnugF4xQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 13167.5766ms
2025-08-12 09:26:06.529 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:26:06.530 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:26:06.531 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 1.1755ms
2025-08-12 09:26:06.555 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:26:06.556 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:26:06.556 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.6809ms
2025-08-12 09:26:06.561 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:26:06.563 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:26:06.563 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:26:06.566 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:26:06.569 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:26:06.569 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:26:06.570 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:26:06.570 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 6.6074 ms
2025-08-12 09:26:06.570 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 7.2386ms
2025-08-12 09:26:06.579 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=3xF5ftM8E-JLD56AxAT70g&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:26:06.579 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:26:06.580 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:26:06.599 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:26:08.415 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:26:08.625 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], [t].[Title], [t].[Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r0]
    WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [r].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[Title]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [r].[LastActionDate] DESC
2025-08-12 09:26:08.650 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:26:08.698 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 2094.1707ms
2025-08-12 09:26:08.698 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:26:08.699 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 2132.3587 ms
2025-08-12 09:26:08.712 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 2150.2795ms
2025-08-12 09:27:19.404 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 09:27:19.404 +03:00 [INF] CORS policy execution failed.
2025-08-12 09:27:19.405 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 09:27:19.405 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:27:19.412 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 09:27:19.642 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 09:27:20.069 +03:00 [ERR] Failed executing DbCommand (34ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 09:27:20.098 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Title', table 'AmanahChatDB.dbo.ChatRooms'; column does not allow nulls. INSERT fails.
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_ChatRooms_ChatRoomId". The conflict occurred in database "AmanahChatDB", table "dbo.ChatRooms", column 'Id'.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:5dc6bcbf-6798-4025-bfd7-808bd28ed1b1
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Title', table 'AmanahChatDB.dbo.ChatRooms'; column does not allow nulls. INSERT fails.
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_ChatRooms_ChatRoomId". The conflict occurred in database "AmanahChatDB", table "dbo.ChatRooms", column 'Id'.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:5dc6bcbf-6798-4025-bfd7-808bd28ed1b1
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:27:20.101 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:27:20.102 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 690.4905ms
2025-08-12 09:27:20.103 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:27:20.103 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 697.8652 ms
2025-08-12 09:27:20.103 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 698.9866ms
2025-08-12 09:28:22.730 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 09:28:22.831 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 09:28:22.831 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 09:28:22.833 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 09:28:22.833 +03:00 [INF] Hosting environment: Development
2025-08-12 09:28:22.833 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 09:28:23.016 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:28:23.036 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:28:23.048 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:28:23.051 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 35.9273ms
2025-08-12 09:28:23.060 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:28:23.063 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:28:23.160 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:28:23.167 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:28:23.168 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 89.6520 ms
2025-08-12 09:28:23.169 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 109.3049ms
2025-08-12 09:28:23.181 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=7uuEFTI56vzoZMlKYW3gIA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:28:23.182 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:28:23.186 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:28:23.200 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 163.3358ms
2025-08-12 09:28:23.360 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:28:23.360 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:28:23.364 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 3.5698ms
2025-08-12 09:28:23.382 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 21.8248ms
2025-08-12 09:28:24.049 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:28:24.140 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 90.9557ms
2025-08-12 09:28:31.455 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 09:28:31.457 +03:00 [INF] CORS policy execution failed.
2025-08-12 09:28:31.458 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 09:28:31.461 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:28:31.496 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 09:28:33.114 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 09:28:33.485 +03:00 [ERR] Failed executing DbCommand (17ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 09:28:33.515 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Title', table 'AmanahChatDB.dbo.ChatRooms'; column does not allow nulls. INSERT fails.
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_ChatRooms_ChatRoomId". The conflict occurred in database "AmanahChatDB", table "dbo.ChatRooms", column 'Id'.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7bfcfa6c-0287-4d64-baf8-5b4ad923c40c
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Title', table 'AmanahChatDB.dbo.ChatRooms'; column does not allow nulls. INSERT fails.
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_ChatRooms_ChatRoomId". The conflict occurred in database "AmanahChatDB", table "dbo.ChatRooms", column 'Id'.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7bfcfa6c-0287-4d64-baf8-5b4ad923c40c
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:28:33.527 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:28:33.549 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 2047.916ms
2025-08-12 09:28:33.550 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:28:33.551 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 2092.7280 ms
2025-08-12 09:28:33.559 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 2102.7983ms
2025-08-12 09:29:30.396 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 09:29:30.534 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 09:29:30.534 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 09:29:30.536 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 09:29:30.537 +03:00 [INF] Hosting environment: Development
2025-08-12 09:29:30.537 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 09:29:30.804 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:29:30.931 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 127.3094ms
2025-08-12 09:29:31.006 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:29:31.032 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:29:31.037 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 4.16ms
2025-08-12 09:29:31.037 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.7916ms
2025-08-12 09:29:31.239 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:29:31.360 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 120.6345ms
2025-08-12 09:29:31.702 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:29:31.705 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:29:31.707 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 4.5877ms
2025-08-12 09:29:31.718 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:29:31.718 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:29:31.765 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:29:31.770 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:29:31.773 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 49.9894 ms
2025-08-12 09:29:31.774 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 56.5395ms
2025-08-12 09:29:31.782 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=CcJlMa4VtlowjyVLvWn9jg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:29:31.782 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:29:31.785 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:29:35.993 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-12 09:29:36.032 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-12 09:29:36.034 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-12 09:29:36.035 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-12 09:29:36.047 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-12 09:29:36.057 +03:00 [INF] Applying migration '20250812062928_MakeTitleNullable'.
2025-08-12 09:29:36.160 +03:00 [INF] Executed DbCommand (70ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[ChatRooms]') AND [c].[name] = N'Title');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [ChatRooms] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [ChatRooms] ALTER COLUMN [Title] nvarchar(max) NULL;
2025-08-12 09:29:36.163 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250812062928_MakeTitleNullable', N'8.0.13');
2025-08-12 09:29:37.535 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 09:29:37.642 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 09:29:37.642 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 09:29:37.644 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 09:29:37.644 +03:00 [INF] Hosting environment: Development
2025-08-12 09:29:37.644 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 09:29:37.770 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:29:37.897 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 127.4714ms
2025-08-12 09:29:38.084 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:29:38.084 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:29:38.089 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 4.9107ms
2025-08-12 09:29:38.106 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.212ms
2025-08-12 09:29:38.226 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:29:38.331 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 105.5996ms
2025-08-12 09:29:39.695 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:29:39.698 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:29:39.699 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 4.1822ms
2025-08-12 09:29:39.705 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:29:39.705 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:29:39.753 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:29:39.756 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:29:39.757 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 48.3453 ms
2025-08-12 09:29:39.757 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 52.7101ms
2025-08-12 09:29:39.766 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=VkWhI6rVKo2HzUYvZiEHdQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:29:39.766 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:29:39.769 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:29:47.568 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:29:47.574 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 5.9352ms
2025-08-12 09:29:47.600 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:29:47.607 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:29:47.608 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 1.0677ms
2025-08-12 09:29:47.622 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 21.3463ms
2025-08-12 09:29:47.808 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:29:47.815 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 7.2639ms
2025-08-12 09:30:01.302 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 09:30:01.303 +03:00 [INF] CORS policy execution failed.
2025-08-12 09:30:01.304 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 09:30:01.310 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:30:01.352 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 09:30:02.659 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 09:30:02.956 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 09:30:02.986 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:30:03.002 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 1646.4711ms
2025-08-12 09:30:03.003 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:30:03.004 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 1699.6638 ms
2025-08-12 09:30:03.012 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 1710.8585ms
2025-08-12 09:31:57.656 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 09:31:57.658 +03:00 [INF] CORS policy execution failed.
2025-08-12 09:31:57.658 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 09:31:57.659 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:31:57.659 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 09:31:57.707 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 09:31:57.710 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:31:57.711 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 51.6759ms
2025-08-12 09:31:57.711 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:31:57.711 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 52.5729 ms
2025-08-12 09:31:57.711 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 55.0154ms
2025-08-12 09:32:07.568 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 09:32:07.568 +03:00 [INF] CORS policy execution failed.
2025-08-12 09:32:07.568 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 09:32:07.568 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:32:07.569 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 09:32:07.594 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 09:32:07.595 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:32:07.596 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 27.0093ms
2025-08-12 09:32:07.596 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:32:07.596 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 27.4767 ms
2025-08-12 09:32:07.596 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 28.065ms
2025-08-12 09:32:11.234 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 09:32:11.234 +03:00 [INF] CORS policy execution failed.
2025-08-12 09:32:11.234 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 09:32:11.234 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:32:11.235 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 09:32:11.238 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 09:32:11.238 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:32:11.239 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 4.041ms
2025-08-12 09:32:11.239 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:32:11.239 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 4.4346 ms
2025-08-12 09:32:11.239 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 4.8366ms
2025-08-12 09:32:12.011 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 09:32:12.011 +03:00 [INF] CORS policy execution failed.
2025-08-12 09:32:12.011 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 09:32:12.012 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:32:12.012 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 09:32:12.020 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 09:32:12.021 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:32:12.021 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 9.3555ms
2025-08-12 09:32:12.021 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 09:32:12.021 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 9.8381 ms
2025-08-12 09:32:12.022 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 11.0484ms
2025-08-12 09:32:18.899 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:32:18.899 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 159133.2264 ms
2025-08-12 09:32:18.899 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=VkWhI6rVKo2HzUYvZiEHdQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 159133.7712ms
2025-08-12 09:32:19.254 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:32:19.254 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:32:19.254 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:32:19.254 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:32:19.255 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.9058ms
2025-08-12 09:32:19.255 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.9296ms
2025-08-12 09:32:19.272 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:32:19.272 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:32:19.272 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:32:19.274 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:32:19.274 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:32:19.274 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:32:19.274 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:32:19.274 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 2.3094 ms
2025-08-12 09:32:19.275 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 2.7089ms
2025-08-12 09:32:19.281 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=UoprFbq8omR5kI-hBzsoDQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:32:19.282 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:32:19.282 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:32:19.283 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:32:19.324 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:32:19.513 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], [t].[Title], [t].[Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r0]
    WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [r].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[Title]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [r].[LastActionDate] DESC
2025-08-12 09:32:19.531 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:32:19.544 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 261.0921ms
2025-08-12 09:32:19.544 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:32:19.544 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 270.5263 ms
2025-08-12 09:32:19.545 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 272.8054ms
2025-08-12 09:33:11.366 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 09:33:11.367 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:33:11.367 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.4625ms
2025-08-12 09:33:11.369 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 09:33:11.370 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:33:11.371 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:33:11.380 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:33:11.380 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:33:11.380 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:33:11.380 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2812ms
2025-08-12 09:33:11.384 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:33:11.386 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:33:11.386 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:33:11.395 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:33:11.419 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:33:11.419 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:33:11.440 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 09:33:11.483 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:33:11.486 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 90.182ms
2025-08-12 09:33:11.486 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:33:11.486 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 99.7728 ms
2025-08-12 09:33:11.486 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 101.8025ms
2025-08-12 09:33:11.579 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:33:11.579 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:33:11.582 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 201.9768ms
2025-08-12 09:33:11.582 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:33:11.582 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 211.3971 ms
2025-08-12 09:33:11.582 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 212.7242ms
2025-08-12 09:47:38.266 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 09:47:38.375 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 09:47:38.376 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 09:47:38.378 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 09:47:38.378 +03:00 [INF] Hosting environment: Development
2025-08-12 09:47:38.378 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 09:47:38.598 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:47:38.691 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:47:38.696 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:38.700 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 8.9208ms
2025-08-12 09:47:38.719 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:47:38.721 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:38.748 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 150.9061ms
2025-08-12 09:47:38.791 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:47:38.794 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:47:38.795 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 71.4345 ms
2025-08-12 09:47:38.796 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 77.05ms
2025-08-12 09:47:38.906 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=4W2LPMI0gK0CQQRD-2wawQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:47:38.906 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:47:38.906 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:38.912 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 5.692ms
2025-08-12 09:47:38.916 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:47:38.938 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:47:38.968 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 29.526ms
2025-08-12 09:47:39.515 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:47:39.600 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 84.852ms
2025-08-12 09:47:41.952 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:47:41.952 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 3043.8174 ms
2025-08-12 09:47:41.953 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=4W2LPMI0gK0CQQRD-2wawQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 3046.8729ms
2025-08-12 09:47:42.424 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:47:42.425 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:42.425 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 1.1371ms
2025-08-12 09:47:42.434 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:47:42.435 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:42.435 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.6797ms
2025-08-12 09:47:42.444 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:47:42.447 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:42.450 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:47:42.450 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:42.454 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:47:42.454 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:47:42.455 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:47:42.455 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 4.6665 ms
2025-08-12 09:47:42.455 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 5.5226ms
2025-08-12 09:47:42.463 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=hHqU8xNTfS9QWjK2elTlHQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:47:42.463 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:42.464 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:47:42.476 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:47:43.104 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:47:43.219 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 09:47:43.228 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:47:43.245 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 766.9753ms
2025-08-12 09:47:43.245 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:47:43.246 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 797.8096 ms
2025-08-12 09:47:43.250 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 805.3974ms
2025-08-12 09:47:46.364 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 09:47:46.365 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:46.365 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.5113ms
2025-08-12 09:47:46.368 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 09:47:46.369 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:46.370 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:47:46.372 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:47:46.373 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:46.373 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.6517ms
2025-08-12 09:47:46.377 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:47:46.378 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:47:46.379 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:46.380 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:47:46.388 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:47:46.504 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:47:46.507 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:47:46.553 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 09:47:46.637 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:47:46.638 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:47:46.641 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 262.8837ms
2025-08-12 09:47:46.642 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:47:46.642 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 272.0178 ms
2025-08-12 09:47:46.642 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 273.5721ms
2025-08-12 09:47:46.651 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:47:46.653 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 265.6255ms
2025-08-12 09:47:46.653 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:47:46.653 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 274.1875 ms
2025-08-12 09:47:46.654 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 276.5173ms
2025-08-12 09:47:50.189 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - null null
2025-08-12 09:47:50.190 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:50.190 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 204 null null 0.568ms
2025-08-12 09:47:50.194 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - application/json null
2025-08-12 09:47:50.194 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:50.195 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:47:50.195 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:47:50.221 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:47:50.228 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:47:50.232 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:47:50.234 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 39.4048ms
2025-08-12 09:47:50.235 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:47:50.235 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1 responded 200 in 40.1641 ms
2025-08-12 09:47:50.235 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 200 null application/json; charset=utf-8 40.6374ms
2025-08-12 09:47:51.646 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 09:47:51.646 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:51.646 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.5266ms
2025-08-12 09:47:51.649 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 09:47:51.649 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:47:51.650 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:47:51.650 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:47:51.660 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:47:51.665 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:47:51.665 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:47:51.666 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 15.7171ms
2025-08-12 09:47:51.666 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:47:51.666 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 16.6560 ms
2025-08-12 09:47:51.666 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 17.2675ms
2025-08-12 09:48:03.376 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 09:48:03.376 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.376 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 0.4649ms
2025-08-12 09:48:03.379 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 41
2025-08-12 09:48:03.380 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.381 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 09:48:03.393 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:48:03.440 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 09:48:03.455 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 09:48:03.458 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 65.0241ms
2025-08-12 09:48:03.458 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 09:48:03.458 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 78.2733 ms
2025-08-12 09:48:03.458 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 78.9262ms
2025-08-12 09:48:03.495 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 09:48:03.495 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 09:48:03.496 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.496 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.496 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 09:48:03.496 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.4658ms
2025-08-12 09:48:03.496 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.4646ms
2025-08-12 09:48:03.496 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.496 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.3339ms
2025-08-12 09:48:03.500 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 09:48:03.500 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 09:48:03.500 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 09:48:03.500 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.500 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.500 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:03.501 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 09:48:03.501 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:48:03.501 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:48:03.501 +03:00 [INF] HTTP GET /api/Users responded 404 in 0.9076 ms
2025-08-12 09:48:03.502 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 2.2133ms
2025-08-12 09:48:03.503 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 09:48:03.506 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:48:03.508 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 09:48:03.523 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 09:48:03.527 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 09:48:03.531 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:03.535 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 33.5494ms
2025-08-12 09:48:03.535 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:48:03.535 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 34.6773 ms
2025-08-12 09:48:03.535 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 499 null application/json; charset=utf-8 35.1973ms
2025-08-12 09:48:03.553 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:03.556 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 48.5573ms
2025-08-12 09:48:03.557 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 09:48:03.557 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 56.4247 ms
2025-08-12 09:48:03.557 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 499 null application/json; charset=utf-8 57.1496ms
2025-08-12 09:48:04.851 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 09:48:04.852 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:04.852 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:48:04.853 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:04.853 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:48:04.853 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:48:04.853 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.9344ms
2025-08-12 09:48:04.857 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:48:04.860 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 09:48:04.861 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:04.861 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 8.0192ms
2025-08-12 09:48:04.862 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:48:04.862 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 9.5282 ms
2025-08-12 09:48:04.862 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 10.9618ms
2025-08-12 09:48:04.864 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:48:04.864 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:04.865 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:48:04.865 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:48:04.865 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.5860 ms
2025-08-12 09:48:04.865 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.8873ms
2025-08-12 09:48:04.891 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=7TPlR6k7Tfwp9BexJyyTVA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - null null
2025-08-12 09:48:04.891 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:04.892 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:48:10.143 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 09:48:10.144 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:10.145 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 2.1351ms
2025-08-12 09:48:10.149 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 09:48:10.149 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:10.150 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:48:10.150 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:48:10.152 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:48:10.152 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:10.153 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5ms
2025-08-12 09:48:10.154 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:48:10.157 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:48:10.157 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:10.158 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:48:10.158 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:48:10.159 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:48:10.159 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:10.159 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 9.09ms
2025-08-12 09:48:10.160 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:48:10.160 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 10.2546 ms
2025-08-12 09:48:10.160 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 11.0429ms
2025-08-12 09:48:10.164 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:48:10.166 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 09:48:10.168 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:10.168 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 10.1121ms
2025-08-12 09:48:10.168 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:48:10.168 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 11.2124 ms
2025-08-12 09:48:10.169 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 11.9602ms
2025-08-12 09:48:19.465 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 09:48:19.465 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:19.465 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.5202ms
2025-08-12 09:48:19.469 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 131
2025-08-12 09:48:19.469 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:19.470 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:19.473 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:48:19.512 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 09:48:19.607 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 09:48:19.878 +03:00 [ERR] Failed executing DbCommand (23ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 09:48:19.898 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:db2ccb89-895f-422d-b52b-f02fb38d230a
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:db2ccb89-895f-422d-b52b-f02fb38d230a
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:48:19.899 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:19.901 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 427.55ms
2025-08-12 09:48:19.901 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:19.901 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 431.6616 ms
2025-08-12 09:48:19.901 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 432.4788ms
2025-08-12 09:48:22.825 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 131
2025-08-12 09:48:22.826 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:22.826 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:22.827 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:48:22.840 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 09:48:22.853 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 09:48:22.862 +03:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 09:48:22.866 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:db2ccb89-895f-422d-b52b-f02fb38d230a
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:db2ccb89-895f-422d-b52b-f02fb38d230a
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:48:22.867 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:22.868 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 41.0655ms
2025-08-12 09:48:22.868 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:22.868 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 42.1600 ms
2025-08-12 09:48:22.868 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 42.8072ms
2025-08-12 09:48:32.304 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 09:48:32.304 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:32.304 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.4927ms
2025-08-12 09:48:32.308 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 131
2025-08-12 09:48:32.308 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:32.309 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:32.309 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:48:32.319 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 09:48:32.324 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 09:48:32.335 +03:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 09:48:32.339 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:19fa7119-d476-41de-b8db-4c1c352a4039
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:19fa7119-d476-41de-b8db-4c1c352a4039
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:48:32.340 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:32.340 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 30.6884ms
2025-08-12 09:48:32.340 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:32.340 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 31.8491 ms
2025-08-12 09:48:32.341 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 32.6022ms
2025-08-12 09:48:53.590 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - null null
2025-08-12 09:48:53.590 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:53.590 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 204 null null 0.4071ms
2025-08-12 09:48:53.594 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - application/json null
2025-08-12 09:48:53.594 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:53.595 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:48:53.595 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:48:53.605 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:48:53.674 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:48:53.674 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:53.675 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 79.2404ms
2025-08-12 09:48:53.675 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:48:53.675 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1 responded 200 in 80.2386 ms
2025-08-12 09:48:53.675 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 200 null application/json; charset=utf-8 80.8388ms
2025-08-12 09:48:58.980 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 09:48:58.981 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:58.981 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.4887ms
2025-08-12 09:48:58.984 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 131
2025-08-12 09:48:58.984 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:48:58.985 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:58.985 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:48:58.989 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 09:48:58.997 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 09:48:59.010 +03:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 09:48:59.014 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:19fa7119-d476-41de-b8db-4c1c352a4039
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:19fa7119-d476-41de-b8db-4c1c352a4039
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:48:59.017 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:48:59.017 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 32.1152ms
2025-08-12 09:48:59.018 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:48:59.018 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 33.5405 ms
2025-08-12 09:48:59.019 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 34.4104ms
2025-08-12 09:49:32.022 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 09:49:32.022 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:32.022 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.3745ms
2025-08-12 09:49:32.022 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 09:49:32.022 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:32.022 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.3124ms
2025-08-12 09:49:32.023 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 09:49:32.023 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:32.023 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.3995ms
2025-08-12 09:49:32.029 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 09:49:32.029 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 09:49:32.029 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:32.029 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:32.031 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 09:49:32.031 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 09:49:32.031 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:32.032 +03:00 [INF] HTTP GET /api/Users responded 404 in 1.9842 ms
2025-08-12 09:49:32.032 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 3.1086ms
2025-08-12 09:49:32.032 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 09:49:32.032 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 09:49:32.033 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:49:32.033 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:49:32.041 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 09:49:32.042 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:49:32.043 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 10.5775ms
2025-08-12 09:49:32.043 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 09:49:32.043 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 13.4072 ms
2025-08-12 09:49:32.043 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 14.7227ms
2025-08-12 09:49:32.045 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:49:32.085 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:49:32.086 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 52.659ms
2025-08-12 09:49:32.086 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:49:32.086 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 54.0241 ms
2025-08-12 09:49:32.086 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 499 null application/json; charset=utf-8 54.9526ms
2025-08-12 09:49:34.753 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 09:49:34.753 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:34.754 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:49:34.754 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:49:34.758 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 09:49:34.759 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:34.759 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5179ms
2025-08-12 09:49:34.760 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:49:34.763 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:49:34.763 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:34.764 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:49:34.764 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:49:34.772 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:49:34.779 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 09:49:34.779 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:49:34.780 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 15.9567ms
2025-08-12 09:49:34.780 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:49:34.780 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 16.7579 ms
2025-08-12 09:49:34.781 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 17.4966ms
2025-08-12 09:49:34.801 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 09:49:34.801 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:49:34.802 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 47.0975ms
2025-08-12 09:49:34.802 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:49:34.802 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 48.2718 ms
2025-08-12 09:49:34.802 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 48.9946ms
2025-08-12 09:49:37.703 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 09:49:37.703 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:37.704 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.3461ms
2025-08-12 09:49:37.707 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 09:49:37.708 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:37.709 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:49:37.709 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 09:49:37.722 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:49:37.727 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 09:49:37.728 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:49:37.728 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 18.4189ms
2025-08-12 09:49:37.728 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 09:49:37.728 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 19.9131 ms
2025-08-12 09:49:37.728 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 20.7096ms
2025-08-12 09:49:39.414 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 09:49:39.414 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:39.414 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.4034ms
2025-08-12 09:49:39.417 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 09:49:39.417 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:39.418 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:49:39.418 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:49:39.423 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 09:49:39.423 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:49:39.424 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:49:39.424 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 09:49:39.425 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:49:39.428 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 09:49:39.430 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 09:49:39.431 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:49:39.432 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 7.5795ms
2025-08-12 09:49:39.432 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 09:49:39.432 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 8.4309 ms
2025-08-12 09:49:39.432 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 9.2103ms
2025-08-12 09:49:39.496 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 09:49:39.496 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:49:39.496 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 78.1588ms
2025-08-12 09:49:39.496 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 09:49:39.496 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 78.9670 ms
2025-08-12 09:49:39.496 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 79.4383ms
2025-08-12 09:51:07.381 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 09:51:07.381 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:51:07.381 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3224ms
2025-08-12 09:51:07.383 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 09:51:07.384 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:51:07.384 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:51:07.384 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:51:07.404 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 09:51:07.416 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 09:51:07.421 +03:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 09:51:07.423 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1da08081-c189-4357-a1d5-4ec0ebe68c65
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1da08081-c189-4357-a1d5-4ec0ebe68c65
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:51:07.424 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:51:07.424 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 39.8471ms
2025-08-12 09:51:07.424 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:51:07.424 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 40.6922 ms
2025-08-12 09:51:07.425 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 41.1673ms
2025-08-12 09:52:02.111 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 09:52:02.436 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 09:52:02.437 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 09:52:02.439 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 09:52:02.439 +03:00 [INF] Hosting environment: Development
2025-08-12 09:52:02.440 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 09:52:02.677 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:52:02.677 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:52:02.736 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:02.736 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:02.741 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 72.1892ms
2025-08-12 09:52:02.741 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 71.4086ms
2025-08-12 09:52:02.762 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:52:02.766 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:52:02.768 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:02.768 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:02.979 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:52:02.979 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:52:02.987 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:52:02.987 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:52:02.988 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 206.7949 ms
2025-08-12 09:52:02.988 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 206.8493 ms
2025-08-12 09:52:02.989 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 223.6368ms
2025-08-12 09:52:02.989 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 228.0927ms
2025-08-12 09:52:03.181 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 09:52:03.243 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=mpchBb_y4l4TF75-_dqQmw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:52:03.243 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:03.244 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=ZO-y7CC6sTnThtqehgjiGg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - null null
2025-08-12 09:52:03.244 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:03.257 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:52:03.257 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:52:03.543 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 363.8994ms
2025-08-12 09:52:03.591 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 09:52:03.603 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 11.9098ms
2025-08-12 09:52:03.622 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 09:52:03.701 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 82.9485ms
2025-08-12 09:52:03.897 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 09:52:04.020 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 123.8368ms
2025-08-12 09:52:08.838 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 09:52:08.840 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:08.841 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 4.9618ms
2025-08-12 09:52:08.849 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 09:52:08.855 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:08.858 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:52:08.906 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:52:14.741 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 09:52:33.721 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:52:33.721 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:52:33.723 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:33.723 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:33.724 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 2.8998ms
2025-08-12 09:52:33.724 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 3.0887ms
2025-08-12 09:52:33.742 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:52:33.742 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:52:33.744 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:33.744 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:33.745 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:52:33.749 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:52:33.749 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:52:33.749 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 5.1580 ms
2025-08-12 09:52:33.750 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 7.7779ms
2025-08-12 09:52:33.750 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:52:33.750 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.3955 ms
2025-08-12 09:52:33.750 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 8.3654ms
2025-08-12 09:52:33.765 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=uTSBmtD81OpWyuRz8uh1GQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:52:33.766 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:33.769 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:52:33.774 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=ITEHGZQPdCflCdveJiu8zg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - null null
2025-08-12 09:52:33.775 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:52:33.782 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:52:33.797 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:52:33.797 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:52:33.805 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 30557.5718 ms
2025-08-12 09:52:33.805 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 30557.6476 ms
2025-08-12 09:52:33.805 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=ZO-y7CC6sTnThtqehgjiGg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - 200 null null 30562.2204ms
2025-08-12 09:52:33.806 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=mpchBb_y4l4TF75-_dqQmw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 30563.1198ms
2025-08-12 09:52:33.814 +03:00 [INF] Connection id "0HNEPDIV11PRU", Request id "0HNEPDIV11PRU:00000003": the application completed without reading the entire request body.
2025-08-12 09:52:33.814 +03:00 [INF] Connection id "0HNEPDIV11PRT", Request id "0HNEPDIV11PRT:00000003": the application completed without reading the entire request body.
2025-08-12 09:52:33.877 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 09:53:31.865 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:53:31.866 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:31.866 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.6039ms
2025-08-12 09:53:31.866 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:53:31.866 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:31.867 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 1.3363ms
2025-08-12 09:53:31.881 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:53:31.882 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 58114.3298 ms
2025-08-12 09:53:31.882 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:53:31.882 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=uTSBmtD81OpWyuRz8uh1GQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 58117.3624ms
2025-08-12 09:53:31.882 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 58105.0900 ms
2025-08-12 09:53:31.883 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=ITEHGZQPdCflCdveJiu8zg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - 200 null null 58109.7157ms
2025-08-12 09:53:31.883 +03:00 [INF] Connection id "0HNEPDIV11PRU", Request id "0HNEPDIV11PRU:00000007": the application completed without reading the entire request body.
2025-08-12 09:53:31.893 +03:00 [INF] Connection id "0HNEPDIV11PRT", Request id "0HNEPDIV11PRT:00000007": the application completed without reading the entire request body.
2025-08-12 09:53:31.903 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:53:31.903 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 09:53:31.903 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:53:31.905 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:31.905 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:31.905 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:31.906 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 1.7926ms
2025-08-12 09:53:31.907 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 3.5311ms
2025-08-12 09:53:31.908 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:53:31.909 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 09:53:36.231 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:53:36.232 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:36.232 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:53:36.232 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:53:36.232 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.7905 ms
2025-08-12 09:53:36.233 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.5286ms
2025-08-12 09:53:36.247 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:53:36.248 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:36.248 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:53:36.249 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:53:36.249 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.9478 ms
2025-08-12 09:53:36.249 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 2.6454ms
2025-08-12 09:53:36.251 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=gxGe3iOZ50Q6V5r2ilP7dg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:53:36.251 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:36.252 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:53:36.272 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=0xud84u88Nroyyt4MxsLWw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - null null
2025-08-12 09:53:36.273 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:53:36.274 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:53:53.178 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 09:53:56.312 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 09:54:05.569 +03:00 [ERR] An error occurred using the connection to database 'AmanahChatDB' on server 'YZN\SQLEXPRESS'.
2025-08-12 09:54:32.682 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:54:32.682 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 09:54:32.682 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:54:32.682 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:54:32.682 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.5015ms
2025-08-12 09:54:32.682 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3992ms
2025-08-12 09:54:32.692 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:54:32.692 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 56440.8731 ms
2025-08-12 09:54:32.694 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=gxGe3iOZ50Q6V5r2ilP7dg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 56443.6294ms
2025-08-12 09:54:32.694 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 09:54:32.694 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 56420.8103 ms
2025-08-12 09:54:32.694 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=0xud84u88Nroyyt4MxsLWw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - 200 null null 56422.0848ms
2025-08-12 09:54:32.694 +03:00 [INF] Connection id "0HNEPDIV11PS4", Request id "0HNEPDIV11PS4:00000003": the application completed without reading the entire request body.
2025-08-12 09:54:32.694 +03:00 [INF] Connection id "0HNEPDIV11PS3", Request id "0HNEPDIV11PS3:00000003": the application completed without reading the entire request body.
2025-08-12 09:54:32.705 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:54:32.705 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 09:54:32.705 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:54:32.705 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:54:32.707 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:54:32.707 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 09:54:32.707 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:54:32.707 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 09:54:32.707 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.7526 ms
2025-08-12 09:54:32.707 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.2100 ms
2025-08-12 09:54:32.707 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 2.4402ms
2025-08-12 09:54:32.707 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 3.1877ms
2025-08-12 09:54:32.715 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=n2gMkzvRK6fcbYcCsxDtUw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 09:54:32.715 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:54:32.716 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:54:32.719 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=sy5tveqtKPaUFLa-kaUGuQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - null null
2025-08-12 09:54:32.721 +03:00 [INF] CORS policy execution successful.
2025-08-12 09:54:32.722 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 09:54:32.747 +03:00 [ERR] Failed executing DbCommand (51ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 09:54:32.753 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:54:32.787 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 143878.5119ms
2025-08-12 09:54:32.787 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:54:32.787 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 143932.0182 ms
2025-08-12 09:54:32.792 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 499 null application/json; charset=utf-8 143945.4627ms
2025-08-12 09:54:32.794 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:5c53623a-54eb-452a-a250-ba2c6f5405ae
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:5c53623a-54eb-452a-a250-ba2c6f5405ae
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 09:54:54.869 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 09:54:54.870 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 82961.2495ms
2025-08-12 09:54:54.870 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 09:54:54.870 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 82965.2331 ms
2025-08-12 09:54:54.870 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 82968.009ms
2025-08-12 10:00:34.130 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:00:34.130 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:00:34.131 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 1.9143ms
2025-08-12 10:00:34.135 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 10:00:34.136 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:00:34.136 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:00:34.137 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:00:36.947 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:00:36.959 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:00:36.974 +03:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 10:00:36.982 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1dfd0968-6d5d-415d-961f-757e5364e92b
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1dfd0968-6d5d-415d-961f-757e5364e92b
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:00:37.018 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:00:37.018 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 2881.4576ms
2025-08-12 10:00:37.018 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:00:37.018 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 2882.5601 ms
2025-08-12 10:00:37.019 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 2883.5025ms
2025-08-12 10:00:37.987 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 10:00:38.048 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 61.894ms
2025-08-12 10:00:38.132 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 10:00:38.134 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 1.9724ms
2025-08-12 10:00:38.152 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 10:00:38.188 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.2685ms
2025-08-12 10:00:38.768 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 10:00:38.800 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 32.4313ms
2025-08-12 10:05:23.998 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 10:05:24.097 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 10:05:24.097 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 10:05:24.099 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 10:05:24.099 +03:00 [INF] Hosting environment: Development
2025-08-12 10:05:24.099 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 10:05:24.603 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 10:05:24.778 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 180.5873ms
2025-08-12 10:05:24.813 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 10:05:24.813 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 10:05:24.821 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 7.4465ms
2025-08-12 10:05:24.859 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 45.9632ms
2025-08-12 10:05:25.310 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 10:05:25.437 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 126.7998ms
2025-08-12 10:05:37.255 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:05:37.257 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:05:37.261 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:05:37.261 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:05:37.264 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 8.5908ms
2025-08-12 10:05:37.264 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 6.9665ms
2025-08-12 10:05:37.273 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:05:37.277 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:05:37.278 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:05:37.278 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:05:37.418 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:05:37.418 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:05:37.425 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:05:37.428 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 144.7426 ms
2025-08-12 10:05:37.429 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 151.1988ms
2025-08-12 10:05:37.435 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=wRY-m1jFUonCCGlpckbixA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 10:05:37.435 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:05:37.442 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:05:37.454 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:05:39.081 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:05:39.314 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:05:39.326 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:05:39.368 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 1907.8885ms
2025-08-12 10:05:39.369 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:05:39.371 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 2090.1678 ms
2025-08-12 10:05:39.387 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 2113.7371ms
2025-08-12 10:06:28.494 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 10:06:28.494 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:28.494 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.9346ms
2025-08-12 10:06:28.500 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 10:06:28.503 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:28.504 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:06:28.510 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:06:28.511 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:28.511 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.7589ms
2025-08-12 10:06:28.518 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:06:28.523 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:28.525 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:06:28.525 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:06:28.536 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:06:28.677 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:06:28.677 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:06:28.760 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:06:28.857 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:06:28.858 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:06:28.865 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 339.8059ms
2025-08-12 10:06:28.865 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:06:28.865 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 361.7410 ms
2025-08-12 10:06:28.866 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 365.3013ms
2025-08-12 10:06:28.887 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:06:28.893 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 356.5506ms
2025-08-12 10:06:28.893 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:06:28.893 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 369.1466 ms
2025-08-12 10:06:28.893 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 374.9673ms
2025-08-12 10:06:30.481 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - null null
2025-08-12 10:06:30.481 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:30.482 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 204 null null 0.8329ms
2025-08-12 10:06:30.488 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - application/json null
2025-08-12 10:06:30.489 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:30.490 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:06:30.491 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:06:30.543 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:06:30.553 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:06:30.560 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:06:30.563 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 71.7043ms
2025-08-12 10:06:30.563 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:06:30.563 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1 responded 200 in 73.6347 ms
2025-08-12 10:06:30.563 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/333d0852-2d03-4bce-8025-f4ade5dc45e1?page=1&pageSize=50 - 200 null application/json; charset=utf-8 74.7445ms
2025-08-12 10:06:33.393 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:06:33.393 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:33.393 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.457ms
2025-08-12 10:06:33.397 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 122
2025-08-12 10:06:33.397 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:06:33.399 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:06:33.415 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:06:33.484 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:06:33.533 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:06:33.766 +03:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 10:06:33.784 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:836192ba-6e98-4c6a-8b8a-b806fd7210b0
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:836192ba-6e98-4c6a-8b8a-b806fd7210b0
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:06:33.785 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:06:33.786 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 370.9762ms
2025-08-12 10:06:33.787 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:06:33.787 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 389.4715 ms
2025-08-12 10:06:33.787 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 390.1543ms
2025-08-12 10:07:38.382 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 10:07:38.478 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 10:07:38.478 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 10:07:38.480 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 10:07:38.481 +03:00 [INF] Hosting environment: Development
2025-08-12 10:07:38.481 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 10:07:38.536 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:07:38.550 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:07:38.552 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 17.0668ms
2025-08-12 10:07:38.561 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:07:38.563 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:07:38.607 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:07:38.609 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:07:38.610 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 40.4134 ms
2025-08-12 10:07:38.611 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 49.7471ms
2025-08-12 10:07:38.624 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=ouJ2oWdA-E0ciNDIZqb61A&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 10:07:38.625 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:07:38.627 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:07:38.888 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 10:07:38.997 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 109.2907ms
2025-08-12 10:07:39.097 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 10:07:39.122 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.3627ms
2025-08-12 10:07:39.123 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 10:07:39.126 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 3.5073ms
2025-08-12 10:07:39.952 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 10:07:40.022 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 69.754ms
2025-08-12 10:07:44.017 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:07:44.018 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:07:44.019 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 1.6233ms
2025-08-12 10:07:44.026 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 10:07:44.031 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:07:44.041 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:07:44.064 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:07:44.828 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:07:44.950 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:07:45.079 +03:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 10:07:45.092 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7b379c2f-87e6-4370-b04d-0075e93106a1
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7b379c2f-87e6-4370-b04d-0075e93106a1
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:07:45.101 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:07:45.123 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 1054.2998ms
2025-08-12 10:07:45.124 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:07:45.125 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 1093.4774 ms
2025-08-12 10:07:45.136 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 1110.5476ms
2025-08-12 10:10:25.387 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 10:10:25.642 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 10:10:25.642 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 10:10:25.644 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 10:10:25.644 +03:00 [INF] Hosting environment: Development
2025-08-12 10:10:25.644 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 10:10:25.840 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:10:25.885 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:25.890 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 56.3167ms
2025-08-12 10:10:25.906 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:10:25.910 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:26.090 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:10:26.093 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:10:26.095 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 159.7828 ms
2025-08-12 10:10:26.096 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 190.0157ms
2025-08-12 10:10:26.108 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=Xz6DAzwBulc2yBeIgGIv5g&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 10:10:26.109 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:26.127 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:10:26.333 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 10:10:26.563 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 230.3218ms
2025-08-12 10:10:26.592 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 10:10:26.594 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 10:10:26.602 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 9.9739ms
2025-08-12 10:10:26.659 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 65.8431ms
2025-08-12 10:10:26.948 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 10:10:27.042 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 94.5122ms
2025-08-12 10:10:40.151 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:10:40.152 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:40.153 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 2.7966ms
2025-08-12 10:10:40.157 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 10:10:40.160 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:40.167 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:10:40.202 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:10:42.891 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:10:43.103 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:10:43.408 +03:00 [ERR] Failed executing DbCommand (20ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 10:10:43.470 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:a38ca559-d880-4729-8ece-4f10407d5127
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:a38ca559-d880-4729-8ece-4f10407d5127
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:10:43.572 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:10:43.590 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 3381.1593ms
2025-08-12 10:10:43.591 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:10:43.592 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 3431.1067 ms
2025-08-12 10:10:43.606 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 3449.5652ms
2025-08-12 10:10:57.162 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:10:57.162 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 10:10:57.163 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:57.163 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:57.164 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 3.3123ms
2025-08-12 10:10:57.164 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 3.2673ms
2025-08-12 10:10:57.170 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 10:10:57.175 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:57.178 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:10:57.178 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:10:57.179 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:57.201 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:10:57.202 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:10:57.202 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 21.4736 ms
2025-08-12 10:10:57.202 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 25.0942ms
2025-08-12 10:10:57.207 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:10:57.217 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=wKjsRFoVdBQc-BjHe_O2dg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - null null
2025-08-12 10:10:57.217 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:10:57.218 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:10:57.343 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:10:57.510 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:10:57.515 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:10:57.527 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 319.6823ms
2025-08-12 10:10:57.527 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:10:57.528 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 351.8157 ms
2025-08-12 10:10:57.528 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 358.615ms
2025-08-12 10:11:08.860 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:11:08.860 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 11642.5811 ms
2025-08-12 10:11:08.860 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=wKjsRFoVdBQc-BjHe_O2dg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODQ4ODMsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.7y1t9Qo2s26QO7S1kijaAG92gIsY4Mp02rGzwiMLX1E - 200 null null 11644.2804ms
2025-08-12 10:11:21.386 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 10:11:21.386 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:11:21.386 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.5275ms
2025-08-12 10:11:21.393 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 10:11:21.394 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:11:21.394 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:11:21.399 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:11:21.438 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:11:21.521 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:11:21.522 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:11:21.523 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 124.34ms
2025-08-12 10:11:21.523 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:11:21.523 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 129.4565 ms
2025-08-12 10:11:21.523 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 130.3132ms
2025-08-12 10:11:22.334 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 10:11:22.335 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:11:22.335 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 1.0132ms
2025-08-12 10:11:22.340 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 10:11:22.340 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:11:22.341 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:11:22.342 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:11:22.355 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:11:22.366 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:11:22.367 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:11:22.367 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 25.3178ms
2025-08-12 10:11:22.367 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:11:22.367 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 26.9038 ms
2025-08-12 10:11:22.368 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 28.5722ms
2025-08-12 10:11:23.923 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:11:23.923 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:11:23.923 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 1.8552ms
2025-08-12 10:11:23.927 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 10:11:23.927 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:11:23.928 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:11:23.928 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:11:27.677 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:11:31.485 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:12:07.182 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:12:07.183 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:12:07.183 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 499 null null 0.7394ms
2025-08-12 10:12:07.198 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:12:07.198 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 10:12:07.198 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:12:07.199 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:12:07.200 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 2.4021ms
2025-08-12 10:12:07.201 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:12:07.202 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:12:45.027 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:12:45.029 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:12:45.032 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:12:45.034 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:12:45.034 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 4.5822 ms
2025-08-12 10:12:45.039 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 12.0766ms
2025-08-12 10:12:45.055 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=OYf905KRN28hg-zlN2MlXA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 10:12:45.055 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:12:45.057 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:12:46.208 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:12:46.208 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 140097.7131 ms
2025-08-12 10:12:46.211 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=Xz6DAzwBulc2yBeIgGIv5g&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 140102.2207ms
2025-08-12 10:12:46.218 +03:00 [INF] Connection id "0HNEPDT7Q8M3V", Request id "0HNEPDT7Q8M3V:00000003": the application completed without reading the entire request body.
2025-08-12 10:12:46.225 +03:00 [ERR] An error occurred using the connection to database 'AmanahChatDB' on server 'YZN\SQLEXPRESS'.
2025-08-12 10:12:46.241 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:13:25.719 +03:00 [INF] Executed DbCommand (19,350ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:14:01.496 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:14:15.771 +03:00 [ERR] Failed executing DbCommand (3,574ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p19='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (DbType = DateTimeOffset), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p21='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p23='?' (DbType = Guid), @p22='?' (DbType = DateTimeOffset), @p25='?' (DbType = Guid), @p24='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [ChatRoomId], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [ChatRooms] SET [ActionBy] = @p10, [Description] = @p11, [IsDeleted] = @p12, [LastActionDate] = @p13, [Metadata] = @p14, [Title] = @p15, [Type] = @p16, [UniqueDirectKey] = @p17, [WorkspaceId] = @p18
OUTPUT 1
WHERE [Id] = @p19;
UPDATE [RoomMembers] SET [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [LastActionDate] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [LastActionDate] = @p24
OUTPUT 1
WHERE [Id] = @p25;
2025-08-12 10:14:15.782 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:11aaf565-f012-435f-8ec3-1cedca0bf639
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ChatRoomId'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:11aaf565-f012-435f-8ec3-1cedca0bf639
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:14:15.872 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 171943.6827ms
2025-08-12 10:14:15.873 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:14:15.873 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 171945.1840 ms
2025-08-12 10:14:25.901 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:14:25.902 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 138700.6093ms
2025-08-12 10:14:25.903 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:14:25.903 +03:00 [INF] HTTP POST /api/Messages/Send responded 400 in 138703.1246 ms
2025-08-12 10:14:25.903 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 400 null application/json; charset=utf-8 138705.9425ms
2025-08-12 10:14:49.751 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 499 null application/json; charset=utf-8 205824.0873ms
2025-08-12 10:14:50.820 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 10:14:50.908 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 93.1646ms
2025-08-12 10:14:50.963 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 10:14:50.968 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 10:14:50.973 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 3.8299ms
2025-08-12 10:14:51.046 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 95.8621ms
2025-08-12 10:14:51.840 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 10:14:51.858 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 17.7108ms
2025-08-12 10:15:01.890 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 10:15:01.990 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 10:15:01.990 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 10:15:01.992 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 10:15:01.993 +03:00 [INF] Hosting environment: Development
2025-08-12 10:15:01.993 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 10:15:02.088 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:15:02.105 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:02.107 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 19.8785ms
2025-08-12 10:15:02.115 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:15:02.118 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:02.181 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:15:02.184 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:15:02.186 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 59.3497 ms
2025-08-12 10:15:02.187 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 71.6997ms
2025-08-12 10:15:02.200 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=fTnlzuLp-WPV3tOjpVKJcw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 10:15:02.200 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:02.205 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:15:02.301 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 10:15:02.452 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 150.8559ms
2025-08-12 10:15:02.488 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 10:15:02.488 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 10:15:02.492 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 4.3821ms
2025-08-12 10:15:02.525 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 36.8179ms
2025-08-12 10:15:03.098 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 10:15:03.194 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 95.9554ms
2025-08-12 10:15:06.165 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:15:06.165 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:06.166 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.9867ms
2025-08-12 10:15:06.169 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 10:15:06.171 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:06.177 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:06.202 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:15:07.022 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:15:07.136 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:15:07.284 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 10:15:07.302 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:07.313 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 1107.26ms
2025-08-12 10:15:07.314 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:07.315 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 1142.9972 ms
2025-08-12 10:15:07.321 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 1152.0022ms
2025-08-12 10:15:15.128 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:15:15.128 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 12926.3300 ms
2025-08-12 10:15:15.128 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=fTnlzuLp-WPV3tOjpVKJcw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 12928.6157ms
2025-08-12 10:15:15.505 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:15:15.506 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:15.506 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.8316ms
2025-08-12 10:15:15.512 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:15:15.512 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:15.513 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.7006ms
2025-08-12 10:15:15.518 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:15:15.521 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:15.523 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:15:15.526 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:15:15.526 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:15.527 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:15:15.528 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:15:15.528 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.8693 ms
2025-08-12 10:15:15.528 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 2.6058ms
2025-08-12 10:15:15.533 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:15:15.535 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=gW5hakMzG0jnFkf_NZXhtg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - null null
2025-08-12 10:15:15.535 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:15.536 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:15:15.622 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:15:15.740 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:15:15.744 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:15.753 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 220.1596ms
2025-08-12 10:15:15.754 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:15:15.754 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 232.6181 ms
2025-08-12 10:15:15.755 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 237.2504ms
2025-08-12 10:15:17.850 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 10:15:17.850 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:17.850 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.4072ms
2025-08-12 10:15:17.853 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 10:15:17.854 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:17.854 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:15:17.858 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:15:17.861 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:15:17.861 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:17.862 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3971ms
2025-08-12 10:15:17.865 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:15:17.868 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:17.869 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:15:17.875 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:15:17.891 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:15:17.891 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:15:17.900 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:15:17.910 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:17.912 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 37.2932ms
2025-08-12 10:15:17.912 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:15:17.912 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 43.8058 ms
2025-08-12 10:15:17.912 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 47.5354ms
2025-08-12 10:15:17.962 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:15:17.963 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:17.965 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 107.0895ms
2025-08-12 10:15:17.965 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:15:17.965 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 111.2599 ms
2025-08-12 10:15:17.965 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 111.8799ms
2025-08-12 10:15:20.236 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:15:20.236 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:20.237 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.5408ms
2025-08-12 10:15:20.243 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 128
2025-08-12 10:15:20.243 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:20.244 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:20.244 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:15:20.257 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:15:20.260 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:15:20.268 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 10:15:20.278 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:20.278 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 33.9954ms
2025-08-12 10:15:20.278 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:20.278 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 35.0676 ms
2025-08-12 10:15:20.279 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 35.8171ms
2025-08-12 10:15:25.410 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:15:25.410 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:25.410 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.6491ms
2025-08-12 10:15:25.416 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 158
2025-08-12 10:15:25.416 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:25.417 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:25.417 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:15:25.424 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:15:25.427 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:15:25.434 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 10:15:25.437 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:25.437 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 19.733ms
2025-08-12 10:15:25.437 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:25.437 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 20.7822 ms
2025-08-12 10:15:25.438 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 21.4355ms
2025-08-12 10:15:29.338 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 175
2025-08-12 10:15:29.338 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:29.339 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:29.339 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:15:29.344 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:15:29.346 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:15:29.350 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 10:15:29.353 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:29.353 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 14.3555ms
2025-08-12 10:15:29.354 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:29.354 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 15.3322 ms
2025-08-12 10:15:29.354 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 16.2824ms
2025-08-12 10:15:31.315 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 10:15:31.315 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:31.315 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.4932ms
2025-08-12 10:15:31.318 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 153
2025-08-12 10:15:31.318 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:31.319 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:31.319 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:15:31.325 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 10:15:31.329 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 10:15:31.335 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 10:15:31.338 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:31.338 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 18.9158ms
2025-08-12 10:15:31.338 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 10:15:31.338 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 20.1695 ms
2025-08-12 10:15:31.338 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 20.744ms
2025-08-12 10:15:54.524 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:15:54.524 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:54.525 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.6456ms
2025-08-12 10:15:54.554 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:15:54.554 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:15:54.555 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:15:54.556 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:15:54.570 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:15:54.583 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:15:54.584 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:15:54.585 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 28.853ms
2025-08-12 10:15:54.585 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:15:54.585 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 30.2386 ms
2025-08-12 10:15:54.585 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 31.0734ms
2025-08-12 10:39:13.756 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:39:13.756 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 1438220.5785 ms
2025-08-12 10:39:13.757 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=gW5hakMzG0jnFkf_NZXhtg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODMxMDcsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zbSjdJr2UJBfgBZ9paK4pdlUxS3MDggil3raz6KarUg - 200 null null 1438221.4522ms
2025-08-12 10:39:20.945 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 10:39:20.946 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:20.947 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 1.3734ms
2025-08-12 10:39:20.949 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 35
2025-08-12 10:39:20.950 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:20.951 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 10:39:20.962 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:39:21.002 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 10:39:21.020 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 10:39:21.024 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 61.0682ms
2025-08-12 10:39:21.024 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 10:39:21.024 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 73.5802 ms
2025-08-12 10:39:21.024 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 74.6817ms
2025-08-12 10:39:21.078 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 10:39:21.078 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:21.078 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.4642ms
2025-08-12 10:39:21.093 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 10:39:21.093 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:21.094 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.4179ms
2025-08-12 10:39:21.098 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:39:21.098 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:21.098 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.6203ms
2025-08-12 10:39:21.125 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 10:39:21.125 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:21.126 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 10:39:21.130 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 10:39:21.130 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:21.131 +03:00 [INF] HTTP GET /api/Users responded 404 in 0.7754 ms
2025-08-12 10:39:21.132 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 1.8065ms
2025-08-12 10:39:21.132 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 10:39:21.133 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 10:39:21.137 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:39:21.137 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:21.138 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:39:21.139 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:39:21.147 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:39:21.156 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 10:39:21.182 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:39:21.184 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 45.7772ms
2025-08-12 10:39:21.185 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:39:21.185 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 47.1939 ms
2025-08-12 10:39:21.185 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 47.7876ms
2025-08-12 10:39:21.185 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:39:21.187 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 54.7854ms
2025-08-12 10:39:21.187 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 10:39:21.187 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 61.6932 ms
2025-08-12 10:39:21.187 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 499 null application/json; charset=utf-8 62.6984ms
2025-08-12 10:39:22.706 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:39:22.706 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:22.707 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:39:22.707 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:39:22.711 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:39:22.712 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:22.712 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:39:22.712 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.7108ms
2025-08-12 10:39:22.734 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:39:22.734 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:22.735 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:39:22.735 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:39:22.742 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:39:22.747 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:39:22.748 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:39:22.748 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 13.0973ms
2025-08-12 10:39:22.748 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:39:22.748 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 13.9778 ms
2025-08-12 10:39:22.748 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 14.579ms
2025-08-12 10:39:22.752 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:39:22.753 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:39:22.754 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 46.1749ms
2025-08-12 10:39:22.754 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:39:22.754 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 47.3556 ms
2025-08-12 10:39:22.754 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 48.1279ms
2025-08-12 10:39:24.027 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:39:24.027 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:24.028 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:39:24.028 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:39:24.030 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:39:24.032 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:39:24.033 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:39:24.033 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 5.5747ms
2025-08-12 10:39:24.034 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:39:24.034 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 6.3353 ms
2025-08-12 10:39:24.034 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 7.0121ms
2025-08-12 10:39:40.945 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:39:40.946 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:40.946 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3852ms
2025-08-12 10:39:40.954 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:39:40.954 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:39:40.956 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:39:40.956 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:39:40.966 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:39:40.974 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:39:40.975 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:39:40.975 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 18.9503ms
2025-08-12 10:39:40.975 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:39:40.975 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 20.5061 ms
2025-08-12 10:39:40.975 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 21.3833ms
2025-08-12 10:40:38.690 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 10:40:38.690 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 0.7417ms
2025-08-12 10:41:28.112 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 165
2025-08-12 10:41:28.113 +03:00 [INF] CORS policy execution failed.
2025-08-12 10:41:28.113 +03:00 [INF] Request origin https://localhost:7003 does not have permission to access the resource.
2025-08-12 10:41:28.113 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:41:28.124 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:41:28.159 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:41:28.201 +03:00 [ERR] Failed executing DbCommand (25ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:41:28.229 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ChatRooms_Workspaces_WorkspaceId". The conflict occurred in database "AmanahChatDB", table "dbo.Workspaces", column 'Id'.
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_ChatRooms_ChatRoomId". The conflict occurred in database "AmanahChatDB", table "dbo.ChatRooms", column 'Id'.
The statement has been terminated.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1ac874ad-6a6d-4f0e-a6b2-46e2109fcb5d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ChatRooms_Workspaces_WorkspaceId". The conflict occurred in database "AmanahChatDB", table "dbo.Workspaces", column 'Id'.
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_ChatRooms_ChatRoomId". The conflict occurred in database "AmanahChatDB", table "dbo.ChatRooms", column 'Id'.
The statement has been terminated.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1ac874ad-6a6d-4f0e-a6b2-46e2109fcb5d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:41:28.233 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:41:28.233 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 108.6579ms
2025-08-12 10:41:28.233 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:41:28.233 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 120.0313 ms
2025-08-12 10:41:28.233 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 121.1413ms
2025-08-12 10:48:53.559 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:48:53.559 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:48:53.559 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.4335ms
2025-08-12 10:48:53.565 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:48:53.565 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:48:53.566 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:48:53.566 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:48:53.575 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:48:53.584 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:48:53.584 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:48:53.584 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 18.1309ms
2025-08-12 10:48:53.584 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:48:53.584 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 19.0111 ms
2025-08-12 10:48:53.585 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 19.542ms
2025-08-12 10:50:04.546 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:50:04.546 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:04.546 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3172ms
2025-08-12 10:50:04.557 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:50:04.558 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:04.558 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3138ms
2025-08-12 10:50:04.576 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:50:04.576 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:04.577 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:50:04.578 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:50:04.586 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:50:04.597 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:50:04.597 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:04.598 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:50:04.599 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:50:04.599 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.5769 ms
2025-08-12 10:50:04.599 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.9815ms
2025-08-12 10:50:04.623 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=kbHhpFT0KR8EElj6RWQaVA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:50:04.624 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:04.630 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:50:04.645 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:50:04.645 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:04.645 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 67.5086ms
2025-08-12 10:50:04.645 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:50:04.645 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 68.5533 ms
2025-08-12 10:50:04.645 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 69.4228ms
2025-08-12 10:50:06.130 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:50:06.130 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:06.130 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3537ms
2025-08-12 10:50:06.187 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:50:06.187 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:06.187 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:06.188 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:50:06.194 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:50:06.202 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:50:06.203 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:06.203 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 15.3854ms
2025-08-12 10:50:06.203 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:06.203 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 16.2073 ms
2025-08-12 10:50:06.203 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 16.7663ms
2025-08-12 10:50:10.718 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:50:10.718 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 6094.0546 ms
2025-08-12 10:50:10.718 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=kbHhpFT0KR8EElj6RWQaVA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 6094.5252ms
2025-08-12 10:50:11.846 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:50:11.846 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:11.846 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.401ms
2025-08-12 10:50:11.863 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:50:11.864 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:11.864 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:11.865 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:50:11.875 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:50:11.880 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:50:11.880 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:11.881 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 15.9747ms
2025-08-12 10:50:11.881 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:11.881 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 16.8662 ms
2025-08-12 10:50:11.881 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 17.5075ms
2025-08-12 10:50:27.630 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/apiDirectChat/direct - null null
2025-08-12 10:50:27.630 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:27.631 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/apiDirectChat/direct - 204 null null 0.3262ms
2025-08-12 10:50:27.634 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/apiDirectChat/direct - application/json 103
2025-08-12 10:50:27.634 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:27.635 +03:00 [INF] HTTP POST /apiDirectChat/direct responded 404 in 0.3541 ms
2025-08-12 10:50:27.635 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/apiDirectChat/direct - 404 0 null 0.8565ms
2025-08-12 10:50:27.635 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7003/apiDirectChat/direct, Response status code: 404
2025-08-12 10:50:43.933 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:50:43.933 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:43.933 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2311ms
2025-08-12 10:50:43.949 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:50:43.949 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:43.950 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:43.950 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:50:43.957 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:50:43.962 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:50:43.963 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:43.963 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 13.0292ms
2025-08-12 10:50:43.963 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:43.963 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 13.7354 ms
2025-08-12 10:50:43.963 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 14.4485ms
2025-08-12 10:50:45.160 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:50:45.161 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:45.161 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.2139ms
2025-08-12 10:50:45.163 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 103
2025-08-12 10:50:45.163 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:45.164 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:50:45.164 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:50:45.174 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:50:45.197 +03:00 [ERR] Failed executing DbCommand (20ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:50:45.200 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:80aefb18-0c5d-497f-a11c-2aa0df2384bd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:80aefb18-0c5d-497f-a11c-2aa0df2384bd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:50:45.203 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:45.203 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 38.3337ms
2025-08-12 10:50:45.203 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:50:45.203 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 38.9577 ms
2025-08-12 10:50:45.203 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 40.1824ms
2025-08-12 10:50:45.287 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:50:45.287 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:45.288 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2818ms
2025-08-12 10:50:45.294 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:50:45.294 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:45.294 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2919ms
2025-08-12 10:50:45.332 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:50:45.332 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:45.333 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:50:45.333 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:50:45.338 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:50:45.338 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:45.339 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:50:45.339 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:50:45.339 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.8665 ms
2025-08-12 10:50:45.339 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.4978ms
2025-08-12 10:50:45.341 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:50:45.358 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=9rr86L7SFyQFiMJZxk1wQQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:50:45.359 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:45.359 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:50:45.376 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:50:45.377 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:45.377 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 43.6938ms
2025-08-12 10:50:45.377 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:50:45.377 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 44.8322 ms
2025-08-12 10:50:45.377 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 45.3283ms
2025-08-12 10:50:53.118 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:50:53.118 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:53.118 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.304ms
2025-08-12 10:50:53.158 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:50:53.158 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:53.159 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:53.160 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:50:53.163 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:50:53.166 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:50:53.167 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:53.167 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 7.231ms
2025-08-12 10:50:53.167 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:50:53.167 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 8.4678 ms
2025-08-12 10:50:53.167 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 9.0654ms
2025-08-12 10:50:54.541 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:50:54.541 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:54.541 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.3124ms
2025-08-12 10:50:54.545 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 103
2025-08-12 10:50:54.545 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:54.545 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:50:54.546 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:50:54.549 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:50:54.557 +03:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:50:54.560 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:69d747cb-fef4-4e00-8adf-73b98023b4ff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:69d747cb-fef4-4e00-8adf-73b98023b4ff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:50:54.564 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:54.565 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 18.9237ms
2025-08-12 10:50:54.565 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:50:54.565 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 19.7320 ms
2025-08-12 10:50:54.565 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 20.467ms
2025-08-12 10:50:54.599 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:50:54.600 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:54.600 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2199ms
2025-08-12 10:50:54.624 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:50:54.624 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:50:54.625 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:50:54.625 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:50:54.634 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:50:54.638 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:50:54.638 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:50:54.638 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 13.6099ms
2025-08-12 10:50:54.639 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:50:54.639 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 14.3657 ms
2025-08-12 10:50:54.639 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 14.8974ms
2025-08-12 10:50:59.784 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:50:59.785 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 14426.0380 ms
2025-08-12 10:50:59.785 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=9rr86L7SFyQFiMJZxk1wQQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 14426.9376ms
2025-08-12 10:51:00.251 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:51:00.251 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:00.251 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.4017ms
2025-08-12 10:51:00.252 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:00.252 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:00.252 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.1315ms
2025-08-12 10:51:00.260 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:51:00.260 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:00.260 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:51:00.260 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:00.260 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:00.260 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:51:00.261 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.6365 ms
2025-08-12 10:51:00.261 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.9615ms
2025-08-12 10:51:00.261 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:00.261 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:51:00.267 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:00.275 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=aV0cnMN8fkn2m4MHVX2riA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:51:00.275 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:00.275 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:51:00.302 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:51:00.303 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:00.303 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 42.1424ms
2025-08-12 10:51:00.303 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:00.303 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 42.5843 ms
2025-08-12 10:51:00.303 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 42.892ms
2025-08-12 10:51:03.717 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:03.718 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:03.718 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.6788ms
2025-08-12 10:51:03.751 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:03.752 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:03.753 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:03.753 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:51:03.759 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:03.764 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:51:03.765 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:03.765 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 12.2224ms
2025-08-12 10:51:03.765 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:03.765 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 13.1199 ms
2025-08-12 10:51:03.765 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 14.1052ms
2025-08-12 10:51:05.860 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:51:05.860 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:05.861 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.3251ms
2025-08-12 10:51:05.864 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 103
2025-08-12 10:51:05.865 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:05.865 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:05.865 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:51:05.871 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:51:05.892 +03:00 [ERR] Failed executing DbCommand (15ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:51:05.894 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:69d747cb-fef4-4e00-8adf-73b98023b4ff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:69d747cb-fef4-4e00-8adf-73b98023b4ff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:51:05.895 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:05.896 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 29.9652ms
2025-08-12 10:51:05.896 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:05.896 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 30.7270 ms
2025-08-12 10:51:05.896 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 31.3167ms
2025-08-12 10:51:05.934 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:05.934 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:05.934 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2758ms
2025-08-12 10:51:05.959 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:05.959 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:05.959 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:05.959 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:51:05.964 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:05.968 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:51:05.969 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:05.969 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 9.2731ms
2025-08-12 10:51:05.969 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:05.969 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 10.0030 ms
2025-08-12 10:51:05.969 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 10.41ms
2025-08-12 10:51:07.781 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:07.781 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:07.782 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:07.782 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:51:07.786 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:07.787 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:51:07.788 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:07.789 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 6.2737ms
2025-08-12 10:51:07.789 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:07.789 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 7.4097 ms
2025-08-12 10:51:07.789 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 7.9675ms
2025-08-12 10:51:09.322 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 103
2025-08-12 10:51:09.322 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:09.323 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:09.323 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:51:09.326 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:51:09.332 +03:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:51:09.334 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:69d747cb-fef4-4e00-8adf-73b98023b4ff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:69d747cb-fef4-4e00-8adf-73b98023b4ff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:51:09.336 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:09.336 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 13.2793ms
2025-08-12 10:51:09.336 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:09.336 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 13.9171 ms
2025-08-12 10:51:09.337 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 14.3898ms
2025-08-12 10:51:09.368 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:09.368 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:09.369 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:09.369 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:51:09.370 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:09.373 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:51:09.373 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:09.374 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 4.9998ms
2025-08-12 10:51:09.374 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:09.374 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 5.5332 ms
2025-08-12 10:51:09.374 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.0065ms
2025-08-12 10:51:19.536 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:51:19.536 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 19261.1535 ms
2025-08-12 10:51:19.536 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=aV0cnMN8fkn2m4MHVX2riA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 19261.4222ms
2025-08-12 10:51:20.005 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:20.005 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:20.005 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2968ms
2025-08-12 10:51:20.017 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:51:20.018 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:20.018 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3678ms
2025-08-12 10:51:20.024 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:20.024 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:51:20.025 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:20.025 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:20.025 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:20.025 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:51:20.025 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:51:20.025 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:51:20.025 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.6823 ms
2025-08-12 10:51:20.025 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.9945ms
2025-08-12 10:51:20.027 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:20.029 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:51:20.029 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:20.030 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 4.5211ms
2025-08-12 10:51:20.030 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:20.030 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 5.1009 ms
2025-08-12 10:51:20.030 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 5.487ms
2025-08-12 10:51:20.033 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=7AewB8pnngMV2O782gSjcw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:51:20.034 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:20.034 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:51:21.334 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:21.334 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:21.334 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2675ms
2025-08-12 10:51:21.362 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:21.363 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:21.363 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:21.363 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:51:21.367 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:21.369 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:51:21.370 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:21.370 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 6.7694ms
2025-08-12 10:51:21.370 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:21.370 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 7.3043 ms
2025-08-12 10:51:21.370 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 7.763ms
2025-08-12 10:51:24.355 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:51:24.355 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:24.355 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.2607ms
2025-08-12 10:51:24.358 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 103
2025-08-12 10:51:24.359 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:24.359 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:24.359 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:51:24.362 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:51:24.367 +03:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:51:24.372 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:80aefb18-0c5d-497f-a11c-2aa0df2384bd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:80aefb18-0c5d-497f-a11c-2aa0df2384bd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:51:24.375 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:24.375 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 15.7041ms
2025-08-12 10:51:24.375 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:24.375 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 16.2433 ms
2025-08-12 10:51:24.375 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 16.6913ms
2025-08-12 10:51:24.423 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:24.423 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:24.423 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:24.424 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:51:24.426 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:24.429 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:51:24.429 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:24.429 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 5.6014ms
2025-08-12 10:51:24.429 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:24.429 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 6.2439 ms
2025-08-12 10:51:24.429 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.6555ms
2025-08-12 10:51:47.112 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:47.113 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:47.113 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2744ms
2025-08-12 10:51:47.120 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:47.120 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:47.120 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.178ms
2025-08-12 10:51:47.127 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:47.128 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:47.128 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:47.129 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:51:47.129 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:47.129 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:47.129 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:47.130 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:51:47.131 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:47.134 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:47.137 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:51:47.138 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:47.138 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 8.3995ms
2025-08-12 10:51:47.138 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:47.138 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 9.0702 ms
2025-08-12 10:51:47.138 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 9.5046ms
2025-08-12 10:51:47.139 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:51:47.139 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:47.140 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 10.9969ms
2025-08-12 10:51:47.140 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:47.140 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 11.8640 ms
2025-08-12 10:51:47.140 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 12.5174ms
2025-08-12 10:51:47.387 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:47.388 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:47.388 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:47.388 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:51:47.402 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:47.411 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:51:47.411 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:47.411 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 23.271ms
2025-08-12 10:51:47.412 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:51:47.412 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 23.8881 ms
2025-08-12 10:51:47.412 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 24.3293ms
2025-08-12 10:51:53.285 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:51:53.286 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:53.286 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.3785ms
2025-08-12 10:51:53.290 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 103
2025-08-12 10:51:53.290 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:53.290 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:53.290 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:51:53.299 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:51:53.327 +03:00 [ERR] Failed executing DbCommand (24ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:51:53.329 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.EntityFramework.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:80aefb18-0c5d-497f-a11c-2aa0df2384bd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_RoomMembers_Users_UserId". The conflict occurred in database "AmanahChatDB", table "dbo.Users", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:80aefb18-0c5d-497f-a11c-2aa0df2384bd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-12 10:51:53.333 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:53.333 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 42.6125ms
2025-08-12 10:51:53.333 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:51:53.333 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 43.3510 ms
2025-08-12 10:51:53.333 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 43.8738ms
2025-08-12 10:51:53.380 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:51:53.380 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:53.381 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2418ms
2025-08-12 10:51:53.425 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:51:53.425 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:51:53.425 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:53.426 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:51:53.433 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:51:53.465 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:51:53.465 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:51:53.465 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 39.486ms
2025-08-12 10:51:53.465 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:51:53.465 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 40.2154 ms
2025-08-12 10:51:53.465 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 40.6345ms
2025-08-12 10:53:06.733 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:53:06.733 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 106699.3572 ms
2025-08-12 10:53:06.733 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=7AewB8pnngMV2O782gSjcw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 106699.692ms
2025-08-12 10:53:07.411 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:53:07.412 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:07.412 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3287ms
2025-08-12 10:53:07.424 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:53:07.424 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:07.424 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3342ms
2025-08-12 10:53:07.427 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:07.428 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:07.428 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:07.428 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:53:07.432 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:53:07.432 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:07.433 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:53:07.433 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:53:07.433 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.5926 ms
2025-08-12 10:53:07.433 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.9396ms
2025-08-12 10:53:07.451 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:07.461 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=oO7lsWaAyIS92qT-A8UDDg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:53:07.461 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:07.462 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:53:07.494 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:53:07.494 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:07.494 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 65.7936ms
2025-08-12 10:53:07.494 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:07.494 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 66.4813 ms
2025-08-12 10:53:07.494 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 66.8511ms
2025-08-12 10:53:08.523 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:08.523 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:08.524 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:08.524 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:53:08.534 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:08.538 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:53:08.538 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:08.538 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2732ms
2025-08-12 10:53:08.574 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:53:08.575 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:08.575 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 50.6193ms
2025-08-12 10:53:08.575 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:08.575 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 51.7283 ms
2025-08-12 10:53:08.575 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 52.1838ms
2025-08-12 10:53:08.577 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:08.577 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:08.578 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:08.578 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:53:08.590 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:08.618 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:53:08.619 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:08.619 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 40.7009ms
2025-08-12 10:53:08.619 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:08.619 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 41.4756 ms
2025-08-12 10:53:08.619 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 42.24ms
2025-08-12 10:53:10.019 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:10.020 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:10.020 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:10.020 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:53:10.030 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:10.037 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:53:10.037 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:10.037 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 16.703ms
2025-08-12 10:53:10.037 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:10.037 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 17.5388 ms
2025-08-12 10:53:10.037 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 17.9474ms
2025-08-12 10:53:11.424 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:53:11.424 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:11.424 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.269ms
2025-08-12 10:53:11.429 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 152
2025-08-12 10:53:11.429 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:11.429 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:53:11.429 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:53:11.439 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:53:11.439 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:11.439 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 9.7146ms
2025-08-12 10:53:11.439 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:53:11.439 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 10.4314 ms
2025-08-12 10:53:11.440 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 10.9173ms
2025-08-12 10:53:11.499 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:11.499 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:11.499 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:11.500 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:53:11.507 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:11.548 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:53:11.548 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:11.549 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 48.9064ms
2025-08-12 10:53:11.549 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:11.549 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 49.8833 ms
2025-08-12 10:53:11.549 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 50.2885ms
2025-08-12 10:53:19.993 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:53:19.993 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 12531.6269 ms
2025-08-12 10:53:19.993 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=oO7lsWaAyIS92qT-A8UDDg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 12531.91ms
2025-08-12 10:53:20.431 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:53:20.432 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:20.432 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 1.2837ms
2025-08-12 10:53:20.432 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:53:20.433 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:20.433 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.1249ms
2025-08-12 10:53:20.455 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:20.455 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:20.456 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:20.456 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:53:20.459 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:20.461 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:53:20.461 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:20.461 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 5.2738ms
2025-08-12 10:53:20.461 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:20.461 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 6.3175 ms
2025-08-12 10:53:20.462 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.7308ms
2025-08-12 10:53:20.474 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:53:20.474 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:20.474 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:53:20.474 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:53:20.474 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.3500 ms
2025-08-12 10:53:20.474 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.6226ms
2025-08-12 10:53:20.540 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=p_Bwesiq7nKjQN4ngL3JJQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:53:20.540 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:20.540 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:53:23.277 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:53:23.277 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:23.277 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2313ms
2025-08-12 10:53:23.325 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:23.325 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:23.326 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:23.326 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:53:23.333 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:23.338 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:53:23.339 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:23.339 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 13.2988ms
2025-08-12 10:53:23.339 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:23.339 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 13.9548 ms
2025-08-12 10:53:23.339 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 14.4456ms
2025-08-12 10:53:24.410 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:53:24.410 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:24.410 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.2474ms
2025-08-12 10:53:24.414 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 152
2025-08-12 10:53:24.416 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:24.416 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:53:24.416 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:53:24.419 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:53:24.447 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 10:53:24.450 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:24.450 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 33.6553ms
2025-08-12 10:53:24.450 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:53:24.450 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 34.0947 ms
2025-08-12 10:53:24.450 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 36.3323ms
2025-08-12 10:53:24.478 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:24.479 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:24.479 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:24.479 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:53:24.483 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:24.486 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:53:24.486 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:24.486 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 7.0009ms
2025-08-12 10:53:24.486 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:24.486 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 7.5518 ms
2025-08-12 10:53:24.486 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 7.9769ms
2025-08-12 10:53:37.864 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - null null
2025-08-12 10:53:37.864 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:37.865 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 204 null null 0.307ms
2025-08-12 10:53:37.867 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - application/json null
2025-08-12 10:53:37.868 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:37.868 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:53:37.868 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:53:37.879 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:53:37.879 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:37.879 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3404ms
2025-08-12 10:53:37.882 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:37.883 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:37.883 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:37.883 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:37.884 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:53:37.886 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:37.887 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:53:37.888 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:37.888 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 4.4579ms
2025-08-12 10:53:37.888 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:37.888 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 4.9307 ms
2025-08-12 10:53:37.888 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 5.3034ms
2025-08-12 10:53:37.969 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:53:37.969 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:37.969 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 101.3813ms
2025-08-12 10:53:37.969 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:53:37.969 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091 responded 200 in 101.7689 ms
2025-08-12 10:53:37.970 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 200 null application/json; charset=utf-8 102.0523ms
2025-08-12 10:53:44.464 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - null null
2025-08-12 10:53:44.465 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:44.465 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - 204 null null 0.2419ms
2025-08-12 10:53:44.469 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - application/json null
2025-08-12 10:53:44.469 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:44.469 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 10:53:44.478 +03:00 [INF] Route matched with {action = "GetUsersByChatRoom", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByChatRoom(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:53:44.486 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:44.521 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0
2025-08-12 10:53:44.527 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:44.528 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI) in 49.5594ms
2025-08-12 10:53:44.528 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 10:53:44.528 +03:00 [INF] HTTP GET /api/Users/GetUsersByChatRoom responded 200 in 58.9309 ms
2025-08-12 10:53:44.528 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - 200 null application/json; charset=utf-8 59.343ms
2025-08-12 10:53:53.296 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:53:53.296 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 32756.2308 ms
2025-08-12 10:53:53.296 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=p_Bwesiq7nKjQN4ngL3JJQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 32756.4703ms
2025-08-12 10:53:53.862 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:53:53.862 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:53.862 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3319ms
2025-08-12 10:53:53.876 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:53:53.876 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:53.877 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2721ms
2025-08-12 10:53:53.890 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:53.890 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:53.890 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:53.890 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:53:53.892 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:53.892 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:53:53.893 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:53.893 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:53:53.893 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:53:53.893 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.5620 ms
2025-08-12 10:53:53.893 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.947ms
2025-08-12 10:53:53.895 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:53:53.896 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:53.896 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 5.634ms
2025-08-12 10:53:53.896 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:53:53.896 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 6.0816 ms
2025-08-12 10:53:53.896 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.458ms
2025-08-12 10:53:53.905 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=bzLNS25KqMWemSj9RGcy4w&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:53:53.905 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:53.905 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:53:54.741 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - null null
2025-08-12 10:53:54.741 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:54.741 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 204 null null 0.2878ms
2025-08-12 10:53:54.746 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - application/json null
2025-08-12 10:53:54.746 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:54.746 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:53:54.746 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:53:54.764 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:54.770 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:53:54.770 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:54.770 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3997ms
2025-08-12 10:53:54.777 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:53:54.777 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:54.778 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:54.778 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:53:54.790 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:54.797 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:53:54.798 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:54.798 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 20.0199ms
2025-08-12 10:53:54.798 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:53:54.799 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 20.9362 ms
2025-08-12 10:53:54.799 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 21.5696ms
2025-08-12 10:53:54.853 +03:00 [INF] Executed DbCommand (87ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:53:54.853 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:54.853 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 106.8432ms
2025-08-12 10:53:54.853 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:53:54.853 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091 responded 200 in 107.3737 ms
2025-08-12 10:53:54.853 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 200 null application/json; charset=utf-8 107.7813ms
2025-08-12 10:53:57.681 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - null null
2025-08-12 10:53:57.681 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:57.681 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - 204 null null 0.3027ms
2025-08-12 10:53:57.686 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - application/json null
2025-08-12 10:53:57.686 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:53:57.686 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 10:53:57.686 +03:00 [INF] Route matched with {action = "GetUsersByChatRoom", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByChatRoom(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:53:57.698 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:53:57.714 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0
2025-08-12 10:53:57.714 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:53:57.715 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI) in 28.1042ms
2025-08-12 10:53:57.715 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 10:53:57.715 +03:00 [INF] HTTP GET /api/Users/GetUsersByChatRoom responded 200 in 28.5375 ms
2025-08-12 10:53:57.715 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5ca31106-2830-40a3-a4fb-72534077b091&pageNumber=1&pageSize=50 - 200 null application/json; charset=utf-8 29.1098ms
2025-08-12 10:54:27.272 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:54:27.272 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:27.272 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2048ms
2025-08-12 10:54:27.310 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:54:27.310 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:27.310 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:54:27.311 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:54:27.319 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:54:27.325 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:54:27.325 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:54:27.326 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 14.978ms
2025-08-12 10:54:27.326 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:54:27.326 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 15.6003 ms
2025-08-12 10:54:27.326 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 15.9751ms
2025-08-12 10:54:28.660 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 10:54:28.660 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:28.661 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.2658ms
2025-08-12 10:54:28.664 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 152
2025-08-12 10:54:28.664 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:28.666 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:54:28.666 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 10:54:28.682 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 10:54:28.682 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:54:28.683 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 16.5558ms
2025-08-12 10:54:28.683 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 10:54:28.683 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 18.8218 ms
2025-08-12 10:54:28.683 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 19.2413ms
2025-08-12 10:54:28.735 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:54:28.736 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:28.737 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 1.4493ms
2025-08-12 10:54:28.741 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:54:28.741 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:28.741 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:54:28.742 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:54:28.751 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:54:28.804 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:54:28.804 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:54:28.804 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 62.4671ms
2025-08-12 10:54:28.804 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:54:28.804 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 62.9860 ms
2025-08-12 10:54:28.804 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 63.6629ms
2025-08-12 10:54:32.242 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:54:32.242 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 38336.6710 ms
2025-08-12 10:54:32.242 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=bzLNS25KqMWemSj9RGcy4w&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 38336.9681ms
2025-08-12 10:54:32.779 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:54:32.779 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:32.780 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:54:32.781 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:54:32.785 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:54:32.786 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:32.786 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2474ms
2025-08-12 10:54:32.787 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:54:32.790 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:54:32.790 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:32.791 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:54:32.791 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:54:32.791 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.5114 ms
2025-08-12 10:54:32.791 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.8775ms
2025-08-12 10:54:32.801 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=SymYFad_ZCL54hd6KQ_FRw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:54:32.801 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:54:32.802 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:54:32.826 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:54:32.827 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:54:32.827 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 46.1784ms
2025-08-12 10:54:32.827 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:54:32.827 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 47.5313 ms
2025-08-12 10:54:32.827 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 48.1767ms
2025-08-12 10:56:27.418 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:56:27.418 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 114616.6599 ms
2025-08-12 10:56:27.418 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=SymYFad_ZCL54hd6KQ_FRw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 114616.9622ms
2025-08-12 10:56:28.006 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:56:28.006 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:28.006 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3221ms
2025-08-12 10:56:28.015 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:56:28.015 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:28.015 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3248ms
2025-08-12 10:56:28.030 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:56:28.030 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:28.030 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:28.030 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:56:28.037 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:56:28.037 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:28.037 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:56:28.038 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:56:28.038 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.6617 ms
2025-08-12 10:56:28.038 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.9356ms
2025-08-12 10:56:28.041 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:28.052 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=wNW0tpxbaSrWFjWemTUSbg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:56:28.052 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:28.053 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:56:28.091 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:56:28.091 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:28.092 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 61.0093ms
2025-08-12 10:56:28.092 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:28.092 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 61.7507 ms
2025-08-12 10:56:28.092 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 62.1524ms
2025-08-12 10:56:29.344 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - null null
2025-08-12 10:56:29.344 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:29.344 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 204 null null 0.2858ms
2025-08-12 10:56:29.348 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - application/json null
2025-08-12 10:56:29.349 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:29.349 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:56:29.349 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:56:29.361 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:29.363 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:56:29.363 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:29.364 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2439ms
2025-08-12 10:56:29.368 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:56:29.368 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:29.368 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:56:29.369 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:56:29.375 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:29.381 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:56:29.381 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:29.381 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 12.3944ms
2025-08-12 10:56:29.381 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:56:29.381 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 12.8506 ms
2025-08-12 10:56:29.381 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 13.3364ms
2025-08-12 10:56:29.422 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:56:29.422 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:29.422 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 73.1779ms
2025-08-12 10:56:29.422 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:56:29.422 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091 responded 200 in 73.7374 ms
2025-08-12 10:56:29.423 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 200 null application/json; charset=utf-8 74.1594ms
2025-08-12 10:56:36.784 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/RemoveMembers - null null
2025-08-12 10:56:36.784 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:36.784 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/RemoveMembers - 204 null null 0.2781ms
2025-08-12 10:56:36.800 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7003/api/ChatRooms/RemoveMembers - application/json 101
2025-08-12 10:56:36.800 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:36.803 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI)'
2025-08-12 10:56:36.813 +03:00 [INF] Route matched with {action = "AddMember", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddMemberAsync(Application.Commands.ChatRooms.RemoveRoomMember.RemoveRoomMemberRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:56:36.843 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:36.850 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:36.864 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
FROM [RoomMembers] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0 AND [r].[UserId] = @__request_UserId_1
2025-08-12 10:56:36.874 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p1='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [RoomMembers] SET [IsDeleted] = @p0, [LastActionDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-08-12 10:56:36.875 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:36.875 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI) in 62.3515ms
2025-08-12 10:56:36.875 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI)'
2025-08-12 10:56:36.875 +03:00 [INF] HTTP DELETE /api/ChatRooms/RemoveMembers responded 200 in 74.7501 ms
2025-08-12 10:56:36.875 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7003/api/ChatRooms/RemoveMembers - 200 null application/json; charset=utf-8 75.4847ms
2025-08-12 10:56:36.885 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:56:36.885 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:36.885 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2058ms
2025-08-12 10:56:36.888 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:56:36.888 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:36.888 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:36.889 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:56:36.891 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:36.928 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:56:36.928 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:36.928 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 39.391ms
2025-08-12 10:56:36.928 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:36.928 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 40.1174 ms
2025-08-12 10:56:36.928 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 40.4892ms
2025-08-12 10:56:39.911 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 10:56:39.911 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 11858.3899 ms
2025-08-12 10:56:39.911 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=wNW0tpxbaSrWFjWemTUSbg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 11858.7415ms
2025-08-12 10:56:40.414 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:56:40.414 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:40.414 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:40.415 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:56:40.417 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:40.430 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 10:56:40.430 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:40.430 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2732ms
2025-08-12 10:56:40.434 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:56:40.435 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:40.435 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 20.3943ms
2025-08-12 10:56:40.435 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:40.435 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 20.8577 ms
2025-08-12 10:56:40.435 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 21.2673ms
2025-08-12 10:56:40.447 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 10:56:40.447 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:40.447 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 10:56:40.447 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 10:56:40.447 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.4439 ms
2025-08-12 10:56:40.448 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.7555ms
2025-08-12 10:56:40.476 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=f9wcXlg0kcGcShmT-JjWlw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 10:56:40.477 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:40.477 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 10:56:41.445 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - null null
2025-08-12 10:56:41.445 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:41.445 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 204 null null 0.2721ms
2025-08-12 10:56:41.449 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - application/json null
2025-08-12 10:56:41.449 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:41.450 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:56:41.450 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:56:41.457 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:41.467 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:56:41.468 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:41.468 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3112ms
2025-08-12 10:56:41.474 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:56:41.474 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:41.474 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:56:41.474 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:56:41.486 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:41.494 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:56:41.495 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:41.495 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 20.9748ms
2025-08-12 10:56:41.495 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:56:41.496 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 21.7905 ms
2025-08-12 10:56:41.496 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 22.3316ms
2025-08-12 10:56:41.550 +03:00 [INF] Executed DbCommand (90ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:56:41.550 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:41.550 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 100.3901ms
2025-08-12 10:56:41.550 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:56:41.550 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091 responded 200 in 100.8988 ms
2025-08-12 10:56:41.550 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5ca31106-2830-40a3-a4fb-72534077b091?page=1&pageSize=50 - 200 null application/json; charset=utf-8 101.2811ms
2025-08-12 10:56:44.776 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/RemoveMembers - null null
2025-08-12 10:56:44.776 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:44.777 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/RemoveMembers - 204 null null 0.2586ms
2025-08-12 10:56:44.781 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7003/api/ChatRooms/RemoveMembers - application/json 101
2025-08-12 10:56:44.781 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:44.781 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI)'
2025-08-12 10:56:44.781 +03:00 [INF] Route matched with {action = "AddMember", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddMemberAsync(Application.Commands.ChatRooms.RemoveRoomMember.RemoveRoomMemberRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:56:44.785 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:44.789 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:44.792 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
FROM [RoomMembers] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0 AND [r].[UserId] = @__request_UserId_1
2025-08-12 10:56:44.798 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p1='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [RoomMembers] SET [IsDeleted] = @p0, [LastActionDate] = @p1
OUTPUT 1
WHERE [Id] = @p2;
2025-08-12 10:56:44.798 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:44.798 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI) in 16.8748ms
2025-08-12 10:56:44.798 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI)'
2025-08-12 10:56:44.798 +03:00 [INF] HTTP DELETE /api/ChatRooms/RemoveMembers responded 200 in 17.4211 ms
2025-08-12 10:56:44.799 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7003/api/ChatRooms/RemoveMembers - 200 null application/json; charset=utf-8 17.7986ms
2025-08-12 10:56:44.813 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:56:44.813 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:44.813 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2214ms
2025-08-12 10:56:44.819 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:56:44.819 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:44.819 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:44.819 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:56:44.821 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:44.823 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:56:44.823 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:44.824 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 4.3007ms
2025-08-12 10:56:44.824 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:56:44.824 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 4.7030 ms
2025-08-12 10:56:44.824 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 5.0238ms
2025-08-12 10:56:46.969 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 10:56:46.969 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:46.969 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.3472ms
2025-08-12 10:56:46.974 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 10:56:46.975 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:46.975 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:56:46.975 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 10:56:46.978 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:46.981 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:56:46.982 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:46.982 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3874ms
2025-08-12 10:56:46.989 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 10:56:46.993 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:56:46.993 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:46.994 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:56:46.994 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:56:46.998 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:46.999 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:47.002 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:56:47.002 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:47.002 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 8.3852ms
2025-08-12 10:56:47.002 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:56:47.002 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 8.9020 ms
2025-08-12 10:56:47.002 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 9.4182ms
2025-08-12 10:56:47.004 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 28.5895ms
2025-08-12 10:56:47.004 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 10:56:47.004 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 29.2456 ms
2025-08-12 10:56:47.004 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 29.6887ms
2025-08-12 10:56:59.514 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - null null
2025-08-12 10:56:59.514 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:59.514 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - 204 null null 0.3563ms
2025-08-12 10:56:59.518 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - application/json null
2025-08-12 10:56:59.519 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:56:59.519 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 10:56:59.519 +03:00 [INF] Route matched with {action = "GetUsersByChatRoom", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByChatRoom(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:56:59.533 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:56:59.546 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0
2025-08-12 10:56:59.547 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:56:59.547 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI) in 27.3732ms
2025-08-12 10:56:59.547 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 10:56:59.547 +03:00 [INF] HTTP GET /api/Users/GetUsersByChatRoom responded 200 in 27.9866 ms
2025-08-12 10:56:59.547 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - 200 null application/json; charset=utf-8 28.6958ms
2025-08-12 10:57:10.189 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:57:10.189 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:10.190 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3602ms
2025-08-12 10:57:10.201 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:57:10.201 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:10.202 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3098ms
2025-08-12 10:57:10.215 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:57:10.215 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:10.216 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:57:10.216 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:57:10.218 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:57:10.221 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:57:10.221 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:57:10.221 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 5.4072ms
2025-08-12 10:57:10.221 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:57:10.221 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 6.2163 ms
2025-08-12 10:57:10.221 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.6653ms
2025-08-12 10:57:10.235 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:57:10.235 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:10.236 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:57:10.236 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:57:10.238 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:57:10.239 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:57:10.240 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:57:10.240 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 4.2497ms
2025-08-12 10:57:10.240 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:57:10.240 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 4.7677 ms
2025-08-12 10:57:10.240 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 5.1971ms
2025-08-12 10:57:16.281 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:57:16.281 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:16.281 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3614ms
2025-08-12 10:57:16.318 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:57:16.318 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:16.319 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:57:16.319 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 10:57:16.321 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:57:16.323 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 10:57:16.323 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:57:16.324 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 4.3491ms
2025-08-12 10:57:16.324 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 10:57:16.324 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 5.2575 ms
2025-08-12 10:57:16.324 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 5.5792ms
2025-08-12 10:57:19.639 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 10:57:19.639 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:19.639 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.5039ms
2025-08-12 10:57:19.662 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 10:57:19.662 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:19.663 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 10:57:19.663 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 10:57:19.671 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 10:57:19.672 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:57:19.672 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 9.3385ms
2025-08-12 10:57:19.672 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 10:57:19.672 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 9.9420 ms
2025-08-12 10:57:19.673 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 10.548ms
2025-08-12 10:57:20.866 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 10:57:20.866 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:20.866 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3621ms
2025-08-12 10:57:20.928 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 10:57:20.929 +03:00 [INF] CORS policy execution successful.
2025-08-12 10:57:20.929 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:57:20.929 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 10:57:20.932 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 10:57:20.933 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 10:57:20.933 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 10:57:20.933 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 4.4976ms
2025-08-12 10:57:20.934 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 10:57:20.934 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 4.9194 ms
2025-08-12 10:57:20.934 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 5.2836ms
2025-08-12 11:00:21.050 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 11:00:21.050 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:21.050 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.3889ms
2025-08-12 11:00:21.067 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 11:00:21.067 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:21.067 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:00:21.067 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 11:00:21.076 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:00:21.076 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:00:21.076 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 8.7768ms
2025-08-12 11:00:21.076 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:00:21.076 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 9.2074 ms
2025-08-12 11:00:21.076 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 9.5216ms
2025-08-12 11:00:22.261 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:00:22.261 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:22.261 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3201ms
2025-08-12 11:00:22.294 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:00:22.295 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:22.295 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:00:22.295 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:00:22.302 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:00:22.314 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:00:22.314 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:00:22.314 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 18.9818ms
2025-08-12 11:00:22.314 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:00:22.314 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 19.6237 ms
2025-08-12 11:00:22.315 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 20.1699ms
2025-08-12 11:00:25.757 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 11:00:25.757 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 225280.6231 ms
2025-08-12 11:00:25.757 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=f9wcXlg0kcGcShmT-JjWlw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 225280.9318ms
2025-08-12 11:00:26.118 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 11:00:26.118 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:26.118 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.2112ms
2025-08-12 11:00:26.122 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 11:00:26.123 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:26.123 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:00:26.123 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 11:00:26.124 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:00:26.124 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:00:26.124 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 1.5448ms
2025-08-12 11:00:26.124 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:00:26.124 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 1.7493 ms
2025-08-12 11:00:26.124 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 1.9213ms
2025-08-12 11:00:58.010 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - null null
2025-08-12 11:00:58.010 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:58.010 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - 204 null null 0.3134ms
2025-08-12 11:00:58.012 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Add - application/json 198
2025-08-12 11:00:58.013 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:58.013 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:00:58.016 +03:00 [INF] Route matched with {action = "Add", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddAsync(Application.Commands.Users.AddUser.AddUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:00:58.075 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [ActionBy], [ConnectId], [Email], [FirstName], [IsAdmin], [IsDeleted], [LastActionDate], [LastName], [Metadata], [Password], [ProfileImageUrl], [Username], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-08-12 11:00:58.078 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:00:58.078 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI) in 62.538ms
2025-08-12 11:00:58.078 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:00:58.078 +03:00 [INF] HTTP POST /api/Users/Add responded 200 in 65.8562 ms
2025-08-12 11:00:58.078 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Add - 200 null application/json; charset=utf-8 66.2015ms
2025-08-12 11:00:58.103 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:00:58.104 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:58.104 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2053ms
2025-08-12 11:00:58.116 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:00:58.116 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:00:58.117 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:00:58.117 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:00:58.124 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:00:58.131 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:00:58.131 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:00:58.131 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 14.459ms
2025-08-12 11:00:58.131 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:00:58.131 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 14.9690 ms
2025-08-12 11:00:58.131 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 15.3012ms
2025-08-12 11:01:01.115 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 11:01:01.115 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:01.115 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.3306ms
2025-08-12 11:01:01.117 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 152
2025-08-12 11:01:01.117 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:01.117 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 11:01:01.117 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 11:01:01.124 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 11:01:01.136 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 11:01:01.138 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:01:01.138 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 20.5958ms
2025-08-12 11:01:01.138 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 11:01:01.138 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 20.7647 ms
2025-08-12 11:01:01.138 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 20.9367ms
2025-08-12 11:01:01.186 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:01:01.186 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:01.186 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2252ms
2025-08-12 11:01:01.189 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 11:01:01.189 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:01.190 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2541ms
2025-08-12 11:01:01.203 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:01:01.203 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:01.204 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:01:01.204 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 11:01:01.209 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:01:01.212 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 11:01:01.212 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:01.213 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 11:01:01.213 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 11:01:01.213 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.3097 ms
2025-08-12 11:01:01.213 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.5635ms
2025-08-12 11:01:01.223 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=kj6LiBkVkNQvHe9qPBJByw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 11:01:01.223 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:01.223 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 11:01:01.243 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 11:01:01.243 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:01:01.243 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 39.804ms
2025-08-12 11:01:01.243 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:01:01.244 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 40.0457 ms
2025-08-12 11:01:01.244 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 40.4332ms
2025-08-12 11:01:02.849 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - null null
2025-08-12 11:01:02.850 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:02.850 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 204 null null 0.398ms
2025-08-12 11:01:02.854 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - application/json null
2025-08-12 11:01:02.854 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:02.854 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:01:02.854 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:01:02.860 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:01:02.860 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:01:02.860 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:01:02.860 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:01:02.861 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:01:02.865 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:01:02.867 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:01:02.868 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:01:02.868 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 7.6657ms
2025-08-12 11:01:02.868 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:01:02.868 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 8.1293 ms
2025-08-12 11:01:02.868 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 8.4618ms
2025-08-12 11:01:02.932 +03:00 [INF] Executed DbCommand (70ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 11:01:02.932 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:01:02.932 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 77.7897ms
2025-08-12 11:01:02.932 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:01:02.932 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0 responded 200 in 78.1750 ms
2025-08-12 11:01:02.932 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 200 null application/json; charset=utf-8 78.5002ms
2025-08-12 11:08:56.681 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 11:08:56.681 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:08:56.681 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.3863ms
2025-08-12 11:08:56.685 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 11:08:56.685 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:08:56.686 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:08:56.686 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:08:56.700 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:08:56.770 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 11:08:56.771 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:08:56.771 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 84.2109ms
2025-08-12 11:08:56.771 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:08:56.771 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 85.2157 ms
2025-08-12 11:08:56.771 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 85.6411ms
2025-08-12 11:08:57.570 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - null null
2025-08-12 11:08:57.570 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:08:57.570 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 204 null null 0.3236ms
2025-08-12 11:08:57.574 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - application/json null
2025-08-12 11:08:57.574 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:08:57.575 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:08:57.575 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:08:57.578 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:08:57.582 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 11:08:57.582 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:08:57.583 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 8.3248ms
2025-08-12 11:08:57.583 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:08:57.583 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0 responded 200 in 9.1364 ms
2025-08-12 11:08:57.583 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 200 null application/json; charset=utf-8 9.6984ms
2025-08-12 11:09:00.154 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 11:09:00.154 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:09:00.154 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2127ms
2025-08-12 11:09:00.157 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 130
2025-08-12 11:09:00.158 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:09:00.158 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 11:09:00.158 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:09:00.175 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 11:09:00.184 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 11:09:00.206 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 11:09:00.208 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:09:00.209 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 50.5983ms
2025-08-12 11:09:00.209 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 11:09:00.209 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 51.0242 ms
2025-08-12 11:09:00.209 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 51.3614ms
2025-08-12 11:19:04.500 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 11:19:04.822 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 11:19:04.823 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 11:19:04.825 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 11:19:04.825 +03:00 [INF] Hosting environment: Development
2025-08-12 11:19:04.825 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 11:19:05.032 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 11:19:05.080 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 11:19:05.100 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:05.103 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 22.4334ms
2025-08-12 11:19:05.115 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 11:19:05.117 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:05.198 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 168.6143ms
2025-08-12 11:19:05.236 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 11:19:05.236 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 11:19:05.242 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 6.9061ms
2025-08-12 11:19:05.245 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 11:19:05.254 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 11:19:05.257 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 126.9504 ms
2025-08-12 11:19:05.259 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 144.2335ms
2025-08-12 11:19:05.279 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.3985ms
2025-08-12 11:19:05.297 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=YsXHZHLyBdanMqs9VEpvZQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 11:19:05.297 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:05.301 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 11:19:05.579 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 11:19:05.684 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 105.5394ms
2025-08-12 11:19:09.000 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 11:19:09.003 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 3704.1532 ms
2025-08-12 11:19:09.005 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=YsXHZHLyBdanMqs9VEpvZQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 3707.7617ms
2025-08-12 11:19:09.178 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 11:19:09.178 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:09.179 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.6292ms
2025-08-12 11:19:09.188 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:19:09.188 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:09.189 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.7249ms
2025-08-12 11:19:09.193 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 11:19:09.193 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:09.194 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:19:09.199 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:09.200 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 11:19:09.200 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:19:09.201 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 11:19:09.201 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 7.6147 ms
2025-08-12 11:19:09.201 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 8.2214ms
2025-08-12 11:19:09.207 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=RMsax0aSY5H8BG3bVl0jVw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 11:19:09.207 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:09.207 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 11:19:09.226 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 11:19:10.855 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:19:11.059 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 11:19:11.086 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:11.151 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 1916.874ms
2025-08-12 11:19:11.151 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:19:11.151 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 1951.9176 ms
2025-08-12 11:19:11.169 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 1974.9005ms
2025-08-12 11:19:12.430 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - null null
2025-08-12 11:19:12.431 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:12.431 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 204 null null 1.0093ms
2025-08-12 11:19:12.436 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - application/json null
2025-08-12 11:19:12.437 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:12.438 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:19:12.445 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:19:12.445 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:12.446 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5874ms
2025-08-12 11:19:12.447 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:19:12.450 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:19:12.452 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:12.453 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:12.462 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:19:12.524 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:19:12.524 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:19:12.561 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:19:12.628 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 11:19:12.639 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:12.656 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 209.1407ms
2025-08-12 11:19:12.657 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:19:12.657 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0 responded 200 in 219.2132 ms
2025-08-12 11:19:12.658 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 200 null application/json; charset=utf-8 221.6931ms
2025-08-12 11:19:12.703 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:12.706 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 244.2147ms
2025-08-12 11:19:12.706 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:12.706 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 253.9349 ms
2025-08-12 11:19:12.707 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 256.2135ms
2025-08-12 11:19:13.546 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 11:19:13.547 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:13.547 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.8955ms
2025-08-12 11:19:13.551 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 11:19:13.551 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:13.552 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:19:13.552 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:19:13.572 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:19:13.580 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 11:19:13.581 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:13.581 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 29.1984ms
2025-08-12 11:19:13.581 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:19:13.582 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 30.0759 ms
2025-08-12 11:19:13.582 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 30.7506ms
2025-08-12 11:19:14.981 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:19:14.981 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:14.983 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:14.983 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:19:14.988 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:19:14.991 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:19:14.994 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:14.994 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 10.9251ms
2025-08-12 11:19:14.994 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:14.994 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 12.8635 ms
2025-08-12 11:19:14.995 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 13.7896ms
2025-08-12 11:19:16.239 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 11:19:16.239 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:16.240 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.7141ms
2025-08-12 11:19:16.264 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 11:19:16.265 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:16.266 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:19:16.273 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 11:19:16.293 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:19:16.326 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:16.329 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 55.6919ms
2025-08-12 11:19:16.329 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:19:16.329 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 64.1056 ms
2025-08-12 11:19:16.329 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 64.8879ms
2025-08-12 11:19:17.591 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:19:17.591 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:17.592 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.8866ms
2025-08-12 11:19:17.648 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:19:17.648 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:17.649 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:17.650 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:19:17.656 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:19:17.658 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:19:17.659 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:17.659 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 9.5207ms
2025-08-12 11:19:17.659 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:17.659 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 10.7424 ms
2025-08-12 11:19:17.660 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 11.8861ms
2025-08-12 11:19:20.600 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 11:19:20.601 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 11393.6284 ms
2025-08-12 11:19:20.601 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=RMsax0aSY5H8BG3bVl0jVw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 11394.0817ms
2025-08-12 11:19:20.679 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 11:19:20.679 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:20.680 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:19:20.680 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 11:19:20.683 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:19:20.684 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:20.684 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 4.1979ms
2025-08-12 11:19:20.684 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:19:20.684 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 4.8944 ms
2025-08-12 11:19:20.684 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 5.4776ms
2025-08-12 11:19:46.696 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - null null
2025-08-12 11:19:46.696 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:46.697 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - 204 null null 0.4774ms
2025-08-12 11:19:46.702 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Add - application/json 200
2025-08-12 11:19:46.702 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:46.703 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:19:46.711 +03:00 [INF] Route matched with {action = "Add", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddAsync(Application.Commands.Users.AddUser.AddUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:19:46.957 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [ActionBy], [ConnectId], [Email], [FirstName], [IsAdmin], [IsDeleted], [LastActionDate], [LastName], [Metadata], [Password], [ProfileImageUrl], [Username], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-08-12 11:19:46.985 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:46.986 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI) in 275.0394ms
2025-08-12 11:19:46.987 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:19:46.987 +03:00 [INF] HTTP POST /api/Users/Add responded 200 in 283.9890 ms
2025-08-12 11:19:46.987 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Add - 200 null application/json; charset=utf-8 284.6898ms
2025-08-12 11:19:47.015 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:19:47.015 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:47.016 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.4524ms
2025-08-12 11:19:47.028 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:19:47.029 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:19:47.030 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:47.030 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:19:47.039 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:19:47.046 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:19:47.048 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:19:47.048 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 17.7092ms
2025-08-12 11:19:47.048 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:19:47.048 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 19.1328 ms
2025-08-12 11:19:47.048 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 19.982ms
2025-08-12 11:20:29.211 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 11:20:29.472 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 11:20:29.472 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 11:20:29.473 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 11:20:29.474 +03:00 [INF] Hosting environment: Development
2025-08-12 11:20:29.474 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 11:20:30.418 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 11:20:30.649 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 243.8423ms
2025-08-12 11:20:30.705 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 11:20:30.705 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 11:20:30.714 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 9.8706ms
2025-08-12 11:20:30.779 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 74.7025ms
2025-08-12 11:20:31.095 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 11:20:31.214 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 119.6011ms
2025-08-12 11:20:47.382 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:20:47.382 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:20:47.394 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:20:47.394 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:20:47.398 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 16.6773ms
2025-08-12 11:20:47.398 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 16.6685ms
2025-08-12 11:20:47.403 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:20:47.404 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:20:47.410 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:20:47.410 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:20:47.646 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:20:47.648 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:20:47.676 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 11:20:47.676 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:20:49.214 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:20:49.214 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:20:49.290 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:20:49.389 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:20:49.392 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 11:20:49.394 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:20:49.417 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 1738.2762ms
2025-08-12 11:20:49.417 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 1736.1615ms
2025-08-12 11:20:49.418 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:20:49.418 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:20:49.422 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 2003.3197 ms
2025-08-12 11:20:49.422 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 2003.3092 ms
2025-08-12 11:20:49.432 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 2029.7118ms
2025-08-12 11:20:49.432 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 2029.4348ms
2025-08-12 11:20:50.788 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:20:50.790 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:20:50.795 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:20:50.796 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:20:50.888 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:20:50.892 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:20:50.894 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:20:50.895 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 98.9492ms
2025-08-12 11:20:50.895 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:20:50.895 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 104.6698 ms
2025-08-12 11:20:50.895 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 107.3166ms
2025-08-12 11:20:56.114 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 11:20:56.115 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:20:56.115 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 1.6338ms
2025-08-12 11:20:56.132 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 11:20:56.132 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:20:56.134 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:20:56.140 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 11:20:56.161 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:20:56.203 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:20:56.207 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 66.6408ms
2025-08-12 11:20:56.207 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:20:56.207 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 75.0962 ms
2025-08-12 11:20:56.208 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 76.4016ms
2025-08-12 11:21:08.956 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - null null
2025-08-12 11:21:08.958 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:21:08.958 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - 204 null null 2.1658ms
2025-08-12 11:21:08.964 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Add - application/json 200
2025-08-12 11:21:08.966 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:21:08.966 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:21:08.975 +03:00 [INF] Route matched with {action = "Add", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddAsync(Application.Commands.Users.AddUser.AddUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:22:35.569 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [ActionBy], [ConnectId], [Email], [FirstName], [IsAdmin], [IsDeleted], [LastActionDate], [LastName], [Metadata], [Password], [ProfileImageUrl], [Username], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-08-12 11:22:35.606 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:22:35.608 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI) in 86632.177ms
2025-08-12 11:22:35.608 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:22:35.608 +03:00 [INF] HTTP POST /api/Users/Add responded 200 in 86641.9331 ms
2025-08-12 11:22:35.608 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Add - 200 null application/json; charset=utf-8 86644.2774ms
2025-08-12 11:22:35.667 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:22:35.668 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:22:35.668 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 1.2965ms
2025-08-12 11:22:35.672 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:22:35.673 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:22:35.674 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:22:35.674 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:22:35.686 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:22:35.694 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:22:35.696 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:22:35.696 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 22.0733ms
2025-08-12 11:22:35.696 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:22:35.696 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 23.0646 ms
2025-08-12 11:22:35.696 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 24.3872ms
2025-08-12 11:23:05.681 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 11:23:05.789 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 11:23:05.790 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 11:23:05.791 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 11:23:05.792 +03:00 [INF] Hosting environment: Development
2025-08-12 11:23:05.792 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 11:23:06.113 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 11:23:06.268 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 157.1704ms
2025-08-12 11:23:06.312 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 11:23:06.312 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 11:23:06.316 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 4.2899ms
2025-08-12 11:23:06.349 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.3436ms
2025-08-12 11:23:06.599 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 11:23:06.723 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 124.7165ms
2025-08-12 11:23:13.554 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Delete?UserId=33961c6b-046d-4819-95ff-fb40eb384de3 - null null
2025-08-12 11:23:13.563 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:13.565 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Delete?UserId=33961c6b-046d-4819-95ff-fb40eb384de3 - 204 null null 11.0168ms
2025-08-12 11:23:13.569 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7003/api/Users/Delete?UserId=33961c6b-046d-4819-95ff-fb40eb384de3 - application/json null
2025-08-12 11:23:13.576 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:13.691 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI)'
2025-08-12 11:23:13.732 +03:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteAsync(Application.Commands.Users.DeleteUser.DeleteUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:23:14.752 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:23:14.939 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p13='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [ActionBy] = @p0, [ConnectId] = @p1, [Email] = @p2, [FirstName] = @p3, [IsAdmin] = @p4, [IsDeleted] = @p5, [LastActionDate] = @p6, [LastName] = @p7, [Metadata] = @p8, [Password] = @p9, [ProfileImageUrl] = @p10, [Username] = @p11, [WorkspaceId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
2025-08-12 11:23:14.959 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:23:14.977 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI) in 1242.739ms
2025-08-12 11:23:14.978 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI)'
2025-08-12 11:23:14.980 +03:00 [INF] HTTP DELETE /api/Users/Delete responded 200 in 1397.0546 ms
2025-08-12 11:23:14.986 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7003/api/Users/Delete?UserId=33961c6b-046d-4819-95ff-fb40eb384de3 - 200 null application/json; charset=utf-8 1416.5832ms
2025-08-12 11:23:17.992 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:23:17.992 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:17.993 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 1.11ms
2025-08-12 11:23:18.012 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:23:18.012 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:18.016 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:23:18.025 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:23:18.120 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:23:18.147 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:23:18.172 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:23:18.178 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 152.6138ms
2025-08-12 11:23:18.179 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:23:18.179 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 166.2137 ms
2025-08-12 11:23:18.179 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 167.512ms
2025-08-12 11:23:22.130 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 11:23:22.130 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:22.130 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.7788ms
2025-08-12 11:23:22.135 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 11:23:22.135 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:22.139 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:23:22.145 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 11:23:22.186 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:23:22.217 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:23:22.227 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 81.8219ms
2025-08-12 11:23:22.227 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 11:23:22.227 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 91.8911 ms
2025-08-12 11:23:22.227 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 92.5554ms
2025-08-12 11:23:32.003 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - null null
2025-08-12 11:23:32.004 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:32.004 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Add - 204 null null 0.4409ms
2025-08-12 11:23:32.006 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Add - application/json 200
2025-08-12 11:23:32.006 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:32.007 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:23:32.011 +03:00 [INF] Route matched with {action = "Add", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddAsync(Application.Commands.Users.AddUser.AddUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:23:32.071 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [ActionBy], [ConnectId], [Email], [FirstName], [IsAdmin], [IsDeleted], [LastActionDate], [LastName], [Metadata], [Password], [ProfileImageUrl], [Username], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-08-12 11:23:32.078 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:23:32.079 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI) in 68.1211ms
2025-08-12 11:23:32.079 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.AddAsync (ChatSystem.UI)'
2025-08-12 11:23:32.079 +03:00 [INF] HTTP POST /api/Users/Add responded 200 in 72.6576 ms
2025-08-12 11:23:32.079 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Add - 200 null application/json; charset=utf-8 73.1164ms
2025-08-12 11:23:32.100 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:23:32.100 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:32.100 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5798ms
2025-08-12 11:23:32.147 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:23:32.148 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:23:32.149 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:23:32.149 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:23:32.162 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:23:32.166 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:23:32.168 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:23:32.169 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 19.6739ms
2025-08-12 11:23:32.169 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:23:32.169 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 21.2809 ms
2025-08-12 11:23:32.170 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 22.6403ms
2025-08-12 11:24:25.543 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Delete?UserId=35de4175-e110-4a83-860a-ae791f1eb225 - null null
2025-08-12 11:24:25.543 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:25.544 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Delete?UserId=35de4175-e110-4a83-860a-ae791f1eb225 - 204 null null 0.6094ms
2025-08-12 11:24:25.550 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7003/api/Users/Delete?UserId=35de4175-e110-4a83-860a-ae791f1eb225 - application/json null
2025-08-12 11:24:25.550 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:25.551 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI)'
2025-08-12 11:24:25.551 +03:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteAsync(Application.Commands.Users.DeleteUser.DeleteUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:24:25.566 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:24:25.580 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p13='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [ActionBy] = @p0, [ConnectId] = @p1, [Email] = @p2, [FirstName] = @p3, [IsAdmin] = @p4, [IsDeleted] = @p5, [LastActionDate] = @p6, [LastName] = @p7, [Metadata] = @p8, [Password] = @p9, [ProfileImageUrl] = @p10, [Username] = @p11, [WorkspaceId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
2025-08-12 11:24:25.581 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:24:25.581 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI) in 30.496ms
2025-08-12 11:24:25.581 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI)'
2025-08-12 11:24:25.582 +03:00 [INF] HTTP DELETE /api/Users/Delete responded 200 in 31.5384 ms
2025-08-12 11:24:25.582 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7003/api/Users/Delete?UserId=35de4175-e110-4a83-860a-ae791f1eb225 - 200 null application/json; charset=utf-8 32.2686ms
2025-08-12 11:24:27.637 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:24:27.638 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:27.638 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.885ms
2025-08-12 11:24:27.651 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:24:27.651 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:27.652 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:24:27.652 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:24:27.662 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:24:27.668 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:24:27.669 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:24:27.670 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 17.2948ms
2025-08-12 11:24:27.670 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:24:27.670 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 18.6593 ms
2025-08-12 11:24:27.670 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 19.4167ms
2025-08-12 11:24:43.919 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Delete?UserId=c6a26931-a65f-45df-88a0-a1513302c8d7 - null null
2025-08-12 11:24:43.919 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:43.920 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Delete?UserId=c6a26931-a65f-45df-88a0-a1513302c8d7 - 204 null null 0.3657ms
2025-08-12 11:24:43.923 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7003/api/Users/Delete?UserId=c6a26931-a65f-45df-88a0-a1513302c8d7 - application/json null
2025-08-12 11:24:43.923 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:43.924 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI)'
2025-08-12 11:24:43.924 +03:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteAsync(Application.Commands.Users.DeleteUser.DeleteUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:24:43.930 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2025-08-12 11:24:43.938 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p13='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [ActionBy] = @p0, [ConnectId] = @p1, [Email] = @p2, [FirstName] = @p3, [IsAdmin] = @p4, [IsDeleted] = @p5, [LastActionDate] = @p6, [LastName] = @p7, [Metadata] = @p8, [Password] = @p9, [ProfileImageUrl] = @p10, [Username] = @p11, [WorkspaceId] = @p12
OUTPUT 1
WHERE [Id] = @p13;
2025-08-12 11:24:43.939 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:24:43.939 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI) in 14.1944ms
2025-08-12 11:24:43.939 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.DeleteAsync (ChatSystem.UI)'
2025-08-12 11:24:43.939 +03:00 [INF] HTTP DELETE /api/Users/Delete responded 200 in 15.4419 ms
2025-08-12 11:24:43.939 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7003/api/Users/Delete?UserId=c6a26931-a65f-45df-88a0-a1513302c8d7 - 200 null application/json; charset=utf-8 16.0242ms
2025-08-12 11:24:52.768 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:24:52.768 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:52.768 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3412ms
2025-08-12 11:24:52.787 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:24:52.788 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:52.788 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:24:52.788 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:24:52.792 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:24:52.793 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:24:52.794 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:24:52.795 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 6.3096ms
2025-08-12 11:24:52.795 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:24:52.795 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 7.0233 ms
2025-08-12 11:24:52.795 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 7.6605ms
2025-08-12 11:24:58.904 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:24:58.904 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:58.904 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.451ms
2025-08-12 11:24:58.911 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 11:24:58.911 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:58.912 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 1.0393ms
2025-08-12 11:24:58.922 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:24:58.925 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:58.933 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:24:58.939 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 11:24:58.945 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 11:24:58.945 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:58.949 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 11:24:58.955 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 11:24:58.955 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 9.9717 ms
2025-08-12 11:24:58.955 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 10.5225ms
2025-08-12 11:24:58.960 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:24:58.961 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=83frxsVcIdnOw-lT-fzIRQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - null null
2025-08-12 11:24:58.962 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:58.965 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 11:24:59.134 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 11:24:59.135 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:24:59.141 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 201.8071ms
2025-08-12 11:24:59.141 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 11:24:59.141 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 215.8036 ms
2025-08-12 11:24:59.141 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 219.4394ms
2025-08-12 11:24:59.848 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - null null
2025-08-12 11:24:59.849 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:59.849 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 204 null null 0.3944ms
2025-08-12 11:24:59.852 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - application/json null
2025-08-12 11:24:59.853 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:59.854 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:24:59.854 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 11:24:59.854 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:59.854 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2479ms
2025-08-12 11:24:59.857 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 11:24:59.857 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:24:59.858 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:24:59.858 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 11:24:59.860 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:24:59.861 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:24:59.862 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 11:24:59.863 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:24:59.863 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 4.7485ms
2025-08-12 11:24:59.863 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 11:24:59.863 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 5.6117 ms
2025-08-12 11:24:59.863 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.4212ms
2025-08-12 11:24:59.878 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:24:59.989 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 11:24:59.993 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:24:59.999 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 139.5709ms
2025-08-12 11:25:00.000 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:25:00.000 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0 responded 200 in 146.4251 ms
2025-08-12 11:25:00.000 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 200 null application/json; charset=utf-8 148.138ms
2025-08-12 11:25:01.097 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 11:25:01.097 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:25:01.098 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.424ms
2025-08-12 11:25:01.102 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 11:25:01.102 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:25:01.103 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:25:01.103 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:25:01.117 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 11:25:01.184 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 11:25:01.185 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:25:01.185 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 81.6957ms
2025-08-12 11:25:01.185 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 11:25:01.185 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 82.7962 ms
2025-08-12 11:25:01.185 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 83.3994ms
2025-08-12 11:25:02.999 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 11:25:02.999 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:25:02.999 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3798ms
2025-08-12 11:25:03.001 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 124
2025-08-12 11:25:03.002 +03:00 [INF] CORS policy execution successful.
2025-08-12 11:25:03.002 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 11:25:03.009 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 11:25:03.058 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 11:25:03.111 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 11:25:03.252 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p27='?' (DbType = Guid), @p25='?' (DbType = Guid), @p26='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [ActionBy] = @p25, [LastActionDate] = @p26
OUTPUT 1
WHERE [Id] = @p27;
2025-08-12 11:25:03.272 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 11:25:03.272 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 263.3163ms
2025-08-12 11:25:03.272 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 11:25:03.272 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 270.6268 ms
2025-08-12 11:25:03.272 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 271.1214ms
2025-08-12 21:08:32.211 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 21:08:32.235 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 35013268.8086 ms
2025-08-12 21:08:32.280 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=83frxsVcIdnOw-lT-fzIRQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTQ5ODc5NjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.zZyt54aa-8FcjIrLQmTttK9CTJQs3ugfmYhTosRhUm8 - 200 null null 35013309.8677ms
2025-08-12 21:08:32.356 +03:00 [INF] Connection id "0HNEPF5R839E5", Request id "0HNEPF5R839E5:00000003": the application completed without reading the entire request body.
2025-08-12 21:59:27.951 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 21:59:27.968 +03:00 [INF] CORS policy execution successful.
2025-08-12 21:59:27.982 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 32.1883ms
2025-08-12 21:59:28.003 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 21:59:28.009 +03:00 [INF] CORS policy execution successful.
2025-08-12 21:59:28.083 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/12/2025 8:39:21 AM', Current time (UTC): '8/12/2025 6:59:28 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-12 21:59:28.212 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/12/2025 8:39:21 AM', Current time (UTC): '8/12/2025 6:59:28 PM'.
2025-08-12 21:59:28.242 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-12 21:59:28.275 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-12 21:59:28.276 +03:00 [INF] HTTP POST /chathub/negotiate responded 401 in 260.3213 ms
2025-08-12 21:59:28.277 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 401 0 null 273.8494ms
2025-08-12 21:59:44.911 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 21:59:44.911 +03:00 [INF] CORS policy execution successful.
2025-08-12 21:59:44.912 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 1.2938ms
2025-08-12 21:59:44.925 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 21:59:44.925 +03:00 [INF] CORS policy execution successful.
2025-08-12 21:59:44.927 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/12/2025 8:39:21 AM', Current time (UTC): '8/12/2025 6:59:44 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-12 21:59:44.929 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/12/2025 8:39:21 AM', Current time (UTC): '8/12/2025 6:59:44 PM'.
2025-08-12 21:59:44.929 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-12 21:59:44.930 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-12 21:59:44.930 +03:00 [INF] HTTP POST /chathub/negotiate responded 401 in 4.8451 ms
2025-08-12 21:59:44.930 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 401 0 null 5.6543ms
2025-08-12 22:00:18.393 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:00:18.393 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:00:18.393 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.4704ms
2025-08-12 22:00:18.399 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:00:18.399 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:00:18.400 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/12/2025 8:39:21 AM', Current time (UTC): '8/12/2025 7:00:18 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-08-12 22:00:18.401 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '8/12/2025 8:39:21 AM', Current time (UTC): '8/12/2025 7:00:18 PM'.
2025-08-12 22:00:18.402 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-12 22:00:18.402 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-12 22:00:18.402 +03:00 [INF] HTTP POST /chathub/negotiate responded 401 in 3.0440 ms
2025-08-12 22:00:18.403 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 401 0 null 3.6143ms
2025-08-12 22:06:30.063 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 22:06:30.065 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:30.066 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 3.5446ms
2025-08-12 22:06:30.071 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 35
2025-08-12 22:06:30.079 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:30.087 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:06:30.191 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:06:30.480 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 22:06:30.490 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 22:06:30.504 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 312.4903ms
2025-08-12 22:06:30.504 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:06:30.504 +03:00 [INF] HTTP POST /api/Users/Login responded 400 in 424.0826 ms
2025-08-12 22:06:30.505 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 400 null application/json; charset=utf-8 433.7227ms
2025-08-12 22:06:34.787 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 35
2025-08-12 22:06:34.787 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:34.788 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:06:34.788 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:06:34.800 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 22:06:34.818 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 22:06:34.824 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 35.8701ms
2025-08-12 22:06:34.824 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:06:34.824 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 36.5576 ms
2025-08-12 22:06:34.824 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 37.2174ms
2025-08-12 22:06:34.995 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:06:34.995 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:34.995 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.2152ms
2025-08-12 22:06:35.016 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 22:06:35.017 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:35.018 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 1.7574ms
2025-08-12 22:06:35.047 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:06:35.048 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:35.048 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.954ms
2025-08-12 22:06:35.064 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 22:06:35.064 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:06:35.064 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:35.065 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:35.070 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:06:35.070 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:06:35.072 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:06:35.073 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:35.075 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:35.075 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:06:35.075 +03:00 [INF] HTTP GET /api/Users responded 404 in 1.7545 ms
2025-08-12 22:06:35.076 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 11.4327ms
2025-08-12 22:06:35.082 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 22:06:35.091 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:06:35.092 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:35.093 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 22.357ms
2025-08-12 22:06:35.093 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:06:35.093 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 25.6918 ms
2025-08-12 22:06:35.093 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 28.9418ms
2025-08-12 22:06:35.093 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:35.116 +03:00 [ERR] An error occurred using the connection to database 'AmanahChatDB' on server 'YZN\SQLEXPRESS'.
2025-08-12 22:06:35.131 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:35.136 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 60.6607ms
2025-08-12 22:06:35.136 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:35.136 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 63.2928 ms
2025-08-12 22:06:35.136 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 64.1559ms
2025-08-12 22:06:37.210 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:06:37.210 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:37.211 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:37.212 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:06:37.227 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:37.257 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:06:37.257 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:37.257 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.4197ms
2025-08-12 22:06:37.299 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:06:37.299 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:37.301 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:06:37.310 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:06:37.311 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:37.311 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:06:37.312 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 11.9553 ms
2025-08-12 22:06:37.312 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 99.9674ms
2025-08-12 22:06:37.312 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 12.414ms
2025-08-12 22:06:37.312 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:37.312 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 101.3557 ms
2025-08-12 22:06:37.312 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 102.1584ms
2025-08-12 22:06:37.331 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=VTAUsvdQTKd-WXqrxqm6pw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:06:37.331 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:37.332 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:06:40.235 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - null null
2025-08-12 22:06:40.235 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:40.235 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 204 null null 0.2912ms
2025-08-12 22:06:40.242 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:06:40.242 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:40.242 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2711ms
2025-08-12 22:06:40.259 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:06:40.260 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - application/json null
2025-08-12 22:06:40.260 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:40.260 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:40.261 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:06:40.262 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:06:40.265 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:06:40.270 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:06:40.282 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:40.285 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:40.296 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:06:40.298 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:40.299 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 36.4391ms
2025-08-12 22:06:40.299 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:06:40.299 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 38.7468 ms
2025-08-12 22:06:40.300 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 40.2532ms
2025-08-12 22:06:40.410 +03:00 [INF] Executed DbCommand (116ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:06:40.410 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:40.411 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 140.6093ms
2025-08-12 22:06:40.411 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:06:40.411 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0 responded 200 in 150.6606 ms
2025-08-12 22:06:40.412 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/5925da4b-49fd-4815-bbd2-00d7108957b0?page=1&pageSize=50 - 200 null application/json; charset=utf-8 151.9946ms
2025-08-12 22:06:41.640 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5925da4b-49fd-4815-bbd2-00d7108957b0&pageNumber=1&pageSize=50 - null null
2025-08-12 22:06:41.640 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:41.649 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5925da4b-49fd-4815-bbd2-00d7108957b0&pageNumber=1&pageSize=50 - application/json null
2025-08-12 22:06:41.650 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:41.651 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 22:06:41.663 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5925da4b-49fd-4815-bbd2-00d7108957b0&pageNumber=1&pageSize=50 - 204 null null 0.3556ms
2025-08-12 22:06:41.673 +03:00 [INF] Route matched with {action = "GetUsersByChatRoom", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByChatRoom(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:06:41.699 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:41.744 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0
2025-08-12 22:06:41.756 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:41.757 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI) in 83.8013ms
2025-08-12 22:06:41.757 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 22:06:41.757 +03:00 [INF] HTTP GET /api/Users/GetUsersByChatRoom responded 200 in 107.5819 ms
2025-08-12 22:06:41.758 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=5925da4b-49fd-4815-bbd2-00d7108957b0&pageNumber=1&pageSize=50 - 200 null application/json; charset=utf-8 108.6066ms
2025-08-12 22:06:50.949 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/RemoveMembers - null null
2025-08-12 22:06:50.949 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:50.949 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/RemoveMembers - 204 null null 0.3716ms
2025-08-12 22:06:50.957 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7003/api/ChatRooms/RemoveMembers - application/json 101
2025-08-12 22:06:50.957 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:50.958 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI)'
2025-08-12 22:06:50.972 +03:00 [INF] Route matched with {action = "AddMember", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddMemberAsync(Application.Commands.ChatRooms.RemoveRoomMember.RemoveRoomMemberRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:06:50.995 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:51.000 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:51.025 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid), @__request_UserId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
FROM [RoomMembers] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0 AND [r].[UserId] = @__request_UserId_1
2025-08-12 22:06:51.048 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (DbType = Boolean), @p2='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [RoomMembers] SET [ActionBy] = @p0, [IsDeleted] = @p1, [LastActionDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2025-08-12 22:06:51.049 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:51.050 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI) in 76.9069ms
2025-08-12 22:06:51.050 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.AddMemberAsync (ChatSystem.UI)'
2025-08-12 22:06:51.050 +03:00 [INF] HTTP DELETE /api/ChatRooms/RemoveMembers responded 200 in 92.5154 ms
2025-08-12 22:06:51.050 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7003/api/ChatRooms/RemoveMembers - 200 null application/json; charset=utf-8 93.0848ms
2025-08-12 22:06:51.063 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:06:51.064 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:51.064 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.5323ms
2025-08-12 22:06:51.069 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:06:51.070 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:51.070 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:51.071 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:06:51.084 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:51.136 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:06:51.136 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:51.138 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 66.9703ms
2025-08-12 22:06:51.138 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:51.138 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 68.5334 ms
2025-08-12 22:06:51.139 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 69.8645ms
2025-08-12 22:06:53.142 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:06:53.142 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 15810.4076 ms
2025-08-12 22:06:53.142 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=VTAUsvdQTKd-WXqrxqm6pw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 15811.0435ms
2025-08-12 22:06:53.407 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:06:53.407 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:53.409 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:53.409 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:06:53.418 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:53.436 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:06:53.437 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:53.437 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.5603ms
2025-08-12 22:06:53.461 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:06:53.461 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:53.462 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 52.5657ms
2025-08-12 22:06:53.462 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:53.462 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 54.2676 ms
2025-08-12 22:06:53.462 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 55.0446ms
2025-08-12 22:06:53.479 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:06:53.479 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:53.480 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:06:53.481 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:06:53.481 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.5156 ms
2025-08-12 22:06:53.481 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 2.2753ms
2025-08-12 22:06:53.495 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=OL2WAk1do5kd7IiI8rT8eA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:06:53.495 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:53.496 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:06:56.718 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:06:56.718 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:56.718 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.4402ms
2025-08-12 22:06:56.770 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:06:56.771 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:56.771 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:06:56.772 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:06:56.781 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:56.791 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:06:56.793 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:56.793 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 21.1977ms
2025-08-12 22:06:56.793 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:06:56.793 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 22.3584 ms
2025-08-12 22:06:56.794 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 23.1864ms
2025-08-12 22:06:59.164 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 22:06:59.164 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:59.164 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.3164ms
2025-08-12 22:06:59.167 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 152
2025-08-12 22:06:59.167 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:59.168 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 22:06:59.176 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 22:06:59.192 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:59.192 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 16.0752ms
2025-08-12 22:06:59.193 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 22:06:59.193 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 25.4627 ms
2025-08-12 22:06:59.193 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 26.1924ms
2025-08-12 22:06:59.226 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:06:59.226 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:59.227 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.5575ms
2025-08-12 22:06:59.301 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:06:59.301 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:06:59.302 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:59.302 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:06:59.311 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:06:59.355 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:06:59.356 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:06:59.356 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 54.0331ms
2025-08-12 22:06:59.356 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:06:59.356 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 54.7080 ms
2025-08-12 22:06:59.356 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 55.1455ms
2025-08-12 22:07:05.439 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:07:05.439 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:05.440 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 1.1213ms
2025-08-12 22:07:05.505 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:07:05.505 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:05.506 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:07:05.507 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:07:05.520 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:07:05.521 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:05.521 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 14.5847ms
2025-08-12 22:07:05.522 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:07:05.522 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 16.3681 ms
2025-08-12 22:07:05.522 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 17.1688ms
2025-08-12 22:07:07.207 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:07:07.207 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:07.208 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:07:07.208 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:07:07.212 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 22:07:07.212 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:07.212 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.3091ms
2025-08-12 22:07:07.227 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:07:07.228 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:07.229 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 20.656ms
2025-08-12 22:07:07.229 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:07:07.229 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 21.3732 ms
2025-08-12 22:07:07.229 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 22.058ms
2025-08-12 22:07:07.232 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:07:07.233 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:07.233 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3437ms
2025-08-12 22:07:07.290 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 22:07:07.290 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:07.291 +03:00 [INF] HTTP GET /api/Users responded 404 in 0.3823 ms
2025-08-12 22:07:07.291 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 1.3315ms
2025-08-12 22:07:07.291 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 22:07:07.295 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:07:07.296 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:07.297 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:07.297 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:07:07.315 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:07:07.327 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:07.328 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 30.6642ms
2025-08-12 22:07:07.328 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:07.328 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 32.1453 ms
2025-08-12 22:07:07.328 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 32.8892ms
2025-08-12 22:07:08.116 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:07:08.117 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:08.117 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:08.118 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:07:08.127 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:07:08.174 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:07:08.175 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:08.176 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 57.5057ms
2025-08-12 22:07:08.176 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:08.176 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 58.8234 ms
2025-08-12 22:07:08.176 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 59.4824ms
2025-08-12 22:07:09.745 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:07:09.745 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:09.746 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:09.746 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:07:09.759 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:07:09.764 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:07:09.764 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:09.764 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3451ms
2025-08-12 22:07:09.807 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:07:09.808 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:09.808 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 61.5092ms
2025-08-12 22:07:09.808 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:09.808 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 63.0343 ms
2025-08-12 22:07:09.808 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 63.6163ms
2025-08-12 22:07:09.838 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:07:09.838 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:09.839 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:07:09.839 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:07:09.862 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:07:09.875 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:07:09.876 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:09.877 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 37.3637ms
2025-08-12 22:07:09.877 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:07:09.878 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 38.3840 ms
2025-08-12 22:07:09.878 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 40.4472ms
2025-08-12 22:07:15.912 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:07:15.912 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:15.913 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.3904ms
2025-08-12 22:07:15.924 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 22:07:15.924 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:15.924 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.2838ms
2025-08-12 22:07:15.951 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:07:15.952 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:15.952 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.4316ms
2025-08-12 22:07:15.987 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:07:15.987 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:15.988 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:07:15.988 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:07:15.997 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 22:07:15.997 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:15.999 +03:00 [INF] HTTP GET /api/Users responded 404 in 1.1458 ms
2025-08-12 22:07:15.999 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 2.2119ms
2025-08-12 22:07:15.999 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 22:07:16.003 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:07:16.003 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:16.004 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 15.7493ms
2025-08-12 22:07:16.004 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:07:16.004 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 16.5222 ms
2025-08-12 22:07:16.004 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 17.1326ms
2025-08-12 22:07:16.005 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:07:16.005 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:07:16.006 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:16.006 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:07:16.108 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:07:16.111 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 104.7545ms
2025-08-12 22:07:16.111 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:07:16.111 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 105.9149 ms
2025-08-12 22:07:16.111 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 106.4438ms
2025-08-12 22:07:28.895 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 22:07:28.899 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 4.3089ms
2025-08-12 22:07:29.769 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 22:07:29.771 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 1.478ms
2025-08-12 22:10:24.795 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:10:24.796 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 211300.3977 ms
2025-08-12 22:10:24.797 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=OL2WAk1do5kd7IiI8rT8eA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 211301.7816ms
2025-08-12 22:10:25.094 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:10:25.095 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 22:10:25.095 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:25.095 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:25.095 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.8448ms
2025-08-12 22:10:25.095 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.702ms
2025-08-12 22:10:25.119 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:10:25.119 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:25.119 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3053ms
2025-08-12 22:10:25.137 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:10:25.137 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:10:25.137 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:25.137 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:25.138 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 22:10:25.138 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:25.140 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:10:25.140 +03:00 [INF] HTTP GET /api/Users responded 404 in 2.5613 ms
2025-08-12 22:10:25.141 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 3.0284ms
2025-08-12 22:10:25.141 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:10:25.141 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:10:25.141 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 22:10:25.141 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:10:25.159 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:10:25.161 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:10:25.164 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 22.3462ms
2025-08-12 22:10:25.164 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:10:25.164 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 25.9370 ms
2025-08-12 22:10:25.164 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 499 null application/json; charset=utf-8 26.8312ms
2025-08-12 22:10:25.167 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:10:25.169 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 27.6185ms
2025-08-12 22:10:25.169 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:10:25.169 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 31.1985 ms
2025-08-12 22:10:25.169 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 31.999ms
2025-08-12 22:10:37.883 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:10:37.883 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:37.884 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.4233ms
2025-08-12 22:10:37.917 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:10:37.917 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:37.917 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.4001ms
2025-08-12 22:10:37.955 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:10:37.955 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:37.956 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:10:37.956 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:10:37.960 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:10:37.960 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:37.961 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:10:37.962 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:10:37.962 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.3828 ms
2025-08-12 22:10:37.962 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.825ms
2025-08-12 22:10:37.974 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:10:37.977 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=3qfEwL-MYFrx2AuKjK5Kww&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:10:37.977 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:10:37.978 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:10:38.026 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:10:38.027 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:10:38.027 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 70.8251ms
2025-08-12 22:10:38.027 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:10:38.027 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 71.7098 ms
2025-08-12 22:10:38.027 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 72.2946ms
2025-08-12 22:11:19.112 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 22:11:19.112 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:19.112 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 0.2234ms
2025-08-12 22:11:19.114 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 41
2025-08-12 22:11:19.114 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:19.115 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:11:19.115 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:11:19.128 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 22:11:19.129 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 22:11:19.129 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 13.9818ms
2025-08-12 22:11:19.129 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:11:19.129 +03:00 [INF] HTTP POST /api/Users/Login responded 400 in 15.0764 ms
2025-08-12 22:11:19.129 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 400 null application/json; charset=utf-8 15.5769ms
2025-08-12 22:11:23.574 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:11:23.575 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:23.575 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3775ms
2025-08-12 22:11:23.589 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:11:23.589 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:23.589 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.357ms
2025-08-12 22:11:23.638 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:11:23.638 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:23.639 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:11:23.639 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:11:23.646 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:11:23.646 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:23.646 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:11:23.646 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:11:23.649 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:11:23.653 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:11:23.662 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:11:23.663 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:11:23.663 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 16.607ms
2025-08-12 22:11:23.663 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:11:23.664 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 17.9299 ms
2025-08-12 22:11:23.664 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 18.3714ms
2025-08-12 22:11:23.702 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:11:23.702 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:11:23.702 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 63.0326ms
2025-08-12 22:11:23.702 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:11:23.702 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 64.2936 ms
2025-08-12 22:11:23.703 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 64.9825ms
2025-08-12 22:11:29.823 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:11:29.824 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:29.824 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3376ms
2025-08-12 22:11:29.894 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:11:29.894 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:29.895 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:11:29.895 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:11:29.904 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:11:29.951 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:11:29.952 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:11:29.952 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 57.2764ms
2025-08-12 22:11:29.952 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:11:29.952 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 58.3639 ms
2025-08-12 22:11:29.953 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 58.8516ms
2025-08-12 22:11:31.347 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:11:31.347 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:31.347 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.6657ms
2025-08-12 22:11:31.353 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:11:31.353 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:31.354 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:11:31.354 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:11:31.361 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:11:31.362 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:11:31.362 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:31.362 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.1889ms
2025-08-12 22:11:31.365 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:11:31.366 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:31.366 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:11:31.366 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:11:31.377 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:11:31.384 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:11:31.384 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:11:31.384 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 18.0495ms
2025-08-12 22:11:31.384 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:11:31.384 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 18.7379 ms
2025-08-12 22:11:31.384 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 19.1183ms
2025-08-12 22:11:31.445 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:11:31.446 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:11:31.446 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 92.0828ms
2025-08-12 22:11:31.446 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:11:31.446 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 93.0155 ms
2025-08-12 22:11:31.446 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 93.8817ms
2025-08-12 22:11:32.402 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - null null
2025-08-12 22:11:32.402 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:32.403 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - 204 null null 0.6784ms
2025-08-12 22:11:32.405 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - application/json null
2025-08-12 22:11:32.405 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:11:32.406 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 22:11:32.406 +03:00 [INF] Route matched with {action = "GetUsersByChatRoom", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByChatRoom(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:11:32.418 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:11:32.428 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ChatRoomId] = @__request_ChatRoomId_0
2025-08-12 22:11:32.431 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:11:32.431 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI) in 25.0907ms
2025-08-12 22:11:32.431 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByChatRoom (ChatSystem.UI)'
2025-08-12 22:11:32.431 +03:00 [INF] HTTP GET /api/Users/GetUsersByChatRoom responded 200 in 25.6037 ms
2025-08-12 22:11:32.431 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByChatRoom?chatRoomId=0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99&pageNumber=1&pageSize=50 - 200 null application/json; charset=utf-8 26.0982ms
2025-08-12 22:12:01.305 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 22:12:01.305 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.305 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 0.4666ms
2025-08-12 22:12:01.307 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 41
2025-08-12 22:12:01.308 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.308 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:12:01.308 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:12:01.319 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 22:12:01.322 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 22:12:01.322 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 14.358ms
2025-08-12 22:12:01.322 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 22:12:01.322 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 14.7887 ms
2025-08-12 22:12:01.323 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 15.6664ms
2025-08-12 22:12:01.365 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:12:01.365 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.365 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.2635ms
2025-08-12 22:12:01.365 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 22:12:01.365 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.366 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.2006ms
2025-08-12 22:12:01.366 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 22:12:01.366 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.366 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.1523ms
2025-08-12 22:12:01.369 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 22:12:01.370 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 22:12:01.369 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:12:01.370 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.370 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.370 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:01.371 +03:00 [INF] HTTP GET /api/Users responded 404 in 1.5567 ms
2025-08-12 22:12:01.372 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:12:01.372 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 2.1976ms
2025-08-12 22:12:01.372 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:12:01.372 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 22:12:01.372 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:12:01.372 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:12:01.377 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:12:01.377 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:01.378 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 5.9803ms
2025-08-12 22:12:01.378 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:12:01.378 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:12:01.379 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 8.7676 ms
2025-08-12 22:12:01.379 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 9.6224ms
2025-08-12 22:12:01.393 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:01.394 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 21.982ms
2025-08-12 22:12:01.394 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:12:01.394 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 24.0719 ms
2025-08-12 22:12:01.394 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 499 null application/json; charset=utf-8 24.5364ms
2025-08-12 22:12:10.813 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:12:10.813 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:10.814 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.2365ms
2025-08-12 22:12:10.844 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:12:10.844 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:10.847 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:12:10.847 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:12:10.854 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:12:10.953 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:12:10.954 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:10.954 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 107.3924ms
2025-08-12 22:12:10.954 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:12:10.954 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 109.7751 ms
2025-08-12 22:12:10.954 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 110.3872ms
2025-08-12 22:12:12.391 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:12:12.391 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:12.391 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2535ms
2025-08-12 22:12:12.394 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-08-12 22:12:12.394 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:12.396 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:12:12.396 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:12:12.419 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:12:12.436 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:12:12.496 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:12:12.502 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:12.502 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 105.4235ms
2025-08-12 22:12:12.502 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:12:12.502 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 108.3086 ms
2025-08-12 22:12:12.502 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 108.7797ms
2025-08-12 22:12:43.380 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 22:12:43.380 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:43.380 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.2877ms
2025-08-12 22:12:43.384 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 22:12:43.384 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:12:43.384 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:43.384 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:43.384 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.5108ms
2025-08-12 22:12:43.385 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:12:43.385 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:12:43.389 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:12:43.415 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:12:43.415 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:43.416 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 30.0727ms
2025-08-12 22:12:43.416 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:12:43.416 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 31.2997 ms
2025-08-12 22:12:43.416 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 31.9677ms
2025-08-12 22:12:43.419 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:12:43.419 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:43.420 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:12:43.420 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:12:43.420 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.6284 ms
2025-08-12 22:12:43.420 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 0.9388ms
2025-08-12 22:12:43.452 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=Hsz-iZQTpG8BxIM7zHnl3g&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - null null
2025-08-12 22:12:43.452 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:43.453 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:12:47.444 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:12:47.444 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:47.445 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.2372ms
2025-08-12 22:12:47.447 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:12:47.447 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:47.448 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:12:47.448 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:12:47.454 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:12:47.454 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:47.454 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2453ms
2025-08-12 22:12:47.457 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:12:47.458 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:12:47.458 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:47.458 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:12:47.458 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:12:47.468 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:12:47.509 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:12:47.510 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:47.510 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 51.6483ms
2025-08-12 22:12:47.510 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:12:47.510 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 52.1000 ms
2025-08-12 22:12:47.510 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 52.4511ms
2025-08-12 22:12:47.529 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:12:47.529 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:47.529 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 81.2075ms
2025-08-12 22:12:47.529 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:12:47.529 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 81.8523 ms
2025-08-12 22:12:47.529 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 82.2243ms
2025-08-12 22:12:54.975 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:12:54.975 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 136997.5300 ms
2025-08-12 22:12:54.975 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=3qfEwL-MYFrx2AuKjK5Kww&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 136997.9803ms
2025-08-12 22:12:55.744 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:12:55.744 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:12:55.744 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:55.744 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:55.744 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.1711ms
2025-08-12 22:12:55.744 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2437ms
2025-08-12 22:12:55.775 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:12:55.775 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:55.776 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:12:55.776 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:12:55.776 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.7242 ms
2025-08-12 22:12:55.776 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.1077ms
2025-08-12 22:12:55.778 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:12:55.778 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:55.779 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:12:55.779 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:12:55.787 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=qIS7X-1VhEGkFpHKdRx6wA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:12:55.787 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:12:55.787 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:55.788 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:12:55.828 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:12:55.828 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:55.829 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 49.5151ms
2025-08-12 22:12:55.829 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:12:55.829 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 50.3483 ms
2025-08-12 22:12:55.829 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 50.8709ms
2025-08-12 22:12:59.340 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:12:59.340 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:59.340 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.2822ms
2025-08-12 22:12:59.345 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:12:59.345 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:12:59.346 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:12:59.346 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:12:59.355 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:12:59.425 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:12:59.426 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:12:59.426 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 80.1265ms
2025-08-12 22:12:59.426 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:12:59.426 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 81.0437 ms
2025-08-12 22:12:59.426 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 81.5727ms
2025-08-12 22:13:01.571 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:13:01.571 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:01.571 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2471ms
2025-08-12 22:13:01.574 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 126
2025-08-12 22:13:01.575 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:01.575 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:13:01.575 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:13:01.588 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:13:01.597 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:13:01.621 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p27='?' (DbType = Guid), @p25='?' (DbType = Guid), @p26='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [ActionBy] = @p25, [LastActionDate] = @p26
OUTPUT 1
WHERE [Id] = @p27;
2025-08-12 22:13:01.623 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:13:01.623 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 48.2605ms
2025-08-12 22:13:01.623 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:13:01.623 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 48.8289 ms
2025-08-12 22:13:01.624 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 49.2824ms
2025-08-12 22:13:03.892 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:13:03.892 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:03.892 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.2345ms
2025-08-12 22:13:03.897 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:13:03.898 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:03.898 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:13:03.898 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:13:03.913 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:13:03.914 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:03.914 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.4506ms
2025-08-12 22:13:03.921 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:13:03.921 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:03.924 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:13:03.924 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:13:03.928 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:13:03.933 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:13:03.935 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:13:03.936 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:13:03.937 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 38.3498ms
2025-08-12 22:13:03.937 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:13:03.937 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 39.2900 ms
2025-08-12 22:13:03.939 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 41.1936ms
2025-08-12 22:13:03.943 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:13:03.944 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:13:03.944 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 19.9341ms
2025-08-12 22:13:03.944 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:13:03.944 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 22.7574 ms
2025-08-12 22:13:03.944 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 23.8114ms
2025-08-12 22:13:07.251 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:13:07.251 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:07.251 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2825ms
2025-08-12 22:13:07.256 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 133
2025-08-12 22:13:07.256 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:13:07.257 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:13:07.257 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:13:07.260 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:13:07.262 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:13:07.284 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:13:07.287 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:13:07.287 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 30.2571ms
2025-08-12 22:13:07.287 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:13:07.287 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 30.8472 ms
2025-08-12 22:13:07.287 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 31.3ms
2025-08-12 22:32:40.861 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 22:32:41.236 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 22:32:41.237 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 22:32:41.241 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 22:32:41.242 +03:00 [INF] Hosting environment: Development
2025-08-12 22:32:41.242 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 22:32:41.980 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 22:32:42.296 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 319.3025ms
2025-08-12 22:32:43.106 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 22:32:43.113 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 6.6658ms
2025-08-12 22:32:43.134 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 22:32:43.193 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 58.2065ms
2025-08-12 22:32:45.632 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 22:32:46.001 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 368.8045ms
2025-08-12 22:32:50.989 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:32:50.989 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:32:50.993 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:32:50.993 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 22:32:50.996 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:50.996 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:50.996 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:50.997 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:50.999 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 10.4797ms
2025-08-12 22:32:50.999 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 10.4792ms
2025-08-12 22:32:50.999 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 6.7064ms
2025-08-12 22:32:50.999 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 6.5818ms
2025-08-12 22:32:51.004 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 22:32:51.006 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:51.009 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:32:51.009 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:51.012 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:32:51.013 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:51.014 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:32:51.015 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:51.241 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:32:51.240 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:32:51.240 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:32:51.241 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:32:51.253 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:32:51.253 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:32:51.257 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 237.9324 ms
2025-08-12 22:32:51.257 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 240.3695 ms
2025-08-12 22:32:51.259 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 244.7761ms
2025-08-12 22:32:51.259 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 246.3288ms
2025-08-12 22:32:51.280 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=WU6GvfMQkS0ReXPHxM5Zaw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - null null
2025-08-12 22:32:51.280 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:51.285 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:32:51.286 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=k2UaFmCAWAu8ItFXuzE8EQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:32:51.286 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:51.287 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:32:51.295 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:32:51.295 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:32:53.988 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:32:53.988 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:32:54.347 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:32:54.348 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:32:54.382 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:32:54.382 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:32:54.446 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 3144.1424ms
2025-08-12 22:32:54.446 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 3144.1447ms
2025-08-12 22:32:54.447 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:32:54.447 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:32:54.449 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 3437.5120 ms
2025-08-12 22:32:54.449 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 3437.4710 ms
2025-08-12 22:32:54.463 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 3453.8327ms
2025-08-12 22:32:54.464 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 3459.6123ms
2025-08-12 22:32:59.273 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:32:59.273 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:59.274 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.8347ms
2025-08-12 22:32:59.278 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:32:59.280 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:59.281 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:32:59.299 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:32:59.302 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:32:59.304 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:59.304 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 6.4496ms
2025-08-12 22:32:59.309 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:32:59.312 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:32:59.313 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:32:59.325 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:32:59.478 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:32:59.478 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:32:59.579 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:32:59.720 +03:00 [INF] Executed DbCommand (97ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:32:59.727 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:32:59.737 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 434.9561ms
2025-08-12 22:32:59.737 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:32:59.737 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 456.9789 ms
2025-08-12 22:32:59.738 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 459.5282ms
2025-08-12 22:32:59.754 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:32:59.763 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 437.6367ms
2025-08-12 22:32:59.763 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:32:59.763 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 451.2841 ms
2025-08-12 22:32:59.764 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 455.3105ms
2025-08-12 22:33:01.762 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:33:01.762 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:01.763 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.9268ms
2025-08-12 22:33:01.767 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 130
2025-08-12 22:33:01.767 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:01.768 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:33:01.777 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:33:01.854 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:33:02.016 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:33:02.581 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 22:33:02.648 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:02.653 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 875.6008ms
2025-08-12 22:33:02.653 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:33:02.654 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 886.4486 ms
2025-08-12 22:33:02.654 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 887.8658ms
2025-08-12 22:33:07.787 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:33:07.787 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 16506.4046 ms
2025-08-12 22:33:07.787 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=WU6GvfMQkS0ReXPHxM5Zaw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - 200 null null 16507.4032ms
2025-08-12 22:33:07.901 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:33:07.901 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 22:33:07.902 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:07.902 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:07.902 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.5639ms
2025-08-12 22:33:07.902 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.5879ms
2025-08-12 22:33:07.905 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:33:07.905 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 22:33:07.905 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:07.905 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:07.906 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:33:07.906 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:33:07.907 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:33:07.907 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:33:07.907 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.5662 ms
2025-08-12 22:33:07.907 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 2.1785ms
2025-08-12 22:33:07.914 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=FResohlmQrzQTk1dLZSuGw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - null null
2025-08-12 22:33:07.914 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:07.915 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:33:07.921 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:33:07.960 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:33:07.961 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:07.962 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 54.8193ms
2025-08-12 22:33:07.962 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:33:07.962 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 56.6356 ms
2025-08-12 22:33:07.963 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 57.8122ms
2025-08-12 22:33:13.128 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:33:13.128 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 21841.2098 ms
2025-08-12 22:33:13.128 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=k2UaFmCAWAu8ItFXuzE8EQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 21842.0512ms
2025-08-12 22:33:13.899 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:33:13.899 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:13.900 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.5716ms
2025-08-12 22:33:13.914 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:33:13.914 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:13.914 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3955ms
2025-08-12 22:33:13.923 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:33:13.924 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:13.924 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:33:13.925 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:33:13.926 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:33:13.927 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:13.927 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:33:13.928 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:33:13.928 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.9360 ms
2025-08-12 22:33:13.928 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.4984ms
2025-08-12 22:33:13.928 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:33:13.932 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:33:13.932 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:13.933 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 8.0586ms
2025-08-12 22:33:13.933 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:33:13.933 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 8.9834 ms
2025-08-12 22:33:13.933 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 9.7122ms
2025-08-12 22:33:13.936 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=A_AOzYcCPVw5V9LLxwp-7w&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:33:13.936 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:13.937 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:33:15.028 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:33:15.029 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:15.029 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.4845ms
2025-08-12 22:33:15.033 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:33:15.033 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:15.035 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:33:15.035 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:33:15.043 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:33:15.043 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:15.045 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.8308ms
2025-08-12 22:33:15.049 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:33:15.049 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:33:15.050 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:15.051 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:33:15.051 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:33:15.063 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:33:15.070 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:33:15.072 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:15.072 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 21.0903ms
2025-08-12 22:33:15.072 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:33:15.072 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 22.3474 ms
2025-08-12 22:33:15.072 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 23.0476ms
2025-08-12 22:33:15.127 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:33:15.127 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:15.128 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 92.1943ms
2025-08-12 22:33:15.128 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:33:15.128 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 94.2149 ms
2025-08-12 22:33:15.128 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 95.3565ms
2025-08-12 22:33:16.047 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:33:16.047 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:16.048 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.774ms
2025-08-12 22:33:16.055 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:33:16.055 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:16.057 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:33:16.057 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:33:16.062 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:33:16.067 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:33:16.068 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:16.068 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 11.2696ms
2025-08-12 22:33:16.069 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:33:16.069 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 13.0735 ms
2025-08-12 22:33:16.069 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 14.2066ms
2025-08-12 22:33:17.924 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:33:17.924 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:17.925 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.5265ms
2025-08-12 22:33:17.928 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-08-12 22:33:17.928 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:17.929 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:33:17.929 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:33:17.943 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:33:17.958 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:33:17.985 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 22:33:17.988 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:17.988 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 59.2624ms
2025-08-12 22:33:17.988 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:33:17.988 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 60.2804 ms
2025-08-12 22:33:17.989 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 60.9361ms
2025-08-12 22:33:58.361 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:33:58.361 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 50446.6817 ms
2025-08-12 22:33:58.361 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=FResohlmQrzQTk1dLZSuGw&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - 200 null null 50447.8164ms
2025-08-12 22:33:58.368 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:33:58.369 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 44432.1173 ms
2025-08-12 22:33:58.369 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=A_AOzYcCPVw5V9LLxwp-7w&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 44432.6072ms
2025-08-12 22:33:59.089 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 22:33:59.089 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:59.089 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.4828ms
2025-08-12 22:33:59.092 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:33:59.092 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 22:33:59.092 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:59.092 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:59.092 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.4685ms
2025-08-12 22:33:59.093 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:33:59.093 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:33:59.099 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:33:59.100 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:59.100 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:33:59.101 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:33:59.101 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 1.2084 ms
2025-08-12 22:33:59.101 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.8797ms
2025-08-12 22:33:59.108 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:33:59.149 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=nfqkCBDmZrI-D1L0RuFYNg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - null null
2025-08-12 22:33:59.150 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:33:59.152 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:33:59.175 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:33:59.176 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:33:59.177 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 83.5609ms
2025-08-12 22:33:59.177 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:33:59.177 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 84.8274 ms
2025-08-12 22:33:59.177 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 85.5198ms
2025-08-12 22:34:00.273 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:34:00.273 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:00.273 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.455ms
2025-08-12 22:34:00.273 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:34:00.274 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:00.274 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2649ms
2025-08-12 22:34:00.277 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:34:00.277 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:34:00.278 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:00.278 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:00.278 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:34:00.278 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:34:00.279 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:34:00.279 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:34:00.279 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.8889 ms
2025-08-12 22:34:00.279 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.4319ms
2025-08-12 22:34:00.282 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:34:00.284 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:34:00.285 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:00.285 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 6.3716ms
2025-08-12 22:34:00.285 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:34:00.285 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 7.3118 ms
2025-08-12 22:34:00.286 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 8.054ms
2025-08-12 22:34:00.374 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=7Pua0NkqurcFchLrRQ_XYA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:34:00.374 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:00.375 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:34:01.451 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:34:01.451 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:01.451 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.3811ms
2025-08-12 22:34:01.456 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:34:01.456 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:01.457 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:34:01.457 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:34:01.465 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:34:01.465 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:01.466 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.4971ms
2025-08-12 22:34:01.466 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:34:01.470 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:34:01.470 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:01.471 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:34:01.472 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:34:01.486 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:34:01.498 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:34:01.499 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:01.499 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 27.7933ms
2025-08-12 22:34:01.500 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:34:01.500 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 28.9400 ms
2025-08-12 22:34:01.500 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 29.9125ms
2025-08-12 22:34:01.559 +03:00 [INF] Executed DbCommand (90ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:34:01.559 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:01.560 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 102.2266ms
2025-08-12 22:34:01.560 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:34:01.560 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 103.6840 ms
2025-08-12 22:34:01.560 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 104.7497ms
2025-08-12 22:34:05.220 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:34:05.220 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:05.220 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2816ms
2025-08-12 22:34:05.222 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 130
2025-08-12 22:34:05.223 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:05.223 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:34:05.223 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:34:05.233 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:34:05.247 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:34:05.280 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:34:05.282 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:05.283 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 59.2129ms
2025-08-12 22:34:05.283 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:34:05.283 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 60.2364 ms
2025-08-12 22:34:05.283 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 60.8695ms
2025-08-12 22:34:15.424 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:34:15.424 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:15.424 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3791ms
2025-08-12 22:34:15.427 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 128
2025-08-12 22:34:15.427 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:15.428 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:34:15.428 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:34:15.436 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:34:15.438 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:34:15.461 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 22:34:15.464 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:15.464 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 35.5471ms
2025-08-12 22:34:15.464 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:34:15.464 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 36.6670 ms
2025-08-12 22:34:15.465 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 37.4796ms
2025-08-12 22:34:43.660 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:34:43.660 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:43.660 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.3172ms
2025-08-12 22:34:43.664 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:34:43.664 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:43.665 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:34:43.665 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:34:43.676 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:34:43.681 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:34:43.682 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:43.682 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5162ms
2025-08-12 22:34:43.688 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:34:43.688 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:43.689 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:34:43.689 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:34:43.702 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:34:43.715 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:34:43.716 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:43.717 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 27.1768ms
2025-08-12 22:34:43.717 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:34:43.717 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 28.3263 ms
2025-08-12 22:34:43.717 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 29.4504ms
2025-08-12 22:34:43.797 +03:00 [INF] Executed DbCommand (118ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:34:43.798 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:43.798 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 132.4456ms
2025-08-12 22:34:43.798 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:34:43.798 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 133.4017 ms
2025-08-12 22:34:43.798 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 133.9835ms
2025-08-12 22:34:45.867 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:34:45.867 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:45.867 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2769ms
2025-08-12 22:34:45.869 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 125
2025-08-12 22:34:45.870 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:34:45.870 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:34:45.870 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:34:45.907 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:34:45.918 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:34:45.941 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p20='?' (DbType = Guid), @p19='?' (DbType = DateTimeOffset), @p22='?' (DbType = Guid), @p21='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [LastActionDate] = @p19
OUTPUT 1
WHERE [Id] = @p20;
UPDATE [RoomMembers] SET [LastActionDate] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
2025-08-12 22:34:45.943 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:34:45.944 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 73.2441ms
2025-08-12 22:34:45.944 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:34:45.944 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 74.1448 ms
2025-08-12 22:34:45.944 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 74.5711ms
2025-08-12 22:35:43.189 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:35:43.189 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 104038.9783 ms
2025-08-12 22:35:43.189 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=nfqkCBDmZrI-D1L0RuFYNg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - 200 null null 104040.1208ms
2025-08-12 22:35:43.293 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:35:43.293 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 102919.0274 ms
2025-08-12 22:35:43.294 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=7Pua0NkqurcFchLrRQ_XYA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 102919.7931ms
2025-08-12 22:35:43.474 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 22:35:43.474 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:43.475 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.3801ms
2025-08-12 22:35:43.485 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:35:43.485 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:43.485 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3203ms
2025-08-12 22:35:43.488 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 22:35:43.488 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:43.489 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:35:43.489 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:35:43.489 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:43.489 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:35:43.489 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:35:43.490 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:35:43.490 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.7575 ms
2025-08-12 22:35:43.490 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.1565ms
2025-08-12 22:35:43.501 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:35:43.502 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=z9B6dfSkAQpSAO9W_WipxA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - null null
2025-08-12 22:35:43.502 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:43.502 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:35:43.547 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:35:43.548 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:43.548 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 58.9907ms
2025-08-12 22:35:43.548 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:35:43.548 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 59.8997 ms
2025-08-12 22:35:43.549 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 200 null application/json; charset=utf-8 60.6315ms
2025-08-12 22:35:44.907 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:35:44.908 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:44.908 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3907ms
2025-08-12 22:35:44.908 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:35:44.908 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:44.908 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.2061ms
2025-08-12 22:35:44.913 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:35:44.913 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:44.914 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:35:44.914 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:44.914 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:35:44.914 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:35:44.914 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.9456 ms
2025-08-12 22:35:44.914 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:35:44.914 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.3601ms
2025-08-12 22:35:44.914 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:35:44.917 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:35:44.919 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:35:44.919 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:44.921 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 6.7442ms
2025-08-12 22:35:44.921 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:35:44.921 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 7.5993 ms
2025-08-12 22:35:44.922 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 8.0657ms
2025-08-12 22:35:44.928 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=nQbPxnM8K7IjYJu24Zx80g&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:35:44.928 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:44.929 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:35:45.037 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:35:45.037 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:45.037 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.2934ms
2025-08-12 22:35:45.041 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:35:45.041 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:45.042 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:35:45.042 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:35:45.045 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:35:45.045 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:45.045 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3214ms
2025-08-12 22:35:45.048 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:35:45.048 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:35:45.048 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:45.048 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:35:45.049 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:35:45.053 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:35:45.059 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:35:45.060 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:45.060 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 11.6125ms
2025-08-12 22:35:45.060 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:35:45.060 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 12.3388 ms
2025-08-12 22:35:45.060 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 12.9854ms
2025-08-12 22:35:45.151 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:35:45.152 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:45.152 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 109.8595ms
2025-08-12 22:35:45.152 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:35:45.152 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 111.1113 ms
2025-08-12 22:35:45.152 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 111.6065ms
2025-08-12 22:35:46.823 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:35:46.824 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:46.824 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.5518ms
2025-08-12 22:35:46.827 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 128
2025-08-12 22:35:46.828 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:46.828 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:35:46.829 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:35:46.842 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:35:46.853 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:35:46.871 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:35:46.873 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:46.873 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 44.5157ms
2025-08-12 22:35:46.874 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:35:46.874 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 45.8415 ms
2025-08-12 22:35:46.874 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 46.5928ms
2025-08-12 22:35:50.212 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:35:50.212 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:50.212 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.1987ms
2025-08-12 22:35:50.216 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:35:50.216 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:50.217 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:35:50.217 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:35:50.219 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:35:50.219 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:50.219 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2881ms
2025-08-12 22:35:50.222 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:35:50.222 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:50.223 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:35:50.223 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:35:50.226 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:35:50.230 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:35:50.237 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:35:50.238 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:50.239 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 15.4169ms
2025-08-12 22:35:50.239 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:35:50.239 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 16.0441 ms
2025-08-12 22:35:50.239 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 16.5252ms
2025-08-12 22:35:50.285 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:35:50.286 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:50.286 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 69.0938ms
2025-08-12 22:35:50.286 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:35:50.286 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 70.4473 ms
2025-08-12 22:35:50.286 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 70.9102ms
2025-08-12 22:35:54.788 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:35:54.788 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:54.788 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.2421ms
2025-08-12 22:35:54.792 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:35:54.792 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:54.792 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:35:54.792 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:35:54.811 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:35:54.866 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:35:54.867 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:54.867 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 69.9652ms
2025-08-12 22:35:54.867 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:35:54.867 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 75.1609 ms
2025-08-12 22:35:54.867 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 75.6806ms
2025-08-12 22:35:57.110 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:35:57.110 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:57.110 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2428ms
2025-08-12 22:35:57.117 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 131
2025-08-12 22:35:57.117 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:35:57.118 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:35:57.118 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:35:57.154 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:35:57.173 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:35:57.198 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:35:57.201 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:35:57.202 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 83.3732ms
2025-08-12 22:35:57.202 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:35:57.202 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 84.5187 ms
2025-08-12 22:35:57.202 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 85.106ms
2025-08-12 22:36:03.677 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:36:03.678 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:03.678 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.6224ms
2025-08-12 22:36:03.682 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:36:03.682 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:03.683 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:36:03.683 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:36:03.686 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:36:03.690 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:36:03.690 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:36:03.691 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 7.5802ms
2025-08-12 22:36:03.691 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:36:03.691 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 8.2151 ms
2025-08-12 22:36:03.691 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 8.6068ms
2025-08-12 22:36:06.710 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:36:06.710 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:06.710 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2788ms
2025-08-12 22:36:06.714 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 132
2025-08-12 22:36:06.714 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:06.714 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:36:06.715 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:36:06.717 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:36:06.720 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:36:06.727 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:36:06.747 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:36:06.747 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 32.3156ms
2025-08-12 22:36:06.747 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:36:06.747 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 32.9599 ms
2025-08-12 22:36:06.747 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 33.3956ms
2025-08-12 22:36:19.812 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:36:19.812 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:19.812 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.6319ms
2025-08-12 22:36:19.816 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:36:19.816 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:19.817 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:36:19.817 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:36:19.830 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:36:19.894 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:36:19.894 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:36:19.894 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 77.3843ms
2025-08-12 22:36:19.894 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:36:19.894 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 78.2683 ms
2025-08-12 22:36:19.895 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 79.0568ms
2025-08-12 22:36:23.027 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:36:23.027 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 38098.5837 ms
2025-08-12 22:36:23.027 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=nQbPxnM8K7IjYJu24Zx80g&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 38098.9473ms
2025-08-12 22:36:23.396 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 22:36:23.396 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:23.396 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.3188ms
2025-08-12 22:36:23.410 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:36:23.410 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:23.410 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2713ms
2025-08-12 22:36:23.446 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 22:36:23.446 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:23.446 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 22:36:23.447 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 22:36:23.447 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 0.7933 ms
2025-08-12 22:36:23.447 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 1.2497ms
2025-08-12 22:36:23.457 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:36:23.457 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:23.457 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:36:23.458 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:36:23.464 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=-Nassxnu0iE-6P-JeFDRXQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - null null
2025-08-12 22:36:23.464 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:23.465 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 22:36:23.465 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:36:23.501 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:36:23.502 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:36:23.502 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 44.2267ms
2025-08-12 22:36:23.502 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:36:23.502 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 45.0063 ms
2025-08-12 22:36:23.502 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 45.5779ms
2025-08-12 22:36:43.041 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:36:43.041 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:43.041 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.3007ms
2025-08-12 22:36:43.044 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 132
2025-08-12 22:36:43.044 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:43.044 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:36:43.045 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:36:43.056 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:36:43.089 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:36:43.107 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:36:43.109 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:36:43.110 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 64.8875ms
2025-08-12 22:36:43.110 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:36:43.110 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 65.5006 ms
2025-08-12 22:36:43.110 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 65.9909ms
2025-08-12 22:36:46.564 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 22:36:46.564 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:46.565 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.1254ms
2025-08-12 22:36:46.566 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 22:36:46.566 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:46.567 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:36:46.567 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:36:46.571 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:36:46.600 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:36:46.601 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:36:46.601 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 34.3032ms
2025-08-12 22:36:46.601 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:36:46.601 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 35.0150 ms
2025-08-12 22:36:46.601 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 35.4007ms
2025-08-12 22:36:49.408 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - null null
2025-08-12 22:36:49.409 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:49.409 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/Send - 204 null null 0.2424ms
2025-08-12 22:36:49.411 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Messages/Send - application/json 134
2025-08-12 22:36:49.412 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:36:49.412 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:36:49.412 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessageAsync(Application.Commands.Messages.SendMessage.SendMessageRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:36:49.416 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_RoomMemberId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId], [t].[Id], [t].[ActionBy], [t].[ConnectId], [t].[Email], [t].[FirstName], [t].[IsAdmin], [t].[IsDeleted], [t].[LastActionDate], [t].[LastName], [t].[Metadata], [t].[Password], [t].[ProfileImageUrl], [t].[Username], [t].[WorkspaceId]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[UserId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[Id] = @__request_RoomMemberId_0
2025-08-12 22:36:49.418 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[ActionBy], [t].[Description], [t].[IsDeleted], [t].[LastActionDate], [t].[Metadata], [t].[Title], [t].[Type], [t].[UniqueDirectKey], [t].[WorkspaceId], [t0].[Id], [t0].[ActionBy], [t0].[ChatRoomId], [t0].[IsAdmin], [t0].[IsDeleted], [t0].[LastActionDate], [t0].[Metadata], [t0].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0
) AS [t]
LEFT JOIN (
    SELECT [r].[Id], [r].[ActionBy], [r].[ChatRoomId], [r].[IsAdmin], [r].[IsDeleted], [r].[LastActionDate], [r].[Metadata], [r].[UserId]
    FROM [RoomMembers] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
) AS [t0] ON [t].[Id] = [t0].[ChatRoomId]
ORDER BY [t].[Id]
2025-08-12 22:36:49.421 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p18='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p21='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = DateTimeOffset), @p24='?' (DbType = Guid), @p22='?' (DbType = Guid), @p23='?' (DbType = DateTimeOffset), @p26='?' (DbType = Guid), @p25='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatMessages] ([Id], [ActionBy], [FilePath], [IsDeleted], [IsRead], [LastActionDate], [Message], [Metadata], [RoomMemberId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
UPDATE [ChatRooms] SET [ActionBy] = @p9, [Description] = @p10, [IsDeleted] = @p11, [LastActionDate] = @p12, [Metadata] = @p13, [Title] = @p14, [Type] = @p15, [UniqueDirectKey] = @p16, [WorkspaceId] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [RoomMembers] SET [ActionBy] = @p19, [LastActionDate] = @p20
OUTPUT 1
WHERE [Id] = @p21;
UPDATE [RoomMembers] SET [ActionBy] = @p22, [LastActionDate] = @p23
OUTPUT 1
WHERE [Id] = @p24;
UPDATE [Users] SET [LastActionDate] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-08-12 22:36:49.424 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:36:49.424 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI) in 11.5463ms
2025-08-12 22:36:49.424 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.SendMessageAsync (ChatSystem.UI)'
2025-08-12 22:36:49.424 +03:00 [INF] HTTP POST /api/Messages/Send responded 200 in 12.2328 ms
2025-08-12 22:36:49.424 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Messages/Send - 200 null application/json; charset=utf-8 12.6998ms
2025-08-12 22:36:58.423 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 22:36:58.423 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 74921.4581 ms
2025-08-12 22:36:58.423 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=z9B6dfSkAQpSAO9W_WipxA&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4OThkOTJjOC1hYTQ4LTQ3YjgtODE2Ny1kNmRhOTNiZGEyYWUiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibW1tIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjk1MjEsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9._Utom_cL9BLNHu188IKH2eze7JO_A8-bvwvLhdieevs - 200 null null 74921.8096ms
2025-08-12 22:37:07.949 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:37:07.949 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:07.949 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2041ms
2025-08-12 22:37:07.954 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:37:07.954 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:07.954 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2344ms
2025-08-12 22:37:08.013 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:08.014 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:08.015 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:08.015 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:37:08.018 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:08.019 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:08.019 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:08.019 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:37:08.026 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:08.028 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:08.033 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:37:08.034 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:08.034 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 15.1117ms
2025-08-12 22:37:08.034 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:08.034 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 15.6440 ms
2025-08-12 22:37:08.034 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 16.0356ms
2025-08-12 22:37:08.071 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:37:08.072 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:08.072 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 57.0573ms
2025-08-12 22:37:08.072 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:08.072 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 57.8103 ms
2025-08-12 22:37:08.072 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 58.6089ms
2025-08-12 22:37:46.363 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:37:46.363 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:46.363 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2955ms
2025-08-12 22:37:46.440 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:46.440 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:46.441 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:46.441 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:37:46.445 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:46.448 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:37:46.449 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:46.449 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 7.6005ms
2025-08-12 22:37:46.449 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:46.449 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 8.4280 ms
2025-08-12 22:37:46.449 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 9.4913ms
2025-08-12 22:37:50.079 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:37:50.079 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:50.079 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.278ms
2025-08-12 22:37:50.133 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:50.133 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:50.133 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:50.134 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:37:50.137 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:50.138 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:37:50.138 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:50.139 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 5.0225ms
2025-08-12 22:37:50.139 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:50.139 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 5.7829 ms
2025-08-12 22:37:50.139 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.3813ms
2025-08-12 22:37:51.190 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:37:51.190 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:51.190 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.2471ms
2025-08-12 22:37:51.257 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:37:51.257 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:51.258 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:37:51.266 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:37:51.295 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:37:51.329 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:51.334 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 67.6766ms
2025-08-12 22:37:51.334 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:37:51.334 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 76.9521 ms
2025-08-12 22:37:51.335 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 77.6003ms
2025-08-12 22:37:55.130 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:37:55.130 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:55.130 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3826ms
2025-08-12 22:37:55.214 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:55.214 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:55.215 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:55.215 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:37:55.218 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:55.219 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:37:55.220 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:55.220 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 5.4937ms
2025-08-12 22:37:55.220 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:55.220 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 6.4997 ms
2025-08-12 22:37:55.221 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 7.0046ms
2025-08-12 22:37:58.803 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:37:58.803 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:58.803 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3054ms
2025-08-12 22:37:58.812 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:58.812 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:58.812 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:58.812 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:37:58.828 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:58.837 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:37:58.837 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:58.837 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 24.9054ms
2025-08-12 22:37:58.837 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:37:58.838 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 25.5999 ms
2025-08-12 22:37:58.838 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 26.0668ms
2025-08-12 22:37:58.863 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:58.864 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:58.864 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:58.864 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:37:58.870 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:58.914 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:37:58.915 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:58.915 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 50.7059ms
2025-08-12 22:37:58.915 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:58.915 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 51.2571 ms
2025-08-12 22:37:58.915 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 51.6915ms
2025-08-12 22:37:59.643 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:37:59.643 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:37:59.644 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:59.644 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:37:59.652 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:37:59.685 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:37:59.685 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:37:59.685 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 40.7937ms
2025-08-12 22:37:59.685 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:37:59.685 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 41.7869 ms
2025-08-12 22:37:59.685 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 42.3084ms
2025-08-12 22:38:01.252 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - null null
2025-08-12 22:38:01.252 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:01.252 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 204 null null 0.2624ms
2025-08-12 22:38:01.256 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - application/json null
2025-08-12 22:38:01.256 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:01.257 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:38:01.257 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:38:01.257 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:38:01.258 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:01.258 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2236ms
2025-08-12 22:38:01.262 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:38:01.262 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:01.263 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:38:01.263 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:38:01.267 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:38:01.271 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:38:01.282 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:38:01.283 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:38:01.283 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 20.5461ms
2025-08-12 22:38:01.283 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:38:01.284 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 21.4217 ms
2025-08-12 22:38:01.284 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 21.9173ms
2025-08-12 22:38:01.343 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:38:01.343 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:38:01.343 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 86.192ms
2025-08-12 22:38:01.344 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:38:01.344 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4 responded 200 in 87.5271 ms
2025-08-12 22:38:01.344 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/03ac6cea-bfca-41c5-b876-36fa78752db4?page=1&pageSize=50 - 200 null application/json; charset=utf-8 87.9296ms
2025-08-12 22:38:10.307 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:38:10.307 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:10.308 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.4046ms
2025-08-12 22:38:10.386 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:38:10.386 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:10.386 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:38:10.386 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:38:10.400 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:38:10.408 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:38:10.409 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:38:10.409 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 22.5673ms
2025-08-12 22:38:10.409 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:38:10.409 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 23.1705 ms
2025-08-12 22:38:10.409 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 23.7848ms
2025-08-12 22:38:12.062 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:38:12.062 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:12.063 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.4683ms
2025-08-12 22:38:12.074 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:38:12.074 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:12.074 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:38:12.075 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:38:12.083 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:38:12.090 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:38:12.090 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:38:12.091 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 15.9139ms
2025-08-12 22:38:12.091 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:38:12.091 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 16.5353 ms
2025-08-12 22:38:12.091 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 17.0026ms
2025-08-12 22:38:12.138 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:38:12.139 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:38:12.140 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:38:12.140 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:38:12.152 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:38:12.192 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:38:12.193 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:38:12.193 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 53.0264ms
2025-08-12 22:38:12.193 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:38:12.193 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 54.4390 ms
2025-08-12 22:38:12.193 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 54.9387ms
2025-08-12 22:40:11.035 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:40:11.035 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:40:11.035 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3538ms
2025-08-12 22:40:11.129 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:40:11.129 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:40:11.130 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:40:11.130 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:40:11.143 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:40:11.196 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:40:11.196 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:40:11.197 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 67.0745ms
2025-08-12 22:40:11.197 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:40:11.197 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 68.3900 ms
2025-08-12 22:40:11.197 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 68.9317ms
2025-08-12 22:41:08.158 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - null null
2025-08-12 22:41:08.159 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:08.159 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - 204 null null 0.3424ms
2025-08-12 22:41:08.164 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:41:08.164 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:08.164 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2097ms
2025-08-12 22:41:08.189 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:41:08.189 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:08.190 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - application/json null
2025-08-12 22:41:08.190 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:08.191 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:41:08.191 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:08.191 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:41:08.191 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 22:41:08.199 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:41:08.200 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:41:08.207 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:41:08.208 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:41:08.208 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 16.5526ms
2025-08-12 22:41:08.208 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:08.208 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 17.7287 ms
2025-08-12 22:41:08.208 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 18.8974ms
2025-08-12 22:41:08.256 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 22:41:08.257 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:41:08.257 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 65.5591ms
2025-08-12 22:41:08.257 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 22:41:08.257 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d responded 200 in 66.5245 ms
2025-08-12 22:41:08.257 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/fbb1c98f-0649-4048-b82c-6c3df60d916d?page=1&pageSize=50 - 200 null application/json; charset=utf-8 67.47ms
2025-08-12 22:41:16.705 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:41:16.705 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:16.705 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.1474ms
2025-08-12 22:41:16.709 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:41:16.709 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:16.709 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.1792ms
2025-08-12 22:41:16.776 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:41:16.776 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:16.777 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:41:16.777 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:41:16.785 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:41:16.788 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:41:16.789 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:16.789 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:16.789 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:41:16.793 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:41:16.795 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:41:16.795 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:41:16.795 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 5.9988ms
2025-08-12 22:41:16.795 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:16.795 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 6.5394 ms
2025-08-12 22:41:16.795 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 6.9917ms
2025-08-12 22:41:16.821 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:41:16.822 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:41:16.822 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 44.589ms
2025-08-12 22:41:16.822 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:41:16.822 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 45.5346 ms
2025-08-12 22:41:16.822 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 45.9397ms
2025-08-12 22:41:20.069 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:41:20.069 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:20.069 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:20.069 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:41:20.078 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:41:20.086 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:41:20.086 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:41:20.086 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 16.9797ms
2025-08-12 22:41:20.087 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:20.087 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 17.4165 ms
2025-08-12 22:41:20.087 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 17.7113ms
2025-08-12 22:41:23.363 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:41:23.363 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:23.363 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.2651ms
2025-08-12 22:41:23.426 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:41:23.427 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:23.427 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:41:23.427 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:41:23.436 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:41:23.436 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:41:23.436 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 9.2373ms
2025-08-12 22:41:23.436 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:41:23.437 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 9.8086 ms
2025-08-12 22:41:23.437 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 10.3188ms
2025-08-12 22:41:26.200 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:41:26.200 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:26.200 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.3521ms
2025-08-12 22:41:26.264 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:41:26.265 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:41:26.265 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:26.265 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:41:26.274 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:41:26.282 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:41:26.283 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:41:26.283 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 17.6253ms
2025-08-12 22:41:26.283 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:41:26.283 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 18.3009 ms
2025-08-12 22:41:26.283 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 18.8385ms
2025-08-12 22:42:02.268 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:42:02.268 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:42:02.268 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.1965ms
2025-08-12 22:42:02.291 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 22:42:02.292 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:42:02.292 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.6934ms
2025-08-12 22:42:02.329 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:42:02.329 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:42:02.329 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3349ms
2025-08-12 22:42:02.359 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:42:02.359 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:42:02.360 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:42:02.360 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:42:02.363 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:42:02.363 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:42:02.364 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 3.6949ms
2025-08-12 22:42:02.364 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:42:02.364 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 4.3468 ms
2025-08-12 22:42:02.364 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 4.7866ms
2025-08-12 22:42:02.366 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 22:42:02.366 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:42:02.367 +03:00 [INF] HTTP GET /api/Users responded 404 in 0.4712 ms
2025-08-12 22:42:02.367 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 1.1082ms
2025-08-12 22:42:02.368 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 22:42:02.373 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:42:02.374 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:42:02.374 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:42:02.375 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:42:02.384 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:42:02.431 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:42:02.433 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 58.5266ms
2025-08-12 22:42:02.433 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:42:02.433 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 59.4724 ms
2025-08-12 22:42:02.434 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 60.0797ms
2025-08-12 22:43:55.763 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:43:55.763 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:43:55.763 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.221ms
2025-08-12 22:43:55.861 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:43:55.861 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:43:55.862 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:43:55.862 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:43:55.874 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:43:55.937 +03:00 [INF] Executed DbCommand (62ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:43:55.937 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:43:55.938 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 75.3177ms
2025-08-12 22:43:55.938 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:43:55.938 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 76.5015 ms
2025-08-12 22:43:55.938 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 77.4883ms
2025-08-12 22:43:57.610 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 22:43:57.610 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:43:57.610 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.3038ms
2025-08-12 22:43:57.626 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 22:43:57.627 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:43:57.627 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.3533ms
2025-08-12 22:43:57.655 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:43:57.656 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:43:57.656 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:43:57.656 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:43:57.659 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:43:57.662 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:43:57.662 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:43:57.663 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 6.4551ms
2025-08-12 22:43:57.663 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:43:57.663 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 6.9959 ms
2025-08-12 22:43:57.663 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 7.4341ms
2025-08-12 22:43:57.681 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 22:43:57.681 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:43:57.681 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:43:57.682 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 22:43:57.686 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 22:43:57.686 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:43:57.686 +03:00 [INF] HTTP GET /api/Users responded 404 in 0.2661 ms
2025-08-12 22:43:57.687 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 0.7086ms
2025-08-12 22:43:57.687 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 22:43:57.689 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 22:43:57.690 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:43:57.690 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 8.5664ms
2025-08-12 22:43:57.690 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 22:43:57.690 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 9.0415 ms
2025-08-12 22:43:57.690 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 9.5085ms
2025-08-12 22:47:52.891 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:47:52.892 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:47:52.892 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.2892ms
2025-08-12 22:47:52.942 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:47:52.942 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:47:52.943 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:47:52.943 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 22:47:52.954 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:47:52.997 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 22:47:52.998 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:47:52.998 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 55.2458ms
2025-08-12 22:47:52.998 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 22:47:52.998 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 56.0185 ms
2025-08-12 22:47:52.998 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 56.7502ms
2025-08-12 22:49:16.913 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 22:49:16.914 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:49:16.914 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5583ms
2025-08-12 22:49:16.992 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 22:49:16.992 +03:00 [INF] CORS policy execution successful.
2025-08-12 22:49:16.993 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:49:16.993 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 22:49:17.006 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 22:49:17.016 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 22:49:17.016 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 22:49:17.017 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 23.4343ms
2025-08-12 22:49:17.017 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 22:49:17.017 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 24.5693 ms
2025-08-12 22:49:17.017 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 25.1303ms
2025-08-12 23:04:19.833 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 23:04:19.834 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:04:19.834 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.8758ms
2025-08-12 23:04:19.877 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 23:04:19.877 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:04:19.880 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:04:19.880 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 23:04:19.895 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 23:04:19.897 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:04:19.897 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 16.6735ms
2025-08-12 23:04:19.897 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:04:19.897 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 18.9117 ms
2025-08-12 23:04:19.898 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 20.4998ms
2025-08-12 23:04:29.798 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces/Add - null null
2025-08-12 23:04:29.805 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:04:29.805 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces/Add - 204 null null 7.2502ms
2025-08-12 23:04:29.811 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Workspaces/Add - application/json 52
2025-08-12 23:04:29.813 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:04:29.814 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.AddAsync (ChatSystem.UI)'
2025-08-12 23:04:29.870 +03:00 [INF] Route matched with {action = "Add", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddAsync(Application.Commands.Workspaces.AddWorkspace.AddWorkspaceRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 23:04:30.236 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Workspaces] ([ActionBy], [Email], [IsDeleted], [LastActionDate], [Metadata], [Name])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-12 23:04:30.288 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:04:30.288 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.AddAsync (ChatSystem.UI) in 418.0058ms
2025-08-12 23:04:30.288 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.AddAsync (ChatSystem.UI)'
2025-08-12 23:04:30.288 +03:00 [INF] HTTP POST /api/Workspaces/Add responded 200 in 475.1049 ms
2025-08-12 23:04:30.288 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Workspaces/Add - 200 null application/json; charset=utf-8 476.9372ms
2025-08-12 23:04:30.384 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 23:04:30.384 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:04:30.384 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.4395ms
2025-08-12 23:04:30.525 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 23:04:30.526 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:04:30.526 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:04:30.526 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 23:04:30.531 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 23:04:30.532 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:04:30.532 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 5.4941ms
2025-08-12 23:04:30.532 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:04:30.532 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 6.0274 ms
2025-08-12 23:04:30.532 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 6.5303ms
2025-08-12 23:20:55.352 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 23:20:55.353 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 2671888.2920 ms
2025-08-12 23:20:55.353 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=-Nassxnu0iE-6P-JeFDRXQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMjkxOTQsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.EPEcOy9kkHr2g8VGaJTp7RzrGW0CCvjkY6BjU3X_puU - 200 null null 2671888.9181ms
2025-08-12 23:21:07.950 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 23:21:08.047 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 96.6324ms
2025-08-12 23:21:08.151 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 23:21:08.154 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 3.3168ms
2025-08-12 23:21:08.190 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 23:21:08.217 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.4398ms
2025-08-12 23:21:08.972 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 23:21:09.025 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 53.2843ms
2025-08-12 23:21:21.883 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 23:21:21.884 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:21.884 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 0.9802ms
2025-08-12 23:21:21.889 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 35
2025-08-12 23:21:21.889 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:21.895 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 23:21:21.921 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:21:22.052 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 23:21:22.130 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 23:21:22.141 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 219.5354ms
2025-08-12 23:21:22.141 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 23:21:22.141 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 251.9262 ms
2025-08-12 23:21:22.142 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 252.9556ms
2025-08-12 23:21:22.283 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 23:21:22.283 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:22.283 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 0.2152ms
2025-08-12 23:21:22.310 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:21:22.310 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 23:21:22.310 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:22.310 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:22.310 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3158ms
2025-08-12 23:21:22.310 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.3489ms
2025-08-12 23:21:22.380 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 23:21:22.380 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:22.381 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:21:22.381 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 23:21:22.383 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:21:22.383 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:22.384 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:21:22.384 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:21:22.395 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 23:21:22.395 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:21:22.396 +03:00 [INF] HTTP GET /api/Users responded 404 in 0.2888 ms
2025-08-12 23:21:22.396 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 1.0022ms
2025-08-12 23:21:22.396 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 23:21:22.401 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 23:21:22.402 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:21:22.402 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:21:22.402 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 21.0559ms
2025-08-12 23:21:22.402 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:21:22.402 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 22.1676 ms
2025-08-12 23:21:22.402 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 22.5639ms
2025-08-12 23:21:22.454 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:21:22.455 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 70.977ms
2025-08-12 23:21:22.455 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:21:22.455 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 71.9598 ms
2025-08-12 23:21:22.456 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 72.4161ms
2025-08-12 23:26:42.614 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 23:26:42.748 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 23:26:42.749 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 23:26:42.751 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 23:26:42.751 +03:00 [INF] Hosting environment: Development
2025-08-12 23:26:42.751 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 23:26:43.475 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 23:26:43.737 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 264.7199ms
2025-08-12 23:26:43.791 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 23:26:43.798 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 7.0145ms
2025-08-12 23:26:43.856 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 23:26:43.895 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.7713ms
2025-08-12 23:26:44.212 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 23:26:44.362 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 149.2964ms
2025-08-12 23:26:57.355 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 23:26:57.363 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:26:57.365 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 10.5292ms
2025-08-12 23:26:57.369 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 41
2025-08-12 23:26:57.376 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:26:57.444 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 23:26:57.489 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:26:59.914 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 23:27:00.175 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 23:27:00.219 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 2721.9572ms
2025-08-12 23:27:00.220 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 23:27:00.224 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 2840.4757 ms
2025-08-12 23:27:00.236 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 2866.5759ms
2025-08-12 23:27:00.270 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 23:27:00.271 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:00.272 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 23:27:00.272 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:00.272 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 1.3812ms
2025-08-12 23:27:00.272 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 0.5202ms
2025-08-12 23:27:00.272 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 23:27:00.273 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:00.273 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.6316ms
2025-08-12 23:27:00.276 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 23:27:00.276 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 23:27:00.276 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 23:27:00.277 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:00.277 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:00.280 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:00.394 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:27:00.395 +03:00 [INF] HTTP GET /api/Users responded 404 in 117.4131 ms
2025-08-12 23:27:00.395 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 119.1605ms
2025-08-12 23:27:00.397 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 23:27:00.405 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:27:00.409 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 23:27:00.418 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:27:00.564 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 23:27:00.572 +03:00 [ERR] An error occurred using the connection to database 'AmanahChatDB' on server 'YZN\SQLEXPRESS'.
2025-08-12 23:27:00.582 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:27:00.596 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 178.1353ms
2025-08-12 23:27:00.597 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:27:00.597 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 316.8072 ms
2025-08-12 23:27:00.598 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 499 null application/json; charset=utf-8 321.5412ms
2025-08-12 23:27:00.634 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:27:00.646 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 236.87ms
2025-08-12 23:27:00.646 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:27:00.646 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 369.5320 ms
2025-08-12 23:27:00.647 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 499 null application/json; charset=utf-8 370.942ms
2025-08-12 23:27:08.614 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:27:08.615 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:08.616 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 1.715ms
2025-08-12 23:27:08.624 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:27:08.624 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:27:08.627 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:27:08.640 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:27:08.691 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:27:08.724 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 23:27:08.734 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:27:08.741 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 100.3202ms
2025-08-12 23:27:08.741 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:27:08.741 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 116.6031 ms
2025-08-12 23:27:08.742 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 118.1449ms
2025-08-12 23:28:02.385 +03:00 [INF] User profile is available. Using 'C:\Users\hp\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-12 23:28:02.478 +03:00 [INF] Now listening on: https://localhost:7003
2025-08-12 23:28:02.478 +03:00 [INF] Now listening on: http://localhost:5277
2025-08-12 23:28:02.479 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-12 23:28:02.480 +03:00 [INF] Hosting environment: Development
2025-08-12 23:28:02.480 +03:00 [INF] Content root path: C:\Users\hp\Downloads\AmanahChatSystem_Updated\AmanahChatSystem
2025-08-12 23:28:03.147 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/index.html - null null
2025-08-12 23:28:03.389 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/index.html - 200 null text/html;charset=utf-8 244.5286ms
2025-08-12 23:28:03.471 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - null null
2025-08-12 23:28:03.477 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 6.3413ms
2025-08-12 23:28:03.492 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/_vs/browserLink - null null
2025-08-12 23:28:03.544 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 51.7955ms
2025-08-12 23:28:03.881 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - null null
2025-08-12 23:28:03.994 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 112.4245ms
2025-08-12 23:28:17.755 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - null null
2025-08-12 23:28:17.763 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:17.765 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/Login - 204 null null 9.2556ms
2025-08-12 23:28:17.769 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/Users/Login - application/json 41
2025-08-12 23:28:17.775 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:17.834 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 23:28:17.873 +03:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Application.Commands.Users.LoginUser.LoginUserRequest, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:28:20.176 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__request_UserName_0='?' (Size = 4000), @__request_Password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Username] = @__request_UserName_0 AND [u].[Password] = @__request_Password_1
2025-08-12 23:28:20.424 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[Application.Commands.Users.LoginUser.GetLoggedUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-12 23:28:20.470 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI) in 2589.7369ms
2025-08-12 23:28:20.471 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.Login (ChatSystem.UI)'
2025-08-12 23:28:20.476 +03:00 [INF] HTTP POST /api/Users/Login responded 200 in 2693.7253 ms
2025-08-12 23:28:20.492 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/Users/Login - 200 null application/json; charset=utf-8 2723.0774ms
2025-08-12 23:28:20.535 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 23:28:20.536 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - null null
2025-08-12 23:28:20.536 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 23:28:20.536 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:20.536 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:20.536 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:20.537 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 204 null null 0.8375ms
2025-08-12 23:28:20.537 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 1.0491ms
2025-08-12 23:28:20.537 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 1.119ms
2025-08-12 23:28:20.547 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - application/json null
2025-08-12 23:28:20.547 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 23:28:20.547 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 23:28:20.547 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:20.548 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:20.552 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:28:20.646 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:28:20.646 +03:00 [INF] HTTP GET /api/Users responded 404 in 97.6370 ms
2025-08-12 23:28:20.647 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 99.5803ms
2025-08-12 23:28:20.647 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 23:28:20.654 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:28:20.656 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 23:28:20.663 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:28:20.812 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 23:28:20.823 +03:00 [ERR] An error occurred using the connection to database 'AmanahChatDB' on server 'YZN\SQLEXPRESS'.
2025-08-12 23:28:20.838 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:28:20.855 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 191.5324ms
2025-08-12 23:28:20.855 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:28:20.855 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 302.3912 ms
2025-08-12 23:28:20.856 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=898d92c8-aa48-47b8-8167-d6da93bda2ae - 499 null application/json; charset=utf-8 309.2101ms
2025-08-12 23:28:20.886 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:28:20.897 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 240.7237ms
2025-08-12 23:28:20.897 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:28:20.897 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 349.1674 ms
2025-08-12 23:28:20.898 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 499 null application/json; charset=utf-8 351.0493ms
2025-08-12 23:31:53.942 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users - null null
2025-08-12 23:31:53.942 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:31:53.942 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - null null
2025-08-12 23:31:53.943 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:53.943 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:53.943 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:53.944 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Workspaces - 204 null null 1.6178ms
2025-08-12 23:31:53.944 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users - 204 null null 1.605ms
2025-08-12 23:31:53.944 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 1.6277ms
2025-08-12 23:31:53.957 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:31:53.957 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:53.958 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users - application/json null
2025-08-12 23:31:53.958 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Workspaces - application/json null
2025-08-12 23:31:53.958 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:53.958 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:53.960 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:31:53.960 +03:00 [INF] HTTP GET /api/Users responded 404 in 1.6422 ms
2025-08-12 23:31:53.961 +03:00 [INF] Route matched with {action = "GetWorkspaces", controller = "Workspaces"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetWorkspaces(System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.WorkspacesController (ChatSystem.UI).
2025-08-12 23:31:53.961 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users - 404 0 null 3.3535ms
2025-08-12 23:31:53.961 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7003/api/Users, Response status code: 404
2025-08-12 23:31:53.964 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:31:53.964 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:31:53.999 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[ActionBy], [w].[Email], [w].[IsDeleted], [w].[LastActionDate], [w].[Metadata], [w].[Name]
FROM [Workspaces] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-12 23:31:54.002 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Workspaces.GetWorkspaceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:31:54.002 +03:00 [INF] Executed action ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI) in 41.1853ms
2025-08-12 23:31:54.002 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.WorkspacesController.GetWorkspaces (ChatSystem.UI)'
2025-08-12 23:31:54.003 +03:00 [INF] HTTP GET /api/Workspaces responded 200 in 44.3570 ms
2025-08-12 23:31:54.003 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Workspaces - 200 null application/json; charset=utf-8 45.2719ms
2025-08-12 23:31:54.005 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:31:54.015 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:31:54.016 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 51.3324ms
2025-08-12 23:31:54.016 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:31:54.016 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 400 in 58.2556 ms
2025-08-12 23:31:54.016 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 499 null application/json; charset=utf-8 59.4247ms
2025-08-12 23:31:55.946 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:31:55.947 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:55.951 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:31:55.951 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:31:55.957 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:31:55.966 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 23:31:55.966 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:55.967 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.8799ms
2025-08-12 23:31:55.996 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 23:31:55.997 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:55.998 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 23:31:56.007 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 23:31:56.007 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 9.9636 ms
2025-08-12 23:31:56.007 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 10.6838ms
2025-08-12 23:31:56.015 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=TE55CXhE4JDLAr1XD8Oidg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMzM2ODIsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.ClwqXjWmlqYM_EpGbK9ojnI-yc_HRl4VKnfoFBYQkC4 - null null
2025-08-12 23:31:56.015 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:31:56.016 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 23:31:56.290 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 23:31:56.292 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:31:56.297 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 346.4299ms
2025-08-12 23:31:56.298 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:31:56.298 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 350.7851 ms
2025-08-12 23:31:56.298 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 351.7728ms
2025-08-12 23:32:04.021 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:04.021 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:04.022 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.5461ms
2025-08-12 23:32:04.039 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:04.039 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:04.039 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.6266ms
2025-08-12 23:32:04.100 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:04.101 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:04.102 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:04.102 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:32:04.115 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:04.115 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:04.116 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:04.117 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:04.126 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:32:04.148 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:04.165 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 23:32:04.165 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:04.166 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 63.6993ms
2025-08-12 23:32:04.166 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:04.167 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 65.7401 ms
2025-08-12 23:32:04.168 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 67.4981ms
2025-08-12 23:32:04.170 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 23:32:04.178 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:04.186 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 59.3848ms
2025-08-12 23:32:04.186 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:04.186 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 70.8603 ms
2025-08-12 23:32:04.187 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 71.7151ms
2025-08-12 23:32:09.425 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:09.425 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:09.426 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 1.0142ms
2025-08-12 23:32:09.502 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:09.503 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:09.503 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:09.504 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:32:09.515 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:09.522 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 23:32:09.522 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:09.523 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 18.8344ms
2025-08-12 23:32:09.523 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:09.523 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 19.7023 ms
2025-08-12 23:32:09.523 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 20.4413ms
2025-08-12 23:32:18.253 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - null null
2025-08-12 23:32:18.253 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:18.254 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/DirectChat/direct - 204 null null 0.3957ms
2025-08-12 23:32:18.257 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/api/DirectChat/direct - application/json 152
2025-08-12 23:32:18.257 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:18.258 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 23:32:18.265 +03:00 [INF] Route matched with {action = "CreateOrGetDirect", controller = "DirectChat"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Guid]] CreateOrGetDirect(Application.Commands.ChatRooms.AddDirectChat.AddDirectChatRequest) on controller ChatSystem.UI.Controllers.DirectChatController (ChatSystem.UI).
2025-08-12 23:32:18.310 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__key_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[ActionBy], [c].[Description], [c].[IsDeleted], [c].[LastActionDate], [c].[Metadata], [c].[Title], [c].[Type], [c].[UniqueDirectKey], [c].[WorkspaceId]
FROM [ChatRooms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Type] = 1 AND [c].[UniqueDirectKey] = @__key_0
2025-08-12 23:32:18.675 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTimeOffset), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 4000), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Boolean), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTimeOffset), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Boolean), @p22='?' (DbType = Boolean), @p23='?' (DbType = DateTimeOffset), @p24='?' (Size = 4000), @p25='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [ChatRooms] ([Id], [ActionBy], [Description], [IsDeleted], [LastActionDate], [Metadata], [Title], [Type], [UniqueDirectKey], [WorkspaceId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [RoomMembers] ([Id], [ActionBy], [ChatRoomId], [IsAdmin], [IsDeleted], [LastActionDate], [Metadata], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-08-12 23:32:18.704 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:18.707 +03:00 [INF] Executed action ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI) in 441.2168ms
2025-08-12 23:32:18.707 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.DirectChatController.CreateOrGetDirect (ChatSystem.UI)'
2025-08-12 23:32:18.707 +03:00 [INF] HTTP POST /api/DirectChat/direct responded 200 in 449.1629 ms
2025-08-12 23:32:18.707 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/api/DirectChat/direct - 200 null application/json; charset=utf-8 449.6808ms
2025-08-12 23:32:18.757 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:18.757 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:18.757 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.3689ms
2025-08-12 23:32:18.805 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:18.805 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:18.806 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:18.806 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:32:18.814 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:18.855 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 23:32:18.856 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:18.856 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 50.2339ms
2025-08-12 23:32:18.856 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:18.856 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 51.3145 ms
2025-08-12 23:32:18.857 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 51.9635ms
2025-08-12 23:32:23.838 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - null null
2025-08-12 23:32:23.839 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:23.839 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - 204 null null 1.0712ms
2025-08-12 23:32:23.847 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - application/json null
2025-08-12 23:32:23.849 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:23.850 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 23:32:23.855 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:23.855 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:23.855 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.4346ms
2025-08-12 23:32:23.860 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:23.860 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:23.861 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:23.861 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:32:23.866 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 23:32:23.872 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:23.880 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 23:32:23.880 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:23.881 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 19.7657ms
2025-08-12 23:32:23.881 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:23.881 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 20.8111 ms
2025-08-12 23:32:23.881 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 21.5164ms
2025-08-12 23:32:23.891 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:24.068 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 23:32:24.069 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:24.073 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 206.7916ms
2025-08-12 23:32:24.073 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 23:32:24.073 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff responded 200 in 224.2491 ms
2025-08-12 23:32:24.074 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - 200 null application/json; charset=utf-8 226.7523ms
2025-08-12 23:32:30.384 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:30.385 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:30.386 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 1.1133ms
2025-08-12 23:32:30.407 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:30.407 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:30.407 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.7041ms
2025-08-12 23:32:30.466 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:30.467 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:30.468 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:30.468 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:32:30.471 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:30.476 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 23:32:30.477 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:30.478 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 9.8538ms
2025-08-12 23:32:30.478 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:30.478 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 10.8047 ms
2025-08-12 23:32:30.478 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 11.7486ms
2025-08-12 23:32:30.489 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:30.489 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:30.491 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:30.491 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:32:30.496 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:30.500 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 23:32:30.501 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:30.502 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 10.9229ms
2025-08-12 23:32:30.502 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:32:30.502 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 12.6882 ms
2025-08-12 23:32:30.503 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 13.7213ms
2025-08-12 23:32:41.811 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:32:41.812 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:41.812 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.4174ms
2025-08-12 23:32:41.872 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:32:41.873 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:32:41.874 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:41.874 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:32:41.877 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:32:41.881 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 23:32:41.882 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:32:41.882 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 8.7078ms
2025-08-12 23:32:41.883 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:32:41.883 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 9.9380 ms
2025-08-12 23:32:41.883 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 10.5924ms
2025-08-12 23:35:44.006 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:35:44.007 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:35:44.007 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.5144ms
2025-08-12 23:35:44.108 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:35:44.108 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:35:44.109 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:35:44.109 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:35:44.122 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:35:44.131 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 23:35:44.132 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:35:44.132 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 22.8087ms
2025-08-12 23:35:44.132 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:35:44.132 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 24.1456 ms
2025-08-12 23:35:44.133 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 24.9017ms
2025-08-12 23:35:55.478 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:35:55.478 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:35:55.479 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 204 null null 0.4944ms
2025-08-12 23:35:55.554 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:35:55.554 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:35:55.554 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:35:55.555 +03:00 [INF] Route matched with {action = "GetChatRoomsByUser", controller = "ChatRooms"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetChatRoomsByUser(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.ChatRoomsController (ChatSystem.UI).
2025-08-12 23:35:55.564 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[Id] = @__request_UserId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:35:55.617 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__request_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id] AS [RoomMemberId], [t].[Id] AS [ChatRoomId], CASE
    WHEN [t].[Type] = 1 THEN (
        SELECT TOP(1) [t0].[FirstName] + N' ' + COALESCE([t0].[LastName], N'')
        FROM [RoomMembers] AS [r0]
        INNER JOIN (
            SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
            FROM [Users] AS [u]
            WHERE [u].[IsDeleted] = CAST(0 AS bit)
        ) AS [t0] ON [r0].[UserId] = [t0].[Id]
        WHERE [r0].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r0].[ChatRoomId] AND [r0].[UserId] <> @__request_UserId_0)
    ELSE [t].[Title]
END AS [Title], CASE
    WHEN [t].[Type] = 2 THEN [t].[Description]
    ELSE NULL
END AS [Description], (
    SELECT COUNT(*)
    FROM [RoomMembers] AS [r1]
    WHERE [r1].[IsDeleted] = CAST(0 AS bit) AND [t].[Id] = [r1].[ChatRoomId]) AS [TotalMembers], -1 AS [TotalMessages], [t].[LastActionDate], [r].[IsAdmin]
FROM [RoomMembers] AS [r]
INNER JOIN (
    SELECT [c].[Id], [c].[Description], [c].[LastActionDate], [c].[Title], [c].[Type]
    FROM [ChatRooms] AS [c]
    WHERE [c].[IsDeleted] = CAST(0 AS bit)
) AS [t] ON [r].[ChatRoomId] = [t].[Id]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[UserId] = @__request_UserId_0
ORDER BY [t].[LastActionDate] DESC
2025-08-12 23:35:55.618 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.ChatRooms.GetChatRoomDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:35:55.618 +03:00 [INF] Executed action ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI) in 63.6516ms
2025-08-12 23:35:55.618 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.ChatRoomsController.GetChatRoomsByUser (ChatSystem.UI)'
2025-08-12 23:35:55.619 +03:00 [INF] HTTP GET /api/ChatRooms/GetChatRoomsByUser responded 200 in 64.6167 ms
2025-08-12 23:35:55.619 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/ChatRooms/GetChatRoomsByUser?userId=afd4e443-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 65.2305ms
2025-08-12 23:36:30.786 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - null null
2025-08-12 23:36:30.786 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:36:30.787 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - 204 null null 0.4416ms
2025-08-12 23:36:30.789 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - application/json null
2025-08-12 23:36:30.790 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:36:30.790 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 23:36:30.791 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 23:36:30.791 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - null null
2025-08-12 23:36:30.791 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:36:30.791 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 204 null null 0.2199ms
2025-08-12 23:36:30.793 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - application/json null
2025-08-12 23:36:30.794 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:36:30.795 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:36:30.795 +03:00 [INF] Route matched with {action = "GetUsersByWorkspace", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersByWorkspace(System.Guid, System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.UsersController (ChatSystem.UI).
2025-08-12 23:36:30.801 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Workspaces] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__request_WorkSpaceId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:36:30.801 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:36:30.810 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_WorkSpaceId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ActionBy], [u].[ConnectId], [u].[Email], [u].[FirstName], [u].[IsAdmin], [u].[IsDeleted], [u].[LastActionDate], [u].[LastName], [u].[Metadata], [u].[Password], [u].[ProfileImageUrl], [u].[Username], [u].[WorkspaceId]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[WorkspaceId] = @__request_WorkSpaceId_0
2025-08-12 23:36:30.811 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Users.GetUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:36:30.811 +03:00 [INF] Executed action ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI) in 16.5472ms
2025-08-12 23:36:30.812 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.UsersController.GetUsersByWorkspace (ChatSystem.UI)'
2025-08-12 23:36:30.812 +03:00 [INF] HTTP GET /api/Users/GetUsersByWorkspace responded 200 in 18.0094 ms
2025-08-12 23:36:30.812 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Users/GetUsersByWorkspace?workspaceId=988cd920-225c-f011-92b0-10683856fb96 - 200 null application/json; charset=utf-8 18.8008ms
2025-08-12 23:36:30.872 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 23:36:30.873 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:36:30.873 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 82.4878ms
2025-08-12 23:36:30.873 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 23:36:30.873 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff responded 200 in 83.3802 ms
2025-08-12 23:36:30.873 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/277730d1-935d-49bb-8422-4a4e9a5677ff?page=1&pageSize=50 - 200 null application/json; charset=utf-8 84.0407ms
2025-08-12 23:36:32.630 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - null null
2025-08-12 23:36:32.630 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:36:32.630 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 204 null null 0.9044ms
2025-08-12 23:36:32.636 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - application/json null
2025-08-12 23:36:32.636 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:36:32.637 +03:00 [INF] Executing endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 23:36:32.638 +03:00 [INF] Route matched with {action = "GetMessages", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesAsync(System.Guid, Int32, Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Threading.CancellationToken) on controller ChatSystem.UI.Controllers.MessagesController (ChatSystem.UI).
2025-08-12 23:36:32.647 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ChatRooms] AS [c]
        WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[Id] = @__request_ChatRoomId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-12 23:36:32.693 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__request_ChatRoomId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[RoomMemberId], [c].[Message], [c].[FilePath], [c].[IsRead], [c].[LastActionDate], COALESCE([u].[FirstName], N'') + N' ' + COALESCE([u].[LastName], N''), [u].[ProfileImageUrl], [r0].[Id], [u].[Id], [t].[Id], [t].[RoomMemberId], [t].[Message], [t].[FilePath], [t].[Timestamp], [t].[SenderName], [t].[SenderProfileImage], [t].[Id0], [t].[Id1]
FROM [ChatMessages] AS [c]
INNER JOIN [RoomMembers] AS [r0] ON [c].[RoomMemberId] = [r0].[Id]
INNER JOIN [Users] AS [u] ON [r0].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[RoomMemberId], [c0].[Message], [c0].[FilePath], [c0].[LastActionDate] AS [Timestamp], COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'') AS [SenderName], [u0].[ProfileImageUrl] AS [SenderProfileImage], [r1].[Id] AS [Id0], [u0].[Id] AS [Id1], [c0].[ChatMessageId]
    FROM [ChatMessageReplies] AS [c0]
    INNER JOIN [RoomMembers] AS [r1] ON [c0].[RoomMemberId] = [r1].[Id]
    INNER JOIN [Users] AS [u0] ON [r1].[UserId] = [u0].[Id]
) AS [t] ON [c].[Id] = [t].[ChatMessageId]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND EXISTS (
    SELECT 1
    FROM [RoomMembers] AS [r]
    WHERE [r].[Id] = [c].[RoomMemberId] AND [r].[ChatRoomId] = @__request_ChatRoomId_0)
ORDER BY [c].[LastActionDate] DESC, [c].[Id], [r0].[Id], [u].[Id], [t].[Timestamp], [t].[Id], [t].[Id0]
2025-08-12 23:36:32.698 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.ApiResult`1[[System.Collections.Generic.List`1[[Application.Queries.Messages.GetMessages.MessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-12 23:36:32.701 +03:00 [INF] Executed action ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI) in 63.0373ms
2025-08-12 23:36:32.701 +03:00 [INF] Executed endpoint 'ChatSystem.UI.Controllers.MessagesController.GetMessagesAsync (ChatSystem.UI)'
2025-08-12 23:36:32.701 +03:00 [INF] HTTP GET /api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99 responded 200 in 64.1794 ms
2025-08-12 23:36:32.701 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7003/api/Messages/RoomMessages/0fadc9a6-f953-4d8e-8971-e2d6a2ec4f99?page=1&pageSize=50 - 200 null application/json; charset=utf-8 65.3421ms
2025-08-12 23:58:37.741 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 23:58:37.741 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 1601725.8532 ms
2025-08-12 23:58:37.741 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=TE55CXhE4JDLAr1XD8Oidg&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMzM2ODIsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.ClwqXjWmlqYM_EpGbK9ojnI-yc_HRl4VKnfoFBYQkC4 - 200 null null 1601726.3625ms
2025-08-12 23:58:37.744 +03:00 [INF] Connection id "0HNEPRQUBDPE2", Request id "0HNEPRQUBDPE2:00000003": the application completed without reading the entire request body.
2025-08-12 23:58:38.771 +03:00 [INF] Request starting HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null null
2025-08-12 23:58:38.772 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:58:38.772 +03:00 [INF] Request finished HTTP/2 OPTIONS https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 204 null null 0.4603ms
2025-08-12 23:58:38.785 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - null 0
2025-08-12 23:58:38.785 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:58:38.788 +03:00 [INF] Executing endpoint '/chatHub/negotiate'
2025-08-12 23:58:38.788 +03:00 [INF] Executed endpoint '/chatHub/negotiate'
2025-08-12 23:58:38.788 +03:00 [INF] HTTP POST /chathub/negotiate responded 200 in 2.5249 ms
2025-08-12 23:58:38.789 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7003/chathub/negotiate?negotiateVersion=1 - 200 316 application/json 3.4015ms
2025-08-12 23:58:39.209 +03:00 [INF] Request starting HTTP/2 CONNECT https://localhost:7003/chathub?id=1Ne8gtwBXn3VvPqBPpBacQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMzM2ODIsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.ClwqXjWmlqYM_EpGbK9ojnI-yc_HRl4VKnfoFBYQkC4 - null null
2025-08-12 23:58:39.209 +03:00 [INF] CORS policy execution successful.
2025-08-12 23:58:39.210 +03:00 [INF] Executing endpoint '/chatHub'
2025-08-12 23:58:39.349 +03:00 [INF] Executed endpoint '/chatHub'
2025-08-12 23:58:39.349 +03:00 [INF] HTTP CONNECT /chathub responded 200 in 139.6678 ms
2025-08-12 23:58:39.349 +03:00 [INF] Request finished HTTP/2 CONNECT https://localhost:7003/chathub?id=1Ne8gtwBXn3VvPqBPpBacQ&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZmQ0ZTQ0My0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoieXpuIiwiV29ya3NwYWNlSWQiOiI5ODhjZDkyMC0yMjVjLWYwMTEtOTJiMC0xMDY4Mzg1NmZiOTYiLCJleHAiOjE3NTUwMzM2ODIsImlzcyI6IkFtYW5haENoYXQiLCJhdWQiOiJBbWFuYWhDaGF0QW5ndWxhciJ9.ClwqXjWmlqYM_EpGbK9ojnI-yc_HRl4VKnfoFBYQkC4 - 200 null null 140.0771ms
